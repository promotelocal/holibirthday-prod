(function(e){"use strict";var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return false}}(),i=n&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(e){return false}}(),r=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=(n||r)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,o,a,s,l,u;if(e.split(",")[0].indexOf("base64")>=0){t=atob(e.split(",")[1])}else{t=decodeURIComponent(e.split(",")[1])}o=new ArrayBuffer(t.length);a=new Uint8Array(o);for(s=0;s<t.length;s+=1){a[s]=t.charCodeAt(s)}l=e.split(",")[0].split(":")[1].split(";")[0];if(n){return new Blob([i?a:o],{type:l})}u=new r;u.append(o);return u.getBlob(l)};if(e.HTMLCanvasElement&&!t.toBlob){if(t.mozGetAsFile){t.toBlob=function(e,n,i){if(i&&t.toDataURL&&o){e(o(this.toDataURL(n,i)))}else{e(this.mozGetAsFile("blob",n))}}}else if(t.toDataURL&&o){t.toBlob=function(e,t,n){e(o(this.toDataURL(t,n)))}}}if(typeof define==="function"&&define.amd){define(function(){return o})}else{e.dataURLtoBlob=o}})(window);(function(e,t,n,i){var r="slotMachine",o={active:0,delay:200,auto:false,spins:5,randomize:null,complete:null,stopHidden:true,direction:"up"};var a="slotMachineBlurFast",s="slotMachineBlurMedium",l="slotMachineBlurSlow",u="slotMachineGradient",c=u;e(n).ready(function(){var t='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="0" height="0">'+'<filter id="slotMachineBlurFilterFast">'+'<feGaussianBlur stdDeviation="5" />'+"</filter>"+"</svg>#slotMachineBlurFilterFast";var n='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="0" height="0">'+'<filter id="slotMachineBlurFilterMedium">'+'<feGaussianBlur stdDeviation="3" />'+"</filter>"+"</svg>#slotMachineBlurFilterMedium";var i='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="0" height="0">'+'<filter id="slotMachineBlurFilterSlow">'+'<feGaussianBlur stdDeviation="1" />'+"</filter>"+"</svg>#slotMachineBlurFilterSlow";var r='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="0" height="0">'+'<mask id="slotMachineFadeMask" maskUnits="objectBoundingBox" maskContentUnits="objectBoundingBox">'+'<linearGradient id="slotMachineFadeGradient" gradientUnits="objectBoundingBox" x="0" y="0">'+'<stop stop-color="white" stop-opacity="0" offset="0"></stop>'+'<stop stop-color="white" stop-opacity="1" offset="0.25"></stop>'+'<stop stop-color="white" stop-opacity="1" offset="0.75"></stop>'+'<stop stop-color="white" stop-opacity="0" offset="1"></stop>'+"</linearGradient>"+'<rect x="0" y="-1" width="1" height="1" transform="rotate(90)" fill="url(#slotMachineFadeGradient)"></rect>'+"</mask>"+"</svg>#slotMachineFadeMask";e("body").append("<style>"+"."+a+'{-webkit-filter: blur(5px);-moz-filter: blur(5px);-o-filter: blur(5px);-ms-filter: blur(5px);filter: blur(5px);filter: url("data:image/svg+xml;utf8,'+t+'");filter:progid:DXImageTransform.Microsoft.Blur(PixelRadius="5")}'+"."+s+'{-webkit-filter: blur(3px);-moz-filter: blur(3px);-o-filter: blur(3px);-ms-filter: blur(3px);filter: blur(3px);filter: url("data:image/svg+xml;utf8,'+n+'");filter:progid:DXImageTransform.Microsoft.Blur(PixelRadius="3")}'+"."+l+'{-webkit-filter: blur(1px);-moz-filter: blur(1px);-o-filter: blur(1px);-ms-filter: blur(1px);filter: blur(1px);filter: url("data:image/svg+xml;utf8,'+i+'");filter:progid:DXImageTransform.Microsoft.Blur(PixelRadius="1")}'+"."+u+"{"+"-webkit-mask-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, rgba(0,0,0,0)), color-stop(25%, rgba(0,0,0,1)), color-stop(75%, rgba(0,0,0,1)), color-stop(100%, rgba(0,0,0,0)) );"+'mask: url("data:image/svg+xml;utf8,'+r+'");'+"}"+"</style>")});if(typeof e.easing.easeOutBounce!=="function"){e.extend(e.easing,{easeOutBounce:function(e,t,n,i,r){if((t/=r)<1/2.75){return i*(7.5625*t*t)+n}else if(t<2/2.75){return i*(7.5625*(t-=1.5/2.75)*t+.75)+n}else if(t<2.5/2.75){return i*(7.5625*(t-=2.25/2.75)*t+.9375)+n}else{return i*(7.5625*(t-=2.625/2.75)*t+.984375)+n}}})}function d(e,t){var n,i=this,r,o=e,a=arguments,s=t;this.running=false;this.onpause=function(){};this.onresume=function(){};this.cancel=function(){this.running=false;clearTimeout(r)};this.pause=function(){if(this.running){t-=(new Date).getTime()-n;this.cancel();this.onpause()}};this.resume=function(){if(!this.running){this.running=true;n=(new Date).getTime();r=setTimeout(function(){o.apply(i,Array.prototype.slice.call(a,2,a.length))},t);this.onresume()}};this.reset=function(){this.cancel();this.running=true;t=s;r=setTimeout(function(){o.apply(i,Array.prototype.slice.call(a,2,a.length))},s)};this.add=function(e){this.pause();t+=e;this.resume()};this.resume()}function f(t,n){this.element=t;this.settings=e.extend({},o,n);this.defaults=o;this.name=r;this.$slot=e(t);this.$tiles=this.$slot.children();this.$container=null;this._minTop=null;this._maxTop=null;this._$fakeFirstTile=null;this._$fakeLastTile=null;this._timer=null;this._oncompleteStack=[this.settings.complete];this._spinsLeft=null;this.futureActive=null;this.isRunning=false;this.isStopping=false;this.active=this.settings.active;this.$slot.css("overflow","hidden");if(this.settings.active<0||this.settings.active>=this.$tiles.length){this.settings.active=0;this.active=0}this.$container=this.$tiles.wrapAll('<div class="slotMachineContainer" />').parent();this._maxTop=-this.$container.height();this._$fakeFirstTile=this.$tiles.last().clone();this._$fakeLastTile=this.$tiles.first().clone();this.$container.prepend(this._$fakeFirstTile);this.$container.append(this._$fakeLastTile);this._minTop=-this._$fakeFirstTile.outerHeight();this._direction={selected:this.settings.direction==="down"?"down":"up",up:{initial:this.getTileOffset(this.active),first:0,last:this.getTileOffset(this.$tiles.length),to:this._maxTop,firstToLast:this.getTileOffset(this.$tiles.length),lastToFirst:0},down:{initial:this.getTileOffset(this.active),first:this.getTileOffset(this.$tiles.length),last:0,to:this._minTop,firstToLast:this.getTileOffset(this.$tiles.length),lastToFirst:0},get:function(e){return this[this.selected][e]}};this.$container.css("margin-top",this._direction.get("initial"));if(this.settings.auto!==false){if(this.settings.auto===true){this.shuffle()}else{this.auto()}}}f.prototype.getTileOffset=function(e){var t=0;for(var n=0;n<e;n++){t+=this.$tiles.eq(n).outerHeight()}return-t+this._minTop};f.prototype.getVisibleTile=function(){var e=this.$tiles.first().height(),t=parseInt(this.$container.css("margin-top").replace(/px/,""),10);return Math.abs(Math.round(t/e))-1};f.prototype.setRandomize=function(e){if(typeof e==="number"){this.settings.randomize=function(){return e}}else{this.settings.randomize=e}};f.prototype.getRandom=function(e){var t,n=e||false;do{t=Math.floor(Math.random()*this.$tiles.length)}while(n&&t===this.active&&t>=0);return t};f.prototype.getCustom=function(){var e;if(this.settings.randomize!==null&&typeof this.settings.randomize==="function"){var t=this.settings.randomize.apply(this,[this.active]);if(t<0||t>=this.$tiles.length){t=0}e=t}else{e=this.getRandom()}return e};f.prototype._getPrev=function(){var e=this.active-1<0?this.$tiles.length-1:this.active-1;return e};f.prototype._getNext=function(){var e=this.active+1<this.$tiles.length?this.active+1:0;return e};f.prototype.getPrev=function(){return this._direction.selected==="up"?this._getPrev():this._getNext()};f.prototype.getNext=function(){return this._direction.selected==="up"?this._getNext():this._getPrev()};f.prototype.setDirection=function(e){if(this.isRunning){return}this._direction.selected=e==="down"?"down":"up";return this._direction[this._direction.selected]};f.prototype._setAnimationFX=function(e,t){var n=this;setTimeout(function(){n.$tiles.removeClass([a,s,l].join(" ")).addClass(e);if(t!==true||e===c){n.$slot.add(n.$tiles).removeClass(u)}else{n.$slot.add(n.$tiles).addClass(u)}},this.settings.delay/4)};f.prototype._resetPosition=function(){this.$container.css("margin-top",this._direction.get("initial"))};f.prototype.isVisible=function(){var n=this.$slot.offset().top>e(t).scrollTop()+e(t).height(),i=e(t).scrollTop()>this.$slot.height()+this.$slot.offset().top;return!n&&!i};f.prototype.prev=function(){this.futureActive=this.getPrev();this.isRunning=true;this.stop(false);return this.futureActive};f.prototype.next=function(){this.futureActive=this.getNext();this.isRunning=true;this.stop(false);return this.futureActive};f.prototype.shuffle=function(e,t){var n=this;if(t!==i){this._oncompleteStack[1]=t}this.isRunning=true;var r=this.settings.delay;if(this.futureActive===null){var o=this.getCustom();this.futureActive=o}if(typeof e==="number"){switch(e){case 1:case 2:this._setAnimationFX(l,true);break;case 3:case 4:this._setAnimationFX(s,true);r/=1.5;break;default:this._setAnimationFX(a,true);r/=2}}else{this._setAnimationFX(a,true);r/=2}if(!this.isVisible()&&this.settings.stopHidden===true){e=0;n.stop()}else{this.$container.animate({marginTop:this._direction.get("to")},r,"linear",function(){n.$container.css("margin-top",n._direction.get("first"));if(e-1<=0){n.stop()}else{n.shuffle(e-1)}})}return this.futureActive};f.prototype.stop=function(e){if(!this.isRunning){return}else if(this.isStopping){return this.futureActive}var t=this;this.$container.clearQueue().stop(true,false);this._setAnimationFX(l,e===i?true:e);this.isRunning=true;this.isStopping=true;this.active=this.getVisibleTile();if(this.futureActive>this.active){if(this.active===0&&this.futureActive===this.$tiles.length-1){this.$container.css("margin-top",this._direction.get("firstToLast"))}}else{if(this.active===this.$tiles.length-1&&this.futureActive===0){this.$container.css("margin-top",this._direction.get("lastToFirst"))}}this.active=this.futureActive;var n=this.settings.delay*3;this.$container.animate({marginTop:this.getTileOffset(this.active)},n,"easeOutBounce",function(){t.isStopping=false;t.isRunning=false;t.futureActive=null;if(typeof t._oncompleteStack[0]==="function"){t._oncompleteStack[0].apply(t,[t.active])}if(typeof t._oncompleteStack[1]==="function"){t._oncompleteStack[1].apply(t,[t.active])}});setTimeout(function(){t._setAnimationFX(c,false)},n/1.75);return this.active};f.prototype.auto=function(){var e=this;this._timer=new d(function(){if(typeof e.settings.randomize!=="function"){e.futureActive=e.getNext()}e.isRunning=true;if(!e.isVisible()&&e.settings.stopHidden===true){setTimeout(function(){e._timer.reset()},500)}else{e.shuffle(e.settings.spins,function(){e._timer.reset()})}},this.settings.auto)};function h(t,n){var i;if(!e.data(t[0],"plugin_"+r)){i=new f(t,n);e.data(t[0],"plugin_"+r,i)}else{i=e.data(t[0],"plugin_"+r)}return i}e.fn[r]=function(t){if(this.length===1){return h(this,t)}else{var n=this;return e.map(n,function(e,i){var r=n.eq(i);return h(r,t)})}}})(jQuery,window,document);if(!window.localStorage){Object.defineProperty(window,"localStorage",new function(){var e=[],t={};Object.defineProperty(t,"getItem",{value:function(e){return e?this[e]:null},writable:false,configurable:false,enumerable:false});Object.defineProperty(t,"key",{value:function(t){return e[t]},writable:false,configurable:false,enumerable:false});Object.defineProperty(t,"setItem",{value:function(e,t){if(!e){return}document.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},writable:false,configurable:false,enumerable:false});Object.defineProperty(t,"length",{get:function(){return e.length},configurable:false,enumerable:false});Object.defineProperty(t,"removeItem",{value:function(e){if(!e){return}document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},writable:false,configurable:false,enumerable:false});this.get=function(){var n;for(var i in t){n=e.indexOf(i);if(n===-1){t.setItem(i,t[i])}else{e.splice(n,1)}delete t[i]}for(e;e.length>0;e.splice(0,1)){t.removeItem(e[0])}for(var r,o,a=0,s=document.cookie.split(/\s*;\s*/);a<s.length;a++){r=s[a].split(/\s*=\s*/);if(r.length>1){t[o=unescape(r[0])]=unescape(r[1]);e.push(o)}}return t};this.configurable=false;this.enumerable=true})}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";function e(){return $n.apply(null,arguments)}function t(e){$n=e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function r(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var n in t)o(t,n)&&(e[n]=t[n]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function s(e,t,n,i){return Be(e,t,n,i,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function u(e){return null==e._pf&&(e._pf=l()),e._pf}function c(e){if(null==e._isValid){var t=u(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function d(e){var t=s(NaN);return null!=e?a(u(t),e):u(t).userInvalidated=!0,t}function f(e,t){var n,i,r;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=u(t)),"undefined"!=typeof t._locale&&(e._locale=t._locale),Fn.length>0)for(n in Fn)i=Fn[n],r=t[i],"undefined"!=typeof r&&(e[i]=r);return e}function h(t){f(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),On===!1&&(On=!0,e.updateOffset(this),On=!1)}function m(e){return e instanceof h||null!=e&&null!=e._isAMomentObject}function p(e){return 0>e?Math.ceil(e):Math.floor(e)}function g(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=p(t)),n}function y(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(i=0;r>i;i++)(n&&e[i]!==t[i]||!n&&g(e[i])!==g(t[i]))&&a++;return a+o}function v(){}function b(e){return e?e.toLowerCase().replace("_","-"):e}function w(e){for(var t,n,i,r,o=0;o<e.length;){for(r=b(e[o]).split("-"),t=r.length,n=b(e[o+1]),n=n?n.split("-"):null;t>0;){if(i=S(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&y(r,n,!0)>=t-1)break;t--}o++}return null}function S(e){var t=null;if(!An[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=Wn._abbr,require("./locale/"+e),T(t)}catch(n){}return An[e]}function T(e,t){var n;return e&&(n="undefined"==typeof t?x(e):k(e,t),n&&(Wn=n)),Wn._abbr}function k(e,t){return null!==t?(t.abbr=e,An[e]=An[e]||new v,An[e].set(t),T(e),An[e]):(delete An[e],null)}function x(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Wn;if(!n(e)){if(t=S(e))return t;e=[e]}return w(e)}function M(e,t){var n=e.toLowerCase();Rn[n]=Rn[n+"s"]=Rn[t]=e}function C(e){return"string"==typeof e?Rn[e]||Rn[e.toLowerCase()]:void 0}function _(e){var t,n,i={};for(n in e)o(e,n)&&(t=C(n),t&&(i[t]=e[n]));return i}function B(t,n){return function(i){return null!=i?(D(this,t,i),e.updateOffset(this,n),this):z(this,t)}}function z(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function D(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function N(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=C(e),"function"==typeof this[e])return this[e](t);return this}function P(e,t,n){var i=""+Math.abs(e),r=t-i.length,o=e>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function H(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(Yn[e]=r),t&&(Yn[t[0]]=function(){return P(r.apply(this,arguments),t[1],t[2])}),n&&(Yn[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function $(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,n,i=e.match(In);for(t=0,n=i.length;n>t;t++)Yn[i[t]]?i[t]=Yn[i[t]]:i[t]=$(i[t]);return function(r){var o="";for(t=0;n>t;t++)o+=i[t]instanceof Function?i[t].call(r,e):i[t];return o}}function F(e,t){return e.isValid()?(t=O(t,e.localeData()),En[t]=En[t]||W(t),En[t](e)):e.localeData().invalidDate()}function O(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(Ln.lastIndex=0;i>=0&&Ln.test(e);)e=e.replace(Ln,n),Ln.lastIndex=0,i-=1;return e}function A(e){return"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e)}function R(e,t,n){ri[e]=A(t)?t:function(e){return e&&n?n:t}}function I(e,t){return o(ri,e)?ri[e](t._strict,t._locale):new RegExp(L(e))}function L(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function E(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(i=function(e,n){n[t]=g(e)}),n=0;n<e.length;n++)oi[e[n]]=i}function Y(e,t){E(e,function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)})}function j(e,t,n){null!=t&&o(oi,e)&&oi[e](t,n._a,n,e)}function U(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function V(e){return this._months[e.month()]}function G(e){return this._monthsShort[e.month()]}function q(e,t,n){var i,r,o;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(r=s([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function J(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),U(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function Q(t){return null!=t?(J(this,t),e.updateOffset(this,!0),this):z(this,"Month")}function Z(){return U(this.year(),this.month())}function K(e){var t,n=e._a;return n&&-2===u(e).overflow&&(t=n[si]<0||n[si]>11?si:n[li]<1||n[li]>U(n[ai],n[si])?li:n[ui]<0||n[ui]>24||24===n[ui]&&(0!==n[ci]||0!==n[di]||0!==n[fi])?ui:n[ci]<0||n[ci]>59?ci:n[di]<0||n[di]>59?di:n[fi]<0||n[fi]>999?fi:-1,u(e)._overflowDayOfYear&&(ai>t||t>li)&&(t=li),u(e).overflow=t),e}function X(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function ee(e,t){var n=!0;return a(function(){return n&&(X(e+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function te(e,t){pi[e]||(X(t),pi[e]=!0)}function ne(e){var t,n,i=e._i,r=gi.exec(i);if(r){for(u(e).iso=!0,t=0,n=yi.length;n>t;t++)if(yi[t][1].exec(i)){e._f=yi[t][0];break}for(t=0,n=vi.length;n>t;t++)if(vi[t][1].exec(i)){e._f+=(r[6]||" ")+vi[t][0];break}i.match(ti)&&(e._f+="Z"),Se(e)}else e._isValid=!1}function ie(t){var n=bi.exec(t._i);return null!==n?void(t._d=new Date(+n[1])):(ne(t),void(t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function re(e,t,n,i,r,o,a){var s=new Date(e,t,n,i,r,o,a);return 1970>e&&s.setFullYear(e),s}function oe(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function ae(e){return se(e)?366:365}function se(e){return e%4===0&&e%100!==0||e%400===0}function le(){return se(this.year())}function ue(e,t,n){var i,r=n-t,o=n-e.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=ze(e).add(o,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function ce(e){return ue(e,this._week.dow,this._week.doy).week}function de(){return this._week.dow}function fe(){return this._week.doy}function he(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function me(e){var t=ue(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function pe(e,t,n,i,r){var o,a=6+r-i,s=oe(e,0,1+a),l=s.getUTCDay();return r>l&&(l+=7),n=null!=n?1*n:r,o=1+a+7*(t-1)-l+n,{year:o>0?e:e-1,dayOfYear:o>0?o:ae(e-1)+o}}function ge(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function ye(e,t,n){return null!=e?e:null!=t?t:n}function ve(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function be(e){var t,n,i,r,o=[];if(!e._d){for(i=ve(e),e._w&&null==e._a[li]&&null==e._a[si]&&we(e),e._dayOfYear&&(r=ye(e._a[ai],i[ai]),e._dayOfYear>ae(r)&&(u(e)._overflowDayOfYear=!0),n=oe(r,0,e._dayOfYear),e._a[si]=n.getUTCMonth(),e._a[li]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ui]&&0===e._a[ci]&&0===e._a[di]&&0===e._a[fi]&&(e._nextDay=!0,e._a[ui]=0),e._d=(e._useUTC?oe:re).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ui]=24)}}function we(e){var t,n,i,r,o,a,s;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,a=4,n=ye(t.GG,e._a[ai],ue(ze(),1,4).year),i=ye(t.W,1),r=ye(t.E,1)):(o=e._locale._week.dow,a=e._locale._week.doy,n=ye(t.gg,e._a[ai],ue(ze(),o,a).year),i=ye(t.w,1),null!=t.d?(r=t.d,o>r&&++i):r=null!=t.e?t.e+o:o),s=pe(n,i,r,a,o),e._a[ai]=s.year,e._dayOfYear=s.dayOfYear}function Se(t){if(t._f===e.ISO_8601)return void ne(t);t._a=[],u(t).empty=!0;var n,i,r,o,a,s=""+t._i,l=s.length,c=0;for(r=O(t._f,t._locale).match(In)||[],n=0;n<r.length;n++)o=r[n],i=(s.match(I(o,t))||[])[0],i&&(a=s.substr(0,s.indexOf(i)),a.length>0&&u(t).unusedInput.push(a),s=s.slice(s.indexOf(i)+i.length),c+=i.length),Yn[o]?(i?u(t).empty=!1:u(t).unusedTokens.push(o),j(o,i,t)):t._strict&&!i&&u(t).unusedTokens.push(o);u(t).charsLeftOver=l-c,s.length>0&&u(t).unusedInput.push(s),u(t).bigHour===!0&&t._a[ui]<=12&&t._a[ui]>0&&(u(t).bigHour=void 0),t._a[ui]=Te(t._locale,t._a[ui],t._meridiem),be(t),K(t)}function Te(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(i=e.isPM(n),i&&12>t&&(t+=12),i||12!==t||(t=0),t):t}function ke(e){var t,n,i,r,o;if(0===e._f.length)return u(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)o=0,t=f({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Se(t),c(t)&&(o+=u(t).charsLeftOver,o+=10*u(t).unusedTokens.length,u(t).score=o,(null==i||i>o)&&(i=o,n=t));a(e,n||t)}function xe(e){if(!e._d){var t=_(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],be(e)}}function Me(e){var t=new h(K(Ce(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Ce(e){var t=e._i,r=e._f;return e._locale=e._locale||x(e._l),null===t||void 0===r&&""===t?d({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),m(t)?new h(K(t)):(n(r)?ke(e):r?Se(e):i(t)?e._d=t:_e(e),e))}function _e(t){var o=t._i;void 0===o?t._d=new Date:i(o)?t._d=new Date(+o):"string"==typeof o?ie(t):n(o)?(t._a=r(o.slice(0),function(e){return parseInt(e,10)}),be(t)):"object"==typeof o?xe(t):"number"==typeof o?t._d=new Date(o):e.createFromInputFallback(t)}function Be(e,t,n,i,r){var o={};return"boolean"==typeof n&&(i=n,n=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=e,o._f=t,o._strict=i,Me(o)}function ze(e,t,n,i){return Be(e,t,n,i,!1)}function De(e,t){var i,r;if(1===t.length&&n(t[0])&&(t=t[0]),!t.length)return ze();for(i=t[0],r=1;r<t.length;++r)(!t[r].isValid()||t[r][e](i))&&(i=t[r]);return i}function Ne(){var e=[].slice.call(arguments,0);return De("isBefore",e)}function Pe(){var e=[].slice.call(arguments,0);return De("isAfter",e)}function He(e){var t=_(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*u+6e4*l+36e5*s,this._days=+a+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=x(),this._bubble()}function $e(e){return e instanceof He}function We(e,t){H(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+P(~~(e/60),2)+t+P(~~e%60,2)})}function Fe(e){var t=(e||"").match(ti)||[],n=t[t.length-1]||[],i=(n+"").match(xi)||["-",0,0],r=+(60*i[1])+g(i[2]);return"+"===i[0]?r:-r}function Oe(t,n){var r,o;return n._isUTC?(r=n.clone(),o=(m(t)||i(t)?+t:+ze(t))-+r,r._d.setTime(+r._d+o),e.updateOffset(r,!1),r):ze(t).local()}function Ae(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Re(t,n){var i,r=this._offset||0;return null!=t?("string"==typeof t&&(t=Fe(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&n&&(i=Ae(this)),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==t&&(!n||this._changeInProgress?tt(this,Qe(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Ae(this)}function Ie(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Le(e){return this.utcOffset(0,e)}function Ee(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ae(this),"m")),this}function Ye(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Fe(this._i)),this}function je(e){return e=e?ze(e).utcOffset():0,(this.utcOffset()-e)%60===0}function Ue(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ve(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var e={};if(f(e,this),e=Ce(e),e._a){var t=e._isUTC?s(e._a):ze(e._a);this._isDSTShifted=this.isValid()&&y(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ge(){return!this._isUTC}function qe(){return this._isUTC}function Je(){return this._isUTC&&0===this._offset}function Qe(e,t){var n,i,r,a=e,s=null;return $e(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(a={},t?a[t]=e:a.milliseconds=e):(s=Mi.exec(e))?(n="-"===s[1]?-1:1,a={y:0,d:g(s[li])*n,h:g(s[ui])*n,m:g(s[ci])*n,s:g(s[di])*n,ms:g(s[fi])*n}):(s=Ci.exec(e))?(n="-"===s[1]?-1:1,a={y:Ze(s[2],n),M:Ze(s[3],n),d:Ze(s[4],n),h:Ze(s[5],n),m:Ze(s[6],n),s:Ze(s[7],n),w:Ze(s[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(r=Xe(ze(a.from),ze(a.to)),a={},a.ms=r.milliseconds,a.M=r.months),i=new He(a),$e(e)&&o(e,"_locale")&&(i._locale=e._locale),i}function Ze(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ke(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Xe(e,t){var n;return t=Oe(t,e),e.isBefore(t)?n=Ke(e,t):(n=Ke(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function et(e,t){return function(n,i){var r,o;return null===i||isNaN(+i)||(te(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),o=n,n=i,i=o),n="string"==typeof n?+n:n,r=Qe(n,i),tt(this,r,e),this}}function tt(t,n,i,r){var o=n._milliseconds,a=n._days,s=n._months;r=null==r?!0:r,o&&t._d.setTime(+t._d+o*i),a&&D(t,"Date",z(t,"Date")+a*i),s&&J(t,z(t,"Month")+s*i),r&&e.updateOffset(t,a||s)}function nt(e,t){var n=e||ze(),i=Oe(n,this).startOf("day"),r=this.diff(i,"days",!0),o=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse";return this.format(t&&t[o]||this.localeData().calendar(o,this,ze(n)))}function it(){return new h(this)}function rt(e,t){var n;return t=C("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=m(e)?e:ze(e),+this>+e):(n=m(e)?+e:+ze(e),n<+this.clone().startOf(t))}function ot(e,t){var n;return t=C("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=m(e)?e:ze(e),+e>+this):(n=m(e)?+e:+ze(e),+this.clone().endOf(t)<n)}function at(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function st(e,t){var n;return t=C(t||"millisecond"),"millisecond"===t?(e=m(e)?e:ze(e),+this===+e):(n=+ze(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))}function lt(e,t,n){var i,r,o=Oe(e,this),a=6e4*(o.utcOffset()-this.utcOffset());return t=C(t),"year"===t||"month"===t||"quarter"===t?(r=ut(this,o),"quarter"===t?r/=3:"year"===t&&(r/=12)):(i=this-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-a)/864e5:"week"===t?(i-a)/6048e5:i),n?r:p(r)}function ut(e,t){var n,i,r=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(r,"months");return 0>t-o?(n=e.clone().add(r-1,"months"),i=(t-o)/(o-n)):(n=e.clone().add(r+1,"months"),i=(t-o)/(n-o)),-(r+i)}function ct(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function dt(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():F(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ft(t){var n=F(this,t||e.defaultFormat);return this.localeData().postformat(n)}function ht(e,t){return this.isValid()?Qe({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mt(e){return this.from(ze(),e)}function pt(e,t){return this.isValid()?Qe({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function gt(e){return this.to(ze(),e)}function yt(e){var t;return void 0===e?this._locale._abbr:(t=x(e),null!=t&&(this._locale=t),this)}function vt(){return this._locale}function bt(e){switch(e=C(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function wt(e){return e=C(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function St(){return+this._d-6e4*(this._offset||0)}function Tt(){return Math.floor(+this/1e3)}function kt(){return this._offset?new Date(+this):this._d}function xt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Mt(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ct(){return c(this)}function _t(){return a({},u(this))}function Bt(){return u(this).overflow}function zt(e,t){H(0,[e,e.length],0,t)}function Dt(e,t,n){return ue(ze([e,11,31+t-n]),t,n).week}function Nt(e){var t=ue(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")}function Pt(e){var t=ue(this,1,4).year;return null==e?t:this.add(e-t,"y")}function Ht(){return Dt(this.year(),1,4)}function $t(){var e=this.localeData()._week;return Dt(this.year(),e.dow,e.doy)}function Wt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Ft(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Ot(e){return this._weekdays[e.day()]}function At(e){return this._weekdaysShort[e.day()]}function Rt(e){return this._weekdaysMin[e.day()]}function It(e){var t,n,i;for(this._weekdaysParse=this._weekdaysParse||[],t=0;7>t;t++)if(this._weekdaysParse[t]||(n=ze([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t}function Lt(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Ft(e,this.localeData()),this.add(e-t,"d")):t}function Et(e){var t=(this.day()+7-this.localeData()._week.dow)%7;
return null==e?t:this.add(e-t,"d")}function Yt(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)}function jt(e,t){H(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ut(e,t){return t._meridiemParse}function Vt(e){return"p"===(e+"").toLowerCase().charAt(0)}function Gt(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function qt(e,t){t[fi]=g(1e3*("0."+e))}function Jt(){return this._isUTC?"UTC":""}function Qt(){return this._isUTC?"Coordinated Universal Time":""}function Zt(e){return ze(1e3*e)}function Kt(){return ze.apply(null,arguments).parseZone()}function Xt(e,t,n){var i=this._calendar[e];return"function"==typeof i?i.call(t,n):i}function en(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function tn(){return this._invalidDate}function nn(e){return this._ordinal.replace("%d",e)}function rn(e){return e}function on(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)}function an(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)}function sn(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function ln(e,t,n,i){var r=x(),o=s().set(i,t);return r[n](o,e)}function un(e,t,n,i,r){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return ln(e,t,n,r);var o,a=[];for(o=0;i>o;o++)a[o]=ln(e,o,n,r);return a}function cn(e,t){return un(e,t,"months",12,"month")}function dn(e,t){return un(e,t,"monthsShort",12,"month")}function fn(e,t){return un(e,t,"weekdays",7,"day")}function hn(e,t){return un(e,t,"weekdaysShort",7,"day")}function mn(e,t){return un(e,t,"weekdaysMin",7,"day")}function pn(){var e=this._data;return this._milliseconds=Ji(this._milliseconds),this._days=Ji(this._days),this._months=Ji(this._months),e.milliseconds=Ji(e.milliseconds),e.seconds=Ji(e.seconds),e.minutes=Ji(e.minutes),e.hours=Ji(e.hours),e.months=Ji(e.months),e.years=Ji(e.years),this}function gn(e,t,n,i){var r=Qe(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function yn(e,t){return gn(this,e,t,1)}function vn(e,t){return gn(this,e,t,-1)}function bn(e){return 0>e?Math.floor(e):Math.ceil(e)}function wn(){var e,t,n,i,r,o=this._milliseconds,a=this._days,s=this._months,l=this._data;return o>=0&&a>=0&&s>=0||0>=o&&0>=a&&0>=s||(o+=864e5*bn(Tn(s)+a),a=0,s=0),l.milliseconds=o%1e3,e=p(o/1e3),l.seconds=e%60,t=p(e/60),l.minutes=t%60,n=p(t/60),l.hours=n%24,a+=p(n/24),r=p(Sn(a)),s+=r,a-=bn(Tn(r)),i=p(s/12),s%=12,l.days=a,l.months=s,l.years=i,this}function Sn(e){return 4800*e/146097}function Tn(e){return 146097*e/4800}function kn(e){var t,n,i=this._milliseconds;if(e=C(e),"month"===e||"year"===e)return t=this._days+i/864e5,n=this._months+Sn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Tn(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function xn(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)}function Mn(e){return function(){return this.as(e)}}function Cn(e){return e=C(e),this[e+"s"]()}function _n(e){return function(){return this._data[e]}}function Bn(){return p(this.days()/7)}function zn(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function Dn(e,t,n){var i=Qe(e).abs(),r=dr(i.as("s")),o=dr(i.as("m")),a=dr(i.as("h")),s=dr(i.as("d")),l=dr(i.as("M")),u=dr(i.as("y")),c=r<fr.s&&["s",r]||1===o&&["m"]||o<fr.m&&["mm",o]||1===a&&["h"]||a<fr.h&&["hh",a]||1===s&&["d"]||s<fr.d&&["dd",s]||1===l&&["M"]||l<fr.M&&["MM",l]||1===u&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=n,zn.apply(null,c)}function Nn(e,t){return void 0===fr[e]?!1:void 0===t?fr[e]:(fr[e]=t,!0)}function Pn(e){var t=this.localeData(),n=Dn(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Hn(){var e,t,n,i=hr(this._milliseconds)/1e3,r=hr(this._days),o=hr(this._months);e=p(i/60),t=p(e/60),i%=60,e%=60,n=p(o/12),o%=12;var a=n,s=o,l=r,u=t,c=e,d=i,f=this.asSeconds();return f?(0>f?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(u||c||d?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(d?d+"S":""):"P0D"}var $n,Wn,Fn=e.momentProperties=[],On=!1,An={},Rn={},In=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ln=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,En={},Yn={},jn=/\d/,Un=/\d\d/,Vn=/\d{3}/,Gn=/\d{4}/,qn=/[+-]?\d{6}/,Jn=/\d\d?/,Qn=/\d{1,3}/,Zn=/\d{1,4}/,Kn=/[+-]?\d{1,6}/,Xn=/\d+/,ei=/[+-]?\d+/,ti=/Z|[+-]\d\d:?\d\d/gi,ni=/[+-]?\d+(\.\d{1,3})?/,ii=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ri={},oi={},ai=0,si=1,li=2,ui=3,ci=4,di=5,fi=6;H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),H("MMMM",0,0,function(e){return this.localeData().months(this,e)}),M("month","M"),R("M",Jn),R("MM",Jn,Un),R("MMM",ii),R("MMMM",ii),E(["M","MM"],function(e,t){t[si]=g(e)-1}),E(["MMM","MMMM"],function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[si]=r:u(n).invalidMonth=e});var hi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mi="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pi={};e.suppressDeprecationWarnings=!1;var gi=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],vi=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],bi=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=ee("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),M("year","y"),R("Y",ei),R("YY",Jn,Un),R("YYYY",Zn,Gn),R("YYYYY",Kn,qn),R("YYYYYY",Kn,qn),E(["YYYYY","YYYYYY"],ai),E("YYYY",function(t,n){n[ai]=2===t.length?e.parseTwoDigitYear(t):g(t)}),E("YY",function(t,n){n[ai]=e.parseTwoDigitYear(t)}),e.parseTwoDigitYear=function(e){return g(e)+(g(e)>68?1900:2e3)};var wi=B("FullYear",!1);H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),M("week","w"),M("isoWeek","W"),R("w",Jn),R("ww",Jn,Un),R("W",Jn),R("WW",Jn,Un),Y(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=g(e)});var Si={dow:0,doy:6};H("DDD",["DDDD",3],"DDDo","dayOfYear"),M("dayOfYear","DDD"),R("DDD",Qn),R("DDDD",Vn),E(["DDD","DDDD"],function(e,t,n){n._dayOfYear=g(e)}),e.ISO_8601=function(){};var Ti=ee("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=ze.apply(null,arguments);return this>e?this:e}),ki=ee("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=ze.apply(null,arguments);return e>this?this:e});We("Z",":"),We("ZZ",""),R("Z",ti),R("ZZ",ti),E(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Fe(e)});var xi=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Mi=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ci=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Qe.fn=He.prototype;var _i=et(1,"add"),Bi=et(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var zi=ee("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),zt("gggg","weekYear"),zt("ggggg","weekYear"),zt("GGGG","isoWeekYear"),zt("GGGGG","isoWeekYear"),M("weekYear","gg"),M("isoWeekYear","GG"),R("G",ei),R("g",ei),R("GG",Jn,Un),R("gg",Jn,Un),R("GGGG",Zn,Gn),R("gggg",Zn,Gn),R("GGGGG",Kn,qn),R("ggggg",Kn,qn),Y(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=g(e)}),Y(["gg","GG"],function(t,n,i,r){n[r]=e.parseTwoDigitYear(t)}),H("Q",0,0,"quarter"),M("quarter","Q"),R("Q",jn),E("Q",function(e,t){t[si]=3*(g(e)-1)}),H("D",["DD",2],"Do","date"),M("date","D"),R("D",Jn),R("DD",Jn,Un),R("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),E(["D","DD"],li),E("Do",function(e,t){t[li]=g(e.match(Jn)[0],10)});var Di=B("Date",!0);H("d",0,"do","day"),H("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),H("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),H("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),M("day","d"),M("weekday","e"),M("isoWeekday","E"),R("d",Jn),R("e",Jn),R("E",Jn),R("dd",ii),R("ddd",ii),R("dddd",ii),Y(["dd","ddd","dddd"],function(e,t,n){var i=n._locale.weekdaysParse(e);null!=i?t.d=i:u(n).invalidWeekday=e}),Y(["d","e","E"],function(e,t,n,i){t[i]=g(e)});var Ni="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Pi="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Hi="Su_Mo_Tu_We_Th_Fr_Sa".split("_");H("H",["HH",2],0,"hour"),H("h",["hh",2],0,function(){return this.hours()%12||12}),jt("a",!0),jt("A",!1),M("hour","h"),R("a",Ut),R("A",Ut),R("H",Jn),R("h",Jn),R("HH",Jn,Un),R("hh",Jn,Un),E(["H","HH"],ui),E(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),E(["h","hh"],function(e,t,n){t[ui]=g(e),u(n).bigHour=!0});var $i=/[ap]\.?m?\.?/i,Wi=B("Hours",!0);H("m",["mm",2],0,"minute"),M("minute","m"),R("m",Jn),R("mm",Jn,Un),E(["m","mm"],ci);var Fi=B("Minutes",!1);H("s",["ss",2],0,"second"),M("second","s"),R("s",Jn),R("ss",Jn,Un),E(["s","ss"],di);var Oi=B("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),M("millisecond","ms"),R("S",Qn,jn),R("SS",Qn,Un),R("SSS",Qn,Vn);var Ai;for(Ai="SSSS";Ai.length<=9;Ai+="S")R(Ai,Xn);for(Ai="S";Ai.length<=9;Ai+="S")E(Ai,qt);var Ri=B("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var Ii=h.prototype;Ii.add=_i,Ii.calendar=nt,Ii.clone=it,Ii.diff=lt,Ii.endOf=wt,Ii.format=ft,Ii.from=ht,Ii.fromNow=mt,Ii.to=pt,Ii.toNow=gt,Ii.get=N,Ii.invalidAt=Bt,Ii.isAfter=rt,Ii.isBefore=ot,Ii.isBetween=at,Ii.isSame=st,Ii.isValid=Ct,Ii.lang=zi,Ii.locale=yt,Ii.localeData=vt,Ii.max=ki,Ii.min=Ti,Ii.parsingFlags=_t,Ii.set=N,Ii.startOf=bt,Ii.subtract=Bi,Ii.toArray=xt,Ii.toObject=Mt,Ii.toDate=kt,Ii.toISOString=dt,Ii.toJSON=dt,Ii.toString=ct,Ii.unix=Tt,Ii.valueOf=St,Ii.year=wi,Ii.isLeapYear=le,Ii.weekYear=Nt,Ii.isoWeekYear=Pt,Ii.quarter=Ii.quarters=Wt,Ii.month=Q,Ii.daysInMonth=Z,Ii.week=Ii.weeks=he,Ii.isoWeek=Ii.isoWeeks=me,Ii.weeksInYear=$t,Ii.isoWeeksInYear=Ht,Ii.date=Di,Ii.day=Ii.days=Lt,Ii.weekday=Et,Ii.isoWeekday=Yt,Ii.dayOfYear=ge,Ii.hour=Ii.hours=Wi,Ii.minute=Ii.minutes=Fi,Ii.second=Ii.seconds=Oi,Ii.millisecond=Ii.milliseconds=Ri,Ii.utcOffset=Re,Ii.utc=Le,Ii.local=Ee,Ii.parseZone=Ye,Ii.hasAlignedHourOffset=je,Ii.isDST=Ue,Ii.isDSTShifted=Ve,Ii.isLocal=Ge,Ii.isUtcOffset=qe,Ii.isUtc=Je,Ii.isUTC=Je,Ii.zoneAbbr=Jt,Ii.zoneName=Qt,Ii.dates=ee("dates accessor is deprecated. Use date instead.",Di),Ii.months=ee("months accessor is deprecated. Use month instead",Q),Ii.years=ee("years accessor is deprecated. Use year instead",wi),Ii.zone=ee("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Ie);var Li=Ii,Ei={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Yi={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},ji="Invalid date",Ui="%d",Vi=/\d{1,2}/,Gi={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},qi=v.prototype;qi._calendar=Ei,qi.calendar=Xt,qi._longDateFormat=Yi,qi.longDateFormat=en,qi._invalidDate=ji,qi.invalidDate=tn,qi._ordinal=Ui,qi.ordinal=nn,qi._ordinalParse=Vi,qi.preparse=rn,qi.postformat=rn,qi._relativeTime=Gi,qi.relativeTime=on,qi.pastFuture=an,qi.set=sn,qi.months=V,qi._months=hi,qi.monthsShort=G,qi._monthsShort=mi,qi.monthsParse=q,qi.week=ce,qi._week=Si,qi.firstDayOfYear=fe,qi.firstDayOfWeek=de,qi.weekdays=Ot,qi._weekdays=Ni,qi.weekdaysMin=Rt,qi._weekdaysMin=Hi,qi.weekdaysShort=At,qi._weekdaysShort=Pi,qi.weekdaysParse=It,qi.isPM=Vt,qi._meridiemParse=$i,qi.meridiem=Gt,T("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),e.lang=ee("moment.lang is deprecated. Use moment.locale instead.",T),e.langData=ee("moment.langData is deprecated. Use moment.localeData instead.",x);var Ji=Math.abs,Qi=Mn("ms"),Zi=Mn("s"),Ki=Mn("m"),Xi=Mn("h"),er=Mn("d"),tr=Mn("w"),nr=Mn("M"),ir=Mn("y"),rr=_n("milliseconds"),or=_n("seconds"),ar=_n("minutes"),sr=_n("hours"),lr=_n("days"),ur=_n("months"),cr=_n("years"),dr=Math.round,fr={s:45,m:45,h:22,d:26,M:11},hr=Math.abs,mr=He.prototype;mr.abs=pn,mr.add=yn,mr.subtract=vn,mr.as=kn,mr.asMilliseconds=Qi,mr.asSeconds=Zi,mr.asMinutes=Ki,mr.asHours=Xi,mr.asDays=er,mr.asWeeks=tr,mr.asMonths=nr,mr.asYears=ir,mr.valueOf=xn,mr._bubble=wn,mr.get=Cn,mr.milliseconds=rr,mr.seconds=or,mr.minutes=ar,mr.hours=sr,mr.days=lr,mr.weeks=Bn,mr.months=ur,mr.years=cr,mr.humanize=Pn,mr.toISOString=Hn,mr.toString=Hn,mr.toJSON=Hn,mr.locale=yt,mr.localeData=vt,mr.toIsoString=ee("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Hn),mr.lang=zi,H("X",0,0,"unix"),H("x",0,0,"valueOf"),R("x",ei),R("X",ni),E("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),E("x",function(e,t,n){n._d=new Date(g(e))}),e.version="2.10.6",t(ze),e.fn=Li,e.min=Ne,e.max=Pe,e.utc=s,e.unix=Zt,e.months=cn,e.isDate=i,e.locale=T,e.invalid=d,e.duration=Qe,e.isMoment=m,e.weekdays=fn,e.parseZone=Kt,e.localeData=x,e.isDuration=$e,e.monthsShort=dn,e.weekdaysMin=mn,e.defineLocale=k,e.weekdaysShort=hn,e.normalizeUnits=C,e.relativeTimeThreshold=Nn;var pr=e;return pr});if(!document)var document={cookie:""};var ObjectId=function(){var e=Math.floor(Math.random()*16777216);var t=Math.floor(Math.random()*65536);var n=Math.floor(Math.random()*16777216);var i=function(){var e=document.cookie.split("; ");for(var t in e){var i=e[t].split("=");var r=parseInt(i[1],10);if(i[0]=="mongoMachineId"&&r&&r>=0&&r<=16777215){n=r;break}}document.cookie="mongoMachineId="+n+";expires=Tue, 19 Jan 2038 05:00:00 GMT;path=/"};if(typeof localStorage!="undefined"){try{var r=parseInt(localStorage["mongoMachineId"]);if(r>=0&&r<=16777215){n=Math.floor(localStorage["mongoMachineId"])}localStorage["mongoMachineId"]=n}catch(o){i()}}else{i()}function a(){if(!(this instanceof ObjectId)){return new ObjectId(arguments[0],arguments[1],arguments[2],arguments[3]).toString()}if(typeof arguments[0]=="object"){this.timestamp=arguments[0].timestamp;this.machine=arguments[0].machine;this.pid=arguments[0].pid;this.increment=arguments[0].increment}else if(typeof arguments[0]=="string"&&arguments[0].length==24){this.timestamp=Number("0x"+arguments[0].substr(0,8)),this.machine=Number("0x"+arguments[0].substr(8,6)),this.pid=Number("0x"+arguments[0].substr(14,4)),this.increment=Number("0x"+arguments[0].substr(18,6))}else if(arguments.length==4&&arguments[0]!=null){this.timestamp=arguments[0];this.machine=arguments[1];this.pid=arguments[2];this.increment=arguments[3]}else{this.timestamp=Math.floor((new Date).valueOf()/1e3);this.machine=n;this.pid=t;this.increment=e++;if(e>16777215){e=0}}}return a}();ObjectId.prototype.getDate=function(){return new Date(this.timestamp*1e3)};ObjectId.prototype.toArray=function(){var e=this.toString();var t=[];var n;for(n=0;n<12;n++){t[n]=parseInt(e.slice(n*2,n*2+2),16)}return t};ObjectId.prototype.toString=function(){if(this.timestamp===undefined||this.machine===undefined||this.pid===undefined||this.increment===undefined){return"Invalid ObjectId"}var e=this.timestamp.toString(16);var t=this.machine.toString(16);var n=this.pid.toString(16);var i=this.increment.toString(16);return"00000000".substr(0,8-e.length)+e+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-n.length)+n+"000000".substr(0,6-i.length)+i};(function(e){"use strict";if(typeof bootstrap==="function"){bootstrap("promise",e)}else if(typeof exports==="object"&&typeof module==="object"){module.exports=e()}else if(typeof define==="function"&&define.amd){define(e)}else if(typeof ses!=="undefined"){if(!ses.ok()){return}else{ses.makeQ=e}}else if(typeof window!=="undefined"||typeof self!=="undefined"){var t=typeof window!=="undefined"?window:self;var n=t.Q;t.Q=e();t.Q.noConflict=function(){t.Q=n;return this}}else{throw new Error("This environment was not anticipated by Q. Please file a bug.")}})(function(){"use strict";var e=false;try{throw new Error}catch(t){e=!!t.stack}var n=M();var i;var r=function(){};var o=function(){var e={task:void 0,next:null};var t=e;var n=false;var i=void 0;var r=false;var a=[];function s(){var t,i;while(e.next){e=e.next;t=e.task;e.task=void 0;i=e.domain;if(i){e.domain=void 0;i.enter()}l(t,i)}while(a.length){t=a.pop();l(t)}n=false}function l(e,t){try{e()}catch(n){if(r){if(t){t.exit()}setTimeout(s,0);if(t){t.enter()}throw n}else{setTimeout(function(){throw n},0)}}if(t){t.exit()}}o=function(e){t=t.next={task:e,domain:r&&process.domain,next:null};if(!n){n=true;i()}};if(typeof process==="object"&&process.toString()==="[object process]"&&process.nextTick){r=true;i=function(){process.nextTick(s)}}else if(typeof setImmediate==="function"){if(typeof window!=="undefined"){i=setImmediate.bind(window,s)}else{i=function(){setImmediate(s)}}}else if(typeof MessageChannel!=="undefined"){var u=new MessageChannel;u.port1.onmessage=function(){i=c;u.port1.onmessage=s;s()};var c=function(){u.port2.postMessage(0)};i=function(){setTimeout(s,0);c()}}else{i=function(){setTimeout(s,0)}}o.runAfter=function(e){a.push(e);if(!n){n=true;i()}};return o}();var a=Function.call;function s(e){return function(){return a.apply(e,arguments)}}var l=s(Array.prototype.slice);var u=s(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(arguments.length===1){do{if(n in this){t=this[n++];break}if(++n>=i){throw new TypeError}}while(1)}for(;n<i;n++){if(n in this){t=e(t,this[n],n)}}return t});var c=s(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var d=s(Array.prototype.map||function(e,t){var n=this;var i=[];u(n,function(r,o,a){i.push(e.call(t,o,a,n))},void 0);return i});var f=Object.create||function(e){function t(){}t.prototype=e;return new t};var h=s(Object.prototype.hasOwnProperty);var m=Object.keys||function(e){var t=[];for(var n in e){if(h(e,n)){t.push(n)}}return t};var p=s(Object.prototype.toString);function g(e){return e===Object(e)}function y(e){return p(e)==="[object StopIteration]"||e instanceof v}var v;if(typeof ReturnValue!=="undefined"){v=ReturnValue}else{v=function(e){this.value=e}}var b="From previous event:";function w(t,n){if(e&&n.stack&&typeof t==="object"&&t!==null&&t.stack&&t.stack.indexOf(b)===-1){var i=[];for(var r=n;!!r;r=r.source){if(r.stack){i.unshift(r.stack)}}i.unshift(t.stack);var o=i.join("\n"+b+"\n");t.stack=S(o)}}function S(e){var t=e.split("\n");var n=[];for(var i=0;i<t.length;++i){var r=t[i];if(!x(r)&&!T(r)&&r){n.push(r)}}return n.join("\n")}function T(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function k(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n){return[n[1],Number(n[2])]}var i=/.*@(.+):(\d+)$/.exec(e);if(i){return[i[1],Number(i[2])]}}function x(e){var t=k(e);if(!t){return false}var r=t[0];var o=t[1];return r===i&&o>=n&&o<=le}function M(){if(!e){return}try{throw new Error}catch(t){var n=t.stack.split("\n");var r=n[0].indexOf("@")>0?n[1]:n[2];var o=k(r);if(!o){return}i=o[0];return o[1]}}function C(e,t,n){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack)}return e.apply(e,arguments)}}function _(e){if(e instanceof N){return e}if(W(e)){return q(e)}else{return G(e)}}_.resolve=_;_.nextTick=o;_.longStackSupport=false;if(typeof process==="object"&&process&&process.env&&process.env.Q_DEBUG){_.longStackSupport=true}_.defer=B;function B(){var t=[],n=[],i;var r=f(B.prototype);var o=f(N.prototype);o.promiseDispatch=function(e,r,o){var a=l(arguments);if(t){t.push(a);if(r==="when"&&o[1]){n.push(o[1])}}else{_.nextTick(function(){i.promiseDispatch.apply(i,a)})}};o.valueOf=function(){if(t){return o}var e=H(i);if($(e)){i=e}return e};o.inspect=function(){if(!i){return{state:"pending"}}return i.inspect()};if(_.longStackSupport&&e){try{throw new Error}catch(a){o.stack=a.stack.substring(a.stack.indexOf("\n")+1)}}function s(e){i=e;o.source=e;u(t,function(t,n){_.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0);t=void 0;n=void 0}r.promise=o;r.resolve=function(e){if(i){return}s(_(e))};r.fulfill=function(e){if(i){return}s(G(e))};r.reject=function(e){if(i){return}s(V(e))};r.notify=function(e){if(i){return}u(n,function(t,n){_.nextTick(function(){n(e)})},void 0)};return r}B.prototype.makeNodeResolver=function(){var e=this;return function(t,n){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(l(arguments,1))}else{e.resolve(n)}}};_.Promise=z;_.promise=z;function z(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=B();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}z.race=D;z.all=ne;z.reject=V;z.resolve=_;_.passByCopy=function(e){return e};N.prototype.passByCopy=function(){return this};_.join=function(e,t){return _(e).join(t)};N.prototype.join=function(e){return _([this,e]).spread(function(e,t){if(e===t){return e}else{throw new Error("Can't join: not the same: "+e+" "+t)}})};_.race=D;function D(e){return z(function(t,n){for(var i=0,r=e.length;i<r;i++){_(e[i]).then(t,n)}})}N.prototype.race=function(){return this.then(_.race)};_.makePromise=N;function N(e,t,n){if(t===void 0){t=function(e){return V(new Error("Promise does not support operation: "+e))}}if(n===void 0){n=function(){return{state:"unknown"}}}var i=f(N.prototype);i.promiseDispatch=function(n,r,o){var a;try{if(e[r]){a=e[r].apply(i,o)}else{a=t.call(i,r,o)}}catch(s){a=V(s)}if(n){n(a)}};i.inspect=n;if(n){var r=n();if(r.state==="rejected"){i.exception=r.reason}i.valueOf=function(){var e=n();if(e.state==="pending"||e.state==="rejected"){return i}return e.value}}return i}N.prototype.toString=function(){return"[object Promise]"};N.prototype.then=function(e,t,n){var i=this;var r=B();var o=false;function a(t){try{return typeof e==="function"?e(t):t}catch(n){return V(n)}}function s(e){if(typeof t==="function"){w(e,i);try{return t(e)}catch(n){return V(n)}}return V(e)}function l(e){return typeof n==="function"?n(e):e}_.nextTick(function(){i.promiseDispatch(function(e){if(o){return}o=true;r.resolve(a(e))},"when",[function(e){if(o){return}o=true;r.resolve(s(e))}])});i.promiseDispatch(void 0,"when",[void 0,function(e){var t;var n=false;try{t=l(e)}catch(i){n=true;if(_.onerror){_.onerror(i)}else{throw i}}if(!n){r.notify(t)}}]);return r.promise};_.tap=function(e,t){return _(e).tap(t)};N.prototype.tap=function(e){e=_(e);return this.then(function(t){return e.fcall(t).thenResolve(t)})};_.when=P;function P(e,t,n,i){return _(e).then(t,n,i)}N.prototype.thenResolve=function(e){return this.then(function(){return e})};_.thenResolve=function(e,t){return _(e).thenResolve(t)};N.prototype.thenReject=function(e){return this.then(function(){throw e})};_.thenReject=function(e,t){return _(e).thenReject(t)};_.nearer=H;function H(e){if($(e)){var t=e.inspect();if(t.state==="fulfilled"){return t.value}}return e}_.isPromise=$;function $(e){return e instanceof N}_.isPromiseAlike=W;function W(e){return g(e)&&typeof e.then==="function"}_.isPending=F;function F(e){return $(e)&&e.inspect().state==="pending"}N.prototype.isPending=function(){return this.inspect().state==="pending"};_.isFulfilled=O;function O(e){return!$(e)||e.inspect().state==="fulfilled"}N.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};_.isRejected=A;function A(e){return $(e)&&e.inspect().state==="rejected"}N.prototype.isRejected=function(){return this.inspect().state==="rejected"};var R=[];var I=[];var L=[];var E=true;function Y(){R.length=0;I.length=0;if(!E){E=true}}function j(e,t){if(!E){return}if(typeof process==="object"&&typeof process.emit==="function"){_.nextTick.runAfter(function(){if(c(I,e)!==-1){process.emit("unhandledRejection",t,e);L.push(e)}})}I.push(e);if(t&&typeof t.stack!=="undefined"){R.push(t.stack)}else{R.push("(no stack) "+t)}}function U(e){if(!E){return}var t=c(I,e);if(t!==-1){if(typeof process==="object"&&typeof process.emit==="function"){_.nextTick.runAfter(function(){var n=c(L,e);if(n!==-1){process.emit("rejectionHandled",R[t],e);L.splice(n,1)}})}I.splice(t,1);R.splice(t,1)}}_.resetUnhandledRejections=Y;_.getUnhandledReasons=function(){return R.slice()};_.stopUnhandledRejectionTracking=function(){Y();E=false};Y();_.reject=V;function V(e){var t=N({when:function(t){if(t){U(this)}return t?t(e):this}},function n(){return this},function i(){return{state:"rejected",reason:e}});j(t,e);return t}_.fulfill=G;function G(e){return N({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){if(t===null||t===void 0){return e.apply(void 0,n)}else{return e[t].apply(e,n)}},apply:function(t,n){return e.apply(t,n)},keys:function(){return m(e)}},void 0,function t(){return{state:"fulfilled",value:e}})}function q(e){var t=B();_.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}});return t.promise}_.master=J;function J(e){return N({isDef:function(){}},function t(n,i){return te(e,n,i)},function(){return _(e).inspect()})}_.spread=Q;function Q(e,t,n){return _(e).spread(t,n)}N.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)};_.async=Z;function Z(e){return function(){function t(e,t){var o;if(typeof StopIteration==="undefined"){try{o=n[e](t)}catch(a){return V(a)}if(o.done){return _(o.value)}else{return P(o.value,i,r)}}else{try{o=n[e](t)}catch(a){if(y(a)){return _(a.value)}else{return V(a)}}return P(o,i,r)}}var n=e.apply(this,arguments);var i=t.bind(t,"next");var r=t.bind(t,"throw");return i()}}_.spawn=K;function K(e){_.done(_.async(e)())}_["return"]=X;function X(e){throw new v(e)}_.promised=ee;function ee(e){return function(){return Q([this,ne(arguments)],function(t,n){return e.apply(t,n)})}}_.dispatch=te;function te(e,t,n){return _(e).dispatch(t,n)}N.prototype.dispatch=function(e,t){var n=this;var i=B();_.nextTick(function(){n.promiseDispatch(i.resolve,e,t)});return i.promise};_.get=function(e,t){return _(e).dispatch("get",[t])};N.prototype.get=function(e){return this.dispatch("get",[e])};_.set=function(e,t,n){return _(e).dispatch("set",[t,n])};N.prototype.set=function(e,t){return this.dispatch("set",[e,t])};_.del=_["delete"]=function(e,t){return _(e).dispatch("delete",[t])};N.prototype.del=N.prototype["delete"]=function(e){return this.dispatch("delete",[e])};_.mapply=_.post=function(e,t,n){return _(e).dispatch("post",[t,n])};N.prototype.mapply=N.prototype.post=function(e,t){return this.dispatch("post",[e,t])};_.send=_.mcall=_.invoke=function(e,t){return _(e).dispatch("post",[t,l(arguments,2)])};N.prototype.send=N.prototype.mcall=N.prototype.invoke=function(e){return this.dispatch("post",[e,l(arguments,1)])};_.fapply=function(e,t){return _(e).dispatch("apply",[void 0,t])};N.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};_["try"]=_.fcall=function(e){return _(e).dispatch("apply",[void 0,l(arguments,1)])};N.prototype.fcall=function(){return this.dispatch("apply",[void 0,l(arguments)])};_.fbind=function(e){var t=_(e);var n=l(arguments,1);return function i(){return t.dispatch("apply",[this,n.concat(l(arguments))])}};N.prototype.fbind=function(){var e=this;var t=l(arguments);return function n(){return e.dispatch("apply",[this,t.concat(l(arguments))])}};_.keys=function(e){return _(e).dispatch("keys",[])};N.prototype.keys=function(){return this.dispatch("keys",[])};_.all=ne;function ne(e){var t=new Error;return P(e,function(e){var t=0;var n=B();u(e,function(i,r,o){var a;if($(r)&&(a=r.inspect()).state==="fulfilled"){e[o]=a.value}else{++t;P(r,function(i){e[o]=i;if(--t===0){n.resolve(e)}},n.reject,function(e){n.notify({index:o,value:e})})}},void 0);if(t===0){n.resolve(e)}return n.promise})}N.prototype.all=function(){return ne(this)};_.any=ie;function ie(e){if(e.length===0){return _.resolve()}var t=_.defer();var n=0;u(e,function(i,r,o){var a=e[o];n++;P(a,s,l,u);function s(e){t.resolve(e)}function l(){n--;if(n===0){t.reject(new Error("Can't get fulfillment value from any promise, all "+"promises were rejected."))}}function u(e){t.notify({index:o,value:e})}},undefined);return t.promise}N.prototype.any=function(){return ie(this)};_.allResolved=C(re,"allResolved","allSettled");function re(e){return P(e,function(e){e=d(e,_);return P(ne(d(e,function(e){return P(e,r,r)})),function(){return e})})}N.prototype.allResolved=function(){return re(this)};_.allSettled=oe;function oe(e){return _(e).allSettled()}N.prototype.allSettled=function(){return this.then(function(e){return ne(d(e,function(e){e=_(e);function t(){return e.inspect()}return e.then(t,t)}))})};_.fail=_["catch"]=function(e,t){return _(e).then(void 0,t)};N.prototype.fail=N.prototype["catch"]=function(e){return this.then(void 0,e)};_.progress=ae;function ae(e,t){return _(e).then(void 0,void 0,t)}N.prototype.progress=function(e){return this.then(void 0,void 0,e)};_.fin=_["finally"]=function(e,t){return _(e)["finally"](t)};N.prototype.fin=N.prototype["finally"]=function(e){if(!e||typeof e.apply!=="function"){throw new Error("Can't apply finally callback")}e=_(e);return this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})};_.done=function(e,t,n,i){return _(e).done(t,n,i)};N.prototype.done=function(e,t,n){var i=function(e){_.nextTick(function(){w(e,r);if(_.onerror){_.onerror(e)}else{throw e}})};var r=e||t||n?this.then(e,t,n):this;if(typeof process==="object"&&process&&process.domain){i=process.domain.bind(i)}r.then(void 0,i)};_.timeout=function(e,t,n){return _(e).timeout(t,n)};N.prototype.timeout=function(e,t){var n=B();var i=setTimeout(function(){if(!t||"string"===typeof t){t=new Error(t||"Timed out after "+e+" ms");t.code="ETIMEDOUT"}n.reject(t)},e);this.then(function(e){clearTimeout(i);n.resolve(e)},function(e){clearTimeout(i);n.reject(e)},n.notify);return n.promise};_.delay=function(e,t){if(t===void 0){
t=e;e=void 0}return _(e).delay(t)};N.prototype.delay=function(e){return this.then(function(t){var n=B();setTimeout(function(){n.resolve(t)},e);return n.promise})};_.nfapply=function(e,t){return _(e).nfapply(t)};N.prototype.nfapply=function(e){var t=B();var n=l(e);n.push(t.makeNodeResolver());this.fapply(n).fail(t.reject);return t.promise};_.nfcall=function(e){var t=l(arguments,1);return _(e).nfapply(t)};N.prototype.nfcall=function(){var e=l(arguments);var t=B();e.push(t.makeNodeResolver());this.fapply(e).fail(t.reject);return t.promise};_.nfbind=_.denodeify=function(e){var t=l(arguments,1);return function(){var n=t.concat(l(arguments));var i=B();n.push(i.makeNodeResolver());_(e).fapply(n).fail(i.reject);return i.promise}};N.prototype.nfbind=N.prototype.denodeify=function(){var e=l(arguments);e.unshift(this);return _.denodeify.apply(void 0,e)};_.nbind=function(e,t){var n=l(arguments,2);return function(){var i=n.concat(l(arguments));var r=B();i.push(r.makeNodeResolver());function o(){return e.apply(t,arguments)}_(o).fapply(i).fail(r.reject);return r.promise}};N.prototype.nbind=function(){var e=l(arguments,0);e.unshift(this);return _.nbind.apply(void 0,e)};_.nmapply=_.npost=function(e,t,n){return _(e).npost(t,n)};N.prototype.nmapply=N.prototype.npost=function(e,t){var n=l(t||[]);var i=B();n.push(i.makeNodeResolver());this.dispatch("post",[e,n]).fail(i.reject);return i.promise};_.nsend=_.nmcall=_.ninvoke=function(e,t){var n=l(arguments,2);var i=B();n.push(i.makeNodeResolver());_(e).dispatch("post",[t,n]).fail(i.reject);return i.promise};N.prototype.nsend=N.prototype.nmcall=N.prototype.ninvoke=function(e){var t=l(arguments,1);var n=B();t.push(n.makeNodeResolver());this.dispatch("post",[e,t]).fail(n.reject);return n.promise};_.nodeify=se;function se(e,t){return _(e).nodeify(t)}N.prototype.nodeify=function(e){if(e){this.then(function(t){_.nextTick(function(){e(null,t)})},function(t){_.nextTick(function(){e(t)})})}else{return this}};_.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var le=M();return _});var requirejs,require,define;(function(ba){function G(e){return"[object Function]"===K.call(e)}function H(e){return"[object Array]"===K.call(e)}function v(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function T(e,t){if(e){var n;for(n=e.length-1;-1<n&&(!e[n]||!t(e[n],n,e));n-=1);}}function t(e,t){return fa.call(e,t)}function n(e,n){return t(e,n)&&e[n]}function A(e,n){for(var i in e)if(t(e,i)&&n(e[i],i))break}function U(e,n,i,r){n&&A(n,function(n,o){if(i||!t(e,o))r&&"object"===typeof n&&n&&!H(n)&&!G(n)&&!(n instanceof RegExp)?(e[o]||(e[o]={}),U(e[o],n,i,r)):e[o]=n});return e}function u(e,t){return function(){return t.apply(e,arguments)}}function ca(e){throw e}function da(e){if(!e)return e;var t=ba;v(e.split("."),function(e){t=t[e]});return t}function B(e,t,n,i){t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);t.requireType=e;t.requireModules=i;n&&(t.originalError=n);return t}function ga(i){function r(e,t,i){var r,o,a,s,l,u,c,d,t=t&&t.split("/"),f=D.map,h=f&&f["*"];if(e){e=e.split("/");o=e.length-1;D.nodeIdCompat&&Q.test(e[o])&&(e[o]=e[o].replace(Q,""));"."===e[0].charAt(0)&&t&&(o=t.slice(0,t.length-1),e=o.concat(e));o=e;for(a=0;a<o.length;a++)if(s=o[a],"."===s)o.splice(a,1),a-=1;else if(".."===s&&!(0===a||1===a&&".."===o[2]||".."===o[a-1])&&0<a)o.splice(a-1,2),a-=2;e=e.join("/")}if(i&&f&&(t||h)){o=e.split("/");a=o.length;e:for(;0<a;a-=1){l=o.slice(0,a).join("/");if(t)for(s=t.length;0<s;s-=1)if(i=n(f,t.slice(0,s).join("/")))if(i=n(i,l)){r=i;u=a;break e}!c&&(h&&n(h,l))&&(c=n(h,l),d=a)}!r&&c&&(r=c,u=d);r&&(o.splice(0,u,r),e=o.join("/"))}return(r=n(D.pkgs,e))?r:e}function o(e){z&&v(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===x.contextName)return t.parentNode.removeChild(t),!0})}function a(e){var t=n(D.paths,e);if(t&&H(t)&&1<t.length)return t.shift(),x.require.undef(e),x.makeRequire(null,{skipMap:!0})([e]),!0}function s(e){var t,n=e?e.indexOf("!"):-1;-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length));return[t,e]}function l(e,t,i,o){var a,l,u=null,c=t?t.name:null,d=e,f=!0,h="";e||(f=!1,e="_@r"+(E+=1));e=s(e);u=e[0];e=e[1];u&&(u=r(u,c,o),l=n(O,u));e&&(u?h=l&&l.normalize?l.normalize(e,function(e){return r(e,c,o)}):-1===e.indexOf("!")?r(e,c,o):e:(h=r(e,c,o),e=s(h),u=e[0],h=e[1],i=!0,a=x.nameToUrl(h)));i=u&&!l&&!i?"_unnormalized"+(j+=1):"";return{prefix:u,name:h,parentMap:t,unnormalized:!!i,url:a,originalName:d,isDefine:f,id:(u?u+"!"+h:h)+i}}function c(e){var t=e.id,i=n(P,t);i||(i=P[t]=new x.Module(e));return i}function d(e,i,r){var o=e.id,a=n(P,o);if(t(O,o)&&(!a||a.defineEmitComplete))"defined"===i&&r(O[o]);else if(a=c(e),a.error&&"error"===i)r(a.error);else a.on(i,r)}function f(t,i){var r=t.requireModules,o=!1;if(i)i(t);else if(v(r,function(e){if(e=n(P,e))e.error=t,e.events.error&&(o=!0,e.emit("error",t))}),!o)e.onError(t)}function h(){R.length&&(v(R,function(e){var t=e[0];"string"===typeof t&&(x.defQueueMap[t]=!0);F.push(e)}),R=[])}function m(e){delete P[e];delete $[e]}function p(e,t,i){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,v(e.depMaps,function(r,o){var a=r.id,s=n(P,a);s&&(!e.depMatched[o]&&!i[a])&&(n(t,a)?(e.defineDep(o,O[a]),e.check()):p(s,t,i))}),i[r]=!0)}function g(){var e,t,n=(e=1e3*D.waitSeconds)&&x.startTime+e<(new Date).getTime(),i=[],r=[],s=!1,l=!0;if(!S){S=!0;A($,function(e){var u=e.map,c=u.id;if(e.enabled&&(u.isDefine||r.push(e),!e.error))if(!e.inited&&n)a(c)?s=t=!0:(i.push(c),o(c));else if(!e.inited&&(e.fetched&&u.isDefine)&&(s=!0,!u.prefix))return l=!1});if(n&&i.length)return e=B("timeout","Load timeout for modules: "+i,null,i),e.contextName=x.contextName,f(e);l&&v(r,function(e){p(e,{},{})});if((!n||t)&&s)if((z||ea)&&!_)_=setTimeout(function(){_=0;g()},50);S=!1}}function y(e){t(O,e[0])||c(l(e[0],null,!0)).init(e[1],e[2])}function b(e){var e=e.currentTarget||e.srcElement,t=x.onScriptLoad;e.detachEvent&&!Y?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1);t=x.onScriptError;(!e.detachEvent||Y)&&e.removeEventListener("error",t,!1);return{node:e,id:e&&e.getAttribute("data-requiremodule")}}function w(){var e;for(h();F.length;){e=F.shift();if(null===e[0])return f(B("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));y(e)}x.defQueueMap={}}var S,k,x,C,_,D={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},P={},$={},W={},F=[],O={},I={},L={},E=1,j=1;C={require:function(e){return e.require?e.require:e.require=x.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?O[e.map.id]=e.exports:e.exports=O[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return n(D.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}};k=function(e){this.events=n(W,e.id)||{};this.map=e;this.shim=n(D.shim,e.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};k.prototype={init:function(e,t,n,i){i=i||{};if(!this.inited){this.factory=t;if(n)this.on("error",n);else this.events.error&&(n=u(this,function(e){this.emit("error",e)}));this.depMaps=e&&e.slice(0);this.errback=n;this.inited=!0;this.ignore=i.ignore;i.enabled||this.enabled?this.enable():this.check()}},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0;x.startTime=(new Date).getTime();var e=this.map;if(this.shim)x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}));else return e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;I[e]||(I[e]=!0,x.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var n,i,r=this.map.id;i=this.depExports;var o=this.exports,a=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(G(a)){if(this.events.error&&this.map.isDefine||e.onError!==ca)try{o=x.execCb(r,a,i,o)}catch(s){n=s}else o=x.execCb(r,a,i,o);this.map.isDefine&&void 0===o&&((i=this.module)?o=i.exports:this.usingExports&&(o=this.exports));if(n)return n.requireMap=this.map,n.requireModules=this.map.isDefine?[this.map.id]:null,n.requireType=this.map.isDefine?"define":"require",f(this.error=n)}else o=a;this.exports=o;if(this.map.isDefine&&!this.ignore&&(O[r]=o,e.onResourceLoad))e.onResourceLoad(x,this.map,this.depMaps);m(r);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else t(x.defQueueMap,r)||this.fetch()}},callPlugin:function(){var i=this.map,o=i.id,a=l(i.prefix);this.depMaps.push(a);d(a,"defined",u(this,function(a){var s,h;h=n(L,this.map.id);var p=this.map.name,g=this.map.parentMap?this.map.parentMap.name:null,y=x.makeRequire(i.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(a.normalize&&(p=a.normalize(p,function(e){return r(e,g,!0)})||""),a=l(i.prefix+"!"+p,this.map.parentMap),d(a,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=n(P,a.id)){this.depMaps.push(a);if(this.events.error)h.on("error",u(this,function(e){this.emit("error",e)}));h.enable()}}else h?(this.map.url=x.nameToUrl(h),this.load()):(s=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=u(this,function(e){this.inited=!0;this.error=e;e.requireModules=[o];A(P,function(e){0===e.map.id.indexOf(o+"_unnormalized")&&m(e.map.id)});f(e)}),s.fromText=u(this,function(n,r){var a=i.name,u=l(a),d=M;r&&(n=r);d&&(M=!1);c(u);t(D.config,o)&&(D.config[a]=D.config[o]);try{e.exec(n)}catch(h){return f(B("fromtexteval","fromText eval for "+o+" failed: "+h,h,[o]))}d&&(M=!0);this.depMaps.push(u);x.completeLoad(a);y([a],s)}),a.load(i.name,y,s,D))}));x.enable(a,this);this.pluginMaps[a.id]=a},enable:function(){$[this.map.id]=this;this.enabling=this.enabled=!0;v(this.depMaps,u(this,function(e,i){var r,o;if("string"===typeof e){e=l(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[i]=e;if(r=n(C,e.id)){this.depExports[i]=r(this);return}this.depCount+=1;d(e,"defined",u(this,function(e){this.undefed||(this.defineDep(i,e),this.check())}));this.errback?d(e,"error",u(this,this.errback)):this.events.error&&d(e,"error",u(this,function(e){this.emit("error",e)}))}r=e.id;o=P[r];!t(C,r)&&(o&&!o.enabled)&&x.enable(e,this)}));A(this.pluginMaps,u(this,function(e){var t=n(P,e.id);t&&!t.enabled&&x.enable(e,this)}));this.enabling=!1;this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]);n.push(t)},emit:function(e,t){v(this.events[e],function(e){e(t)});"error"===e&&delete this.events[e]}};x={config:D,contextName:i,registry:P,defined:O,urlFetched:I,defQueue:F,defQueueMap:{},Module:k,makeModuleMap:l,nextTick:e.nextTick,onError:f,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=D.shim,n={paths:!0,bundles:!0,config:!0,map:!0};A(e,function(e,t){n[t]?(D[t]||(D[t]={}),U(D[t],e,!0,!0)):D[t]=e});e.bundles&&A(e.bundles,function(e,t){v(e,function(e){e!==t&&(L[e]=t)})});e.shim&&(A(e.shim,function(e,n){H(e)&&(e={deps:e});if((e.exports||e.init)&&!e.exportsFn)e.exportsFn=x.makeShimExports(e);t[n]=e}),D.shim=t);e.packages&&v(e.packages,function(e){var t,e="string"===typeof e?{name:e}:e;t=e.name;e.location&&(D.paths[t]=e.location);D.pkgs[t]=e.name+"/"+(e.main||"main").replace(ha,"").replace(Q,"")});A(P,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=l(t,null,!0))});if(e.deps||e.callback)x.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;e.init&&(t=e.init.apply(ba,arguments));return t||e.exports&&da(e.exports)}},makeRequire:function(a,s){function u(n,r,o){var d,h;s.enableBuildCallback&&(r&&G(r))&&(r.__requireJsBuild=!0);if("string"===typeof n){if(G(r))return f(B("requireargs","Invalid require call"),o);if(a&&t(C,n))return C[n](P[a.id]);if(e.get)return e.get(x,n,a,u);d=l(n,a,!1,!0);d=d.id;return!t(O,d)?f(B("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+i+(a?"":". Use require([])"))):O[d]}w();x.nextTick(function(){w();h=c(l(null,a));h.skipMap=s.skipMap;h.init(n,r,o,{enabled:!0});g()});return u}s=s||{};U(u,{isBrowser:z,toUrl:function(e){var t,n=e.lastIndexOf("."),i=e.split("/")[0];if(-1!==n&&(!("."===i||".."===i)||1<n))t=e.substring(n,e.length),e=e.substring(0,n);return x.nameToUrl(r(e,a&&a.id,!0),t,!0)},defined:function(e){return t(O,l(e,a,!1,!0).id)},specified:function(e){e=l(e,a,!1,!0).id;return t(O,e)||t(P,e)}});a||(u.undef=function(e){h();var t=l(e,a,!0),i=n(P,e);i.undefed=!0;o(e);delete O[e];delete I[t.url];delete W[e];T(F,function(t,n){t[0]===e&&F.splice(n,1)});delete x.defQueueMap[e];i&&(i.events.defined&&(W[e]=i.events),m(e))});return u},enable:function(e){n(P,e.id)&&c(e).enable()},completeLoad:function(e){var i,r,o=n(D.shim,e)||{},s=o.exports;for(h();F.length;){r=F.shift();if(null===r[0]){r[0]=e;if(i)break;i=!0}else r[0]===e&&(i=!0);y(r)}x.defQueueMap={};r=n(P,e);if(!i&&!t(O,e)&&r&&!r.inited){if(D.enforceDefine&&(!s||!da(s)))return a(e)?void 0:f(B("nodefine","No define call for "+e,null,[e]));y([e,o.deps||[],o.exportsFn])}g()},nameToUrl:function(t,i,r){var o,a,s;(o=n(D.pkgs,t))&&(t=o);if(o=n(L,t))return x.nameToUrl(o,i,r);if(e.jsExtRegExp.test(t))o=t+(i||"");else{o=D.paths;t=t.split("/");for(a=t.length;0<a;a-=1)if(s=t.slice(0,a).join("/"),s=n(o,s)){H(s)&&(s=s[0]);t.splice(0,a,s);break}o=t.join("/");o+=i||(/^data\:|\?/.test(o)||r?"":".js");o=("/"===o.charAt(0)||o.match(/^[\w\+\.\-]+:/)?"":D.baseUrl)+o}return D.urlArgs?o+((-1===o.indexOf("?")?"?":"&")+D.urlArgs):o},load:function(t,n){e.load(x,t,n)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||ia.test((e.currentTarget||e.srcElement).readyState))N=null,e=b(e),x.completeLoad(e.id)},onScriptError:function(e){var t=b(e);if(!a(t.id))return f(B("scripterror","Script error for: "+t.id,e,[t.id]))}};x.require=x.makeRequire();return x}var e,x,y,D,I,E,N,J,r,O,ja=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ka=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,Q=/\.js$/,ha=/^\.\//;x=Object.prototype;var K=x.toString,fa=x.hasOwnProperty,z=!!("undefined"!==typeof window&&"undefined"!==typeof navigator&&window.document),ea=!z&&"undefined"!==typeof importScripts,ia=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),F={},s={},R=[],M=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(G(requirejs))return;s=requirejs;requirejs=void 0}"undefined"!==typeof require&&!G(require)&&(s=require,require=void 0);e=requirejs=function(t,i,r,o){var a,s="_";!H(t)&&"string"!==typeof t&&(a=t,H(i)?(t=i,i=r,r=o):t=[]);a&&a.context&&(s=a.context);(o=n(F,s))||(o=F[s]=e.s.newContext(s));a&&o.configure(a);return o.require(t,i,r)};e.config=function(t){return e(t)};e.nextTick="undefined"!==typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()};require||(require=e);e.version="2.1.20";e.jsExtRegExp=/^\/|:|\?|\.js$/;e.isBrowser=z;x=e.s={contexts:F,newContext:ga};e({});v(["toUrl","undef","defined","specified"],function(t){e[t]=function(){var e=F._;return e.require[t].apply(e,arguments)}});if(z&&(y=x.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0]))y=x.head=D.parentNode;e.onError=ca;e.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");t.type=e.scriptType||"text/javascript";t.charset="utf-8";t.async=!0;return t};e.load=function(t,n,i){var r=t&&t.config||{},o;if(z){o=e.createNode(r,n,i);if(r.onNodeCreated)r.onNodeCreated(o,r,n,i);o.setAttribute("data-requirecontext",t.contextName);o.setAttribute("data-requiremodule",n);o.attachEvent&&!(o.attachEvent.toString&&0>o.attachEvent.toString().indexOf("[native code"))&&!Y?(M=!0,o.attachEvent("onreadystatechange",t.onScriptLoad)):(o.addEventListener("load",t.onScriptLoad,!1),o.addEventListener("error",t.onScriptError,!1));o.src=i;J=o;D?y.insertBefore(o,D):y.appendChild(o);J=null;return o}if(ea)try{importScripts(i),t.completeLoad(n)}catch(a){t.onError(B("importscripts","importScripts failed for "+n+" at "+i,a,[n]))}};z&&!s.skipDataMain&&T(document.getElementsByTagName("script"),function(t){y||(y=t.parentNode);if(I=t.getAttribute("data-main"))return r=I,s.baseUrl||(E=r.split("/"),r=E.pop(),O=E.length?E.join("/")+"/":"./",s.baseUrl=O),r=r.replace(Q,""),e.jsExtRegExp.test(r)&&(r=I),s.deps=s.deps?s.deps.concat(r):[r],!0});define=function(e,t,n){var i,r;"string"!==typeof e&&(n=t,t=e,e=null);H(t)||(n=t,t=null);!t&&G(n)&&(t=[],n.length&&(n.toString().replace(ja,"").replace(ka,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t)));if(M){if(!(i=J))N&&"interactive"===N.readyState||T(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return N=e}),i=N;i&&(e||(e=i.getAttribute("data-requiremodule")),r=F[i.getAttribute("data-requirecontext")])}r?(r.defQueue.push([e,t,n]),r.defQueueMap[e]=!0):R.push([e,t,n])};define.amd={jQuery:!0};e.exec=function(b){return eval(b)};e(s)}})(this);function waitForWebfonts(e,t){var n=5*1e3;var i=(new Date).getTime();var r=0;var o=false;for(var a=0,s=e.length;a<s;++a){(function(a){var s=document.createElement("span");s.innerHTML="giItT1WQy@!-/#";s.style.position="absolute";s.style.left="-10000px";s.style.top="-10000px";s.style.fontSize="300px";s.style.fontFamily="initial";s.style.fontVariant="normal";s.style.fontStyle="normal";s.style.fontWeight="normal";s.style.letterSpacing="0";document.body.appendChild(s);var l=s.offsetWidth;s.style.fontFamily=a;var u;function c(){if(s&&((new Date).getTime()-i>n||s.offsetWidth!=l)){++r;s.parentNode.removeChild(s);s=null;if(u){clearInterval(u)}}if(r>=e.length){if(r==e.length){if(!o){t()}o=true;return true}}}setTimeout(function(){if(!c()){u=setInterval(c,50)}})})(e[a])}}var Stream={create:function(){var e=false;var t=$.Deferred();var n;var i=[];var r=function(r){t.resolve(r);if(!e&&n!==r){n=r;i.map(function(e){return e(r)})}};return{lastValue:function(){return n},map:function(e){var t=Stream.create();if(n!==undefined){t.push(e(n))}i.push(function(n){t.push(e(n))});return t},reduce:function(e,t){var r=Stream.once(t);if(n!==undefined){r.push(e(r.lastValue(),n))}i.push(function(t){r.push(e(r.lastValue(),t))});return r},filter:function(e){var t=Stream.create();if(n!==undefined){e(n,t.push)}i.push(function(n){e(n,t.push)});return t},onValue:function(e){return this.map(function(t){e(t);return true})},promise:t.promise(),prop:function(e){return this.map(function(t){return t[e]})},delay:function(e){var t=Stream.create();this.map(function(n){setTimeout(function(){t.push(n)},e)});return t},end:function(){e=true},push:r,pushAll:function(e){this.onValue(function(t){e.push(t)})},test:function(){var e=arguments;var t=new Error;setTimeout(function(){if(n===undefined){e;t;debugger}},5e3);return this}}},once:function(e){var t=Stream.create();t.push(e);return t},never:function(){return Stream.create()},combine:function(e,t){var n=[];var i=Stream.create();var r=false;var o=new Error;var a=function(){if(!r){r=true;setTimeout(function(){o;r=false;for(var a=0;a<e.length;a++){if(n[a]===undefined){return}}i.push(t.apply(null,n))})}};e.reduce(function(e,t){t.onValue(function(t){n[e]=t;a()});return e+1},0);return i},all:function(e,t){return this.combine(e,function(){t.apply(null,arguments);return true})},combineObject:function(e){var t=Object.keys(e);var n={};var i=Stream.create();var r=false;var o=function(){if(!r){r=true;setTimeout(function(){r=false;for(var e=0;e<t.length;e++){var o=t[e];if(n[o]===undefined){return}}i.push($.extend({},n))})}};t.map(function(t,i){e[t].onValue(function(e){n[t]=e;o()})});return i},splitObject:function(e){var t=Object.keys(e);var n={};t.map(function(t){n[t]=Stream.once(e[t])});return n},fromPromise:function(e,t){var n=Stream.never();if(t){n.push(t)}e.then(function(e){n.push(e)});return n}};var child=function(e){if(!e||!e.create){console.error("faulty component")}return function(t){t.child(e)}};var children=function(e){e.map(function(e){if(!e||!e.create){console.error("faulty component")}});return function(t){t.children(e)}};var wireChildren=function(e){return function(t){t.wireChildren=e}};var component=function(e){var t={create:function(e){var t=this.build(e);t.wireChildren=t.wireChildren||function(){};var n=t.childComponentPs;var i=[];var r=n.map(function(e){if($.isArray(e)){var n=[];var r=e.map(function(e){var i=t.newCtx();n.push(i);return e.create(i)});i.push(n);return r}else{var o=t.newCtx();i.push(o);return e.create(o)}});t.childInstances=r;var o=t.wireChildren.apply(null,[t,e].concat(r))||[];var a=function(e,t,n){e=e||{};if(e.top){e.top.pushAll(n.top)}if(e.left){e.left.pushAll(n.left)}if(e.width){e.width.pushAll(n.width)}if(e.height){e.height.pushAll(n.height)}if(e.backgroundColor){e.backgroundColor.pushAll(n.backgroundColor)}if(e.fontColor){e.fontColor.pushAll(n.fontColor)}};for(var s=0;s<r.length;s++){var l=o[s]||{};var u=r[s];var c=i[s];if($.isArray(u)){for(var d=0;d<u.length;d++){a(l[d],u[d],c[d])}}else{a(l,u,c)}}return t},build:e,and:function(e){var t=this;var n=$.extend({},t);n.build=function(n){var i=t.build(n);var r=e(i,n);var o=i.destroy;if(r){i.destroy=function(){var e=r();if(e){e.then(function(){o.apply(i)})}else{o.apply(i)}}}return i};return n},all:function(e){return e.reduce(function(e,t){return e.and(t)},this)}};return t};var findOptimalHeight=function(e,t){var n=$(".sandbox");var i=e.clone();i.css("height","").css("width",t).appendTo(n);var r=parseInt(i.css("height"));i.remove();return r};var findMinWidth=function(e){var t=$(".sandbox");var n=e.clone();n.css("width","").css("height","").appendTo(t);var i=parseInt(n.css("width"));n.remove();return i};var findScrollWidth=function(e,t){var n=$(".sandbox");var i=e.clone();i.css("width",t).css("height","").appendTo(n);var r=i[0].scrollWidth;i.remove();return r};var findMinHeight=function(e){var t=$(".sandbox");var n=e.clone();n.css("width","").css("height","").appendTo(t);var i=parseInt(n.css("height"));n.remove();return i};var updateDomFuncs=[];var updateDomFunc=function(e){if(updateDomFuncs.length===0){setTimeout(function(){updateDomFuncs.map(function(e){e()});updateDomFuncs=[];updateWindowWidth()})}updateDomFuncs.push(e)};var el=function(e){return component(function(t){var n=Stream.never();var r=Stream.never();var o=function(){var e=findMinHeight(i.$el);i.minWidth.push(mw);i.minHeight.push(e)};var a=$(document.createElement(e));a.css("position","absolute");a.css("visibility","hidden");t.$el.append(a);t.top.onValue(function(e){updateDomFunc(function(){a.css("top",px(e))})});t.left.onValue(function(e){updateDomFunc(function(){a.css("left",px(e))})});t.width.onValue(function(e){updateDomFunc(function(){a.css("width",px(e))})});t.height.onValue(function(e){updateDomFunc(function(){a.css("height",px(e))})});Stream.combine([t.width,t.height,t.top,t.left],function(){updateDomFunc(function(){a.css("visibility","")})});t.backgroundColor.onValue(function(e){a.css("background-color",e)});t.fontColor.onValue(function(e){a.css("color",e)});var s=[];var l=Stream.combine([t.scroll,t.top],function(e,t){return e-t});var u=Stream.combine([t.topAccum,t.top],function(e,t){return e+t});var c=Stream.combine([t.leftAccum,t.left],function(e,t){return e+t});var d=function(e){return{$el:a,scroll:l,topAccum:u,top:Stream.never(),left:Stream.never(),leftAccum:c,width:Stream.never(),height:Stream.never(),backgroundColor:Stream.once("rgba(0,0,0,0)"),fontColor:Stream.once("inherit")}};return{$el:a,optimalWidth:0,minWidth:n,minHeight:r,newCtx:d,childComponentPs:s,child:function(e){s.push(e)},children:function(e){s.push(e)},destroy:function(){n.end();r.end();var e=this.childInstances||[];for(var t=0;t<e.length;t++){var i=e[t];if($.isArray(i)){var o=i;o.map(function(e){e.destroy()})}else{i.destroy()}}this.$el.remove()},updateDimensions:function(e){var t=findMinWidth(this.$el);var n=findMinHeight(this.$el);if(!e||t!==0){this.minWidth.push(t)}if(!e||n!==0){this.minHeight.push(n)}}}})};var a=el("a");var button=el("button");var div=el("div");var form=el("form");var img=el("img");var input=el("input");var li=el("li");var option=el("option");var select=el("select");var textarea=el("textarea");var ul=el("ul");var rootContext=function(){return{$el:$("body"),top:Stream.once(0),topAccum:Stream.once(0),left:Stream.once(0),leftAccum:Stream.once(0),scroll:windowScroll,width:windowWidth,height:Stream.never(),backgroundColor:Stream.once("white"),fontColor:Stream.once("black")}};var rootComponent=function(e,t,n){var i=$.extend(rootContext(),t);var r=e.create(i);r.minHeight.pushAll(i.height);if(n){i.width.map(function(e){i.$el.css("width",e)});i.height.map(function(e){i.$el.css("height",e)})}return r};var passThroughToFirst=function(e,t,n){n.minHeight.pushAll(e.minHeight);n.minWidth.pushAll(e.minWidth);return[{width:t.width,height:t.height,top:Stream.once(0),left:Stream.once(0)}]};var unit=function(e){return function(t){return t+e}};var px=unit("px");var url=function(e){return'url("'+e+'")'};var color=function(e){return $.extend({r:0,g:0,b:0,a:1},e)};var multiplyColor=function(e){return function(t){return{r:Math.min(255,t.r*e),g:Math.min(255,t.g*e),b:Math.min(255,t.b*e),a:t.a}}};var desaturate=function(e){return function(t){var n=(t.r+t.g+t.b)/3;var i=1-e;return{r:i*t.r+e*n,g:i*t.g+e*n,b:i*t.b+e*n,a:t.a}}};var colorString=function(e){return"rgba("+Math.floor(e.r)+","+Math.floor(e.g)+","+Math.floor(e.b)+","+e.a+")"};var rgbColorString=function(e){return"rgb("+Math.floor(e.r)+","+Math.floor(e.g)+","+Math.floor(e.b)+")"};var transparent=color({a:0});var black=color({r:0,g:0,b:0});var white=color({r:255,g:255,b:255});var $$=function(e){return function(){var t=Array.prototype.slice.call(arguments);return function(n){n.$el[e].apply(n.$el,t);setTimeout(function(){n.updateDimensions(true)})}}};var $addClass=$$("addClass");var $css=$$("css");var $attr=$$("attr");var $prop=$$("prop");var chooseHeightFromWidth=function(e,t){var n=false;t.width.onValue(function(t){if(!n){n=true;setTimeout(function(){var i=findOptimalHeight(e.$el,t);e.minHeight.push(i);n=false})}})};var $html=function(e,t){return function(n,i){n.$el.html(e);chooseHeightFromWidth(n,i);if(t){n.updateDimensions()}}};var windowWidth=Stream.never();var windowHeight=Stream.never();var updateWindowWidth=function(){windowWidth.push(document.body.clientWidth)};var updateWindowHeight=function(){windowHeight.push(window.innerHeight)};$(updateWindowWidth);$(updateWindowHeight);$(window).on("resize",function(){updateWindowWidth();updateWindowHeight()});var windowResize=Stream.once(null);$(window).on("resize",function(e){windowResize.push(e)});var windowScroll=Stream.never();$(window).on("scroll",function(){windowScroll.push(window.scrollY)});windowScroll.push(window.scrollY);var windowHash=Stream.never();$(window).on("hashchange",function(){windowHash.push(location.hash)});windowHash.push(location.hash);var withMinWidth=function(e,t){return function(n){n.minWidth.push(e);if(t){n.minWidth.end()}}};var withMinHeight=function(e,t){return function(n){n.minHeight.push(e);if(t){n.minHeight.end()}}};var adjustMinSize=function(e){return function(t){return div.all([child(t),wireChildren(function(t,n,i){i.minWidth.map(function(t){return e.mw(t)}).pushAll(t.minWidth);i.minHeight.map(function(t){return e.mh(t)}).pushAll(t.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height}]})])}};var withBackgroundColor=function(e){return function(t,n){n.backgroundColor.push(colorString(e))}};var withFontColor=function(e){return function(t,n){n.fontColor.push(colorString(e))}};var link=$css("cursor","pointer");var componentName=function(e){return function(t){t.$el.addClass(e)}};var onThis=function(e){return function(t){return function(n){var i=false;n.$el.on(e,function(e){if(!i){return t(e,function(){i=true;return function(){i=false}},n)}})}}};var changeThis=onThis("change");var clickThis=onThis("click");var inputPropertychangeThis=onThis("input propertychange");var keydownThis=onThis("keydown");var keyupThis=onThis("keyup");var mousedownThis=onThis("mousedown");var mouseoverThis=onThis("mouseover");var mouseoutThis=onThis("mouseout");var mouseupThis=onThis("mouseup");var submitThis=onThis("click");var hoverThis=function(e){return function(t){t.$el.on("mouseover",function(){e(true,t)});t.$el.on("mouseout",function(){e(false,t)})}};var cssStream=function(e,t){return function(n){t.map(function(t){n.$el.css(e,t)})}};var keepAspectRatioCorner=function(e){e=e||{};return function(t){return div.all([child(t),wireChildren(function(t,n,i){i.minWidth.pushAll(t.minWidth);i.minHeight.pushAll(t.minHeight);var r={top:Stream.create(),left:Stream.create(),width:Stream.create(),height:Stream.create()};Stream.combine([i.minWidth,i.minHeight,n.width,n.height],function(t,n,i,o){var a=t/n;var s=i/o;if(s>a){var l=o*a;var u;if(e.left){u=0}else if(e.right){u=i-l}else{u=(i-l)/2}r.top.push(0);r.left.push(u);r.width.push(l);r.height.push(o)}else{var c=i/a;var d;if(e.top){d=0}else if(e.bottom){d=o-c}else{d=(o-c)/2}r.top.push(d);r.left.push(0);r.width.push(i);r.height.push(c)}});return[r]})])}};var keepAspectRatio=keepAspectRatioCorner();var image=function(e){var t=e.src&&e.src.map?e.src:Stream.once(e.src);return img.all([function(n,i){t.map(function(e){n.$el.prop("src",e)});n.minWidth.push(e.minWidth||e.chooseWidth||0);n.minHeight.push(e.minHeight||e.chooseHeight||0);n.$el.css("display","none");n.$el.on("load",function(){n.$el.css("display","");var t=n.$el[0].naturalWidth;var r=n.$el[0].naturalHeight;var o=t/r;var a,s;if(e.useNativeSize!==undefined){n.minWidth.push(t);n.minHeight.push(r)}if(e.minWidth!==undefined){a=e.minWidth;s=a/o;n.minWidth.push(a);n.minHeight.push(s)}else if(e.minHeight!==undefined){s=e.minHeight;a=s*o;n.minWidth.push(a);n.minHeight.push(s)}if(e.chooseWidth!==undefined){i.height.map(function(t){return Math.max(e.chooseWidth,t*o)}).pushAll(n.minWidth)}if(e.chooseHeight!==undefined){i.width.map(function(t){return Math.max(e.chooseHeight,t/o)}).pushAll(n.minHeight)}})}])};var linkTo=function(e,t){return a.all([$prop("href",e),child(t),wireChildren(passThroughToFirst)])};var nothing=div.all([componentName("nothing"),withMinHeight(0),withMinWidth(0)]);var text=function(e){if(!(e.map&&e.push)){e=Stream.once(e)}return div.all([componentName("text"),function(t,n){chooseHeightFromWidth(t,n);e.onValue(function(e){if(e){while(e.indexOf(" ")!==-1){e=e.replace(" ","&nbsp;")}}t.$el.html(e);t.minWidth.push(findMinWidth(t.$el))})}])};var faIcon=function(e){return text('<i class="fa fa-'+e+'"></i>')};var paragraph=function(e,t){if(!(e.map&&e.push)){e=Stream.once(e)}t=t||0;return div.all([componentName("paragraph"),function(n,i){chooseHeightFromWidth(n,i);n.updateDimensions=function(){n.minWidth.push(findScrollWidth(n.$el,t))};e.onValue(function(e){n.$el.html(e);n.updateDimensions()});Stream.combine([e,i.width],function(e,t){var i=findOptimalHeight(n.$el,t);n.minHeight.push(i)})}])};var ignoreSurplusWidth=function(e,t){return t};var ignoreSurplusHeight=function(e,t){return t};var evenSplitSurplusWidth=function(e,t){var n=t[t.length-1];var i=e-(n.left+n.width);var r=i/t.length;t.map(function(e,t){e.width+=r;e.left+=t*r});return t};var justifySurplusWidth=function(e,t){var n=t[t.length-1];var i=e-(n.left+n.width);t.map(function(e,n){for(var r=0;r<n;r++){e.left+=i/(t.length-1)}});return t};var justifyAndCenterSurplusWidth=function(e,t){var n=t[t.length-1];var i=e-(n.left+n.width);t.map(function(e,n){e.left+=n*i/t.length+i/(2*t.length)});return t};var superSurplusWidth=function(e,t){var n=t[t.length-1];var i=e-(n.left+n.width);if(t.length===1){if(i<t[0].width){return evenSplitSurplusWidth(e,t)}else{return t;
}}if(t.length===2){return justifyAndCenterSurplusWidth(e,t)}return justifySurplusWidth(e,t)};var giveToNth=function(e){return function(t,n){var i=n[n.length-1];var r=t-(i.left+i.width);n.map(function(t,i){if(i===e||i===n.length-1&&e>=n.length){t.width+=r}else if(i>e){t.left+=r}});return n}};var giveToFirst=giveToNth(0);var giveToSecond=giveToNth(1);var giveToThird=giveToNth(2);var giveHeightToNth=function(e){return function(t,n){var i=n[n.length-1];var r=t-(i.top+i.height);n.map(function(t,i){if(i===e||i===n.length-1&&e>=n.length){t.height+=r}else if(i>e){t.top+=r}});return n}};var slideshow=function(e,t){e.gutterSize=e.gutterSize||0;e.leftTransition=e.leftTransition||"none";e.alwaysFullWidth=e.alwaysFullWidth||false;return div.all([$css("overflow","hidden"),componentName("slideshow"),children(t.map(function(t){return t.all([$css("transition","left "+e.leftTransition)])})),wireChildren(function(t,n,i){var r=Stream.combine(i.map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);return e});r.onValue(function(n){t.minWidth.push(n.reduce(function(e,t){return e+t},e.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.once(0),left:Stream.never(),width:Stream.never(),height:n.height}});Stream.all([e.selected,n.width,r],function(t,n,i){var r=0;var a=0;var s=0;var l=i.map(function(i,o){i=e.alwaysFullWidth?n:i;if(t===o){r=s+e.gutterSize*o;a=i}var l={left:s+e.gutterSize*o,width:i};s+=i;return l});var u=(n-a)/2-r;l.map(function(e){e.left+=u});l.map(function(e,t){var n=o[t];n.left.push(e.left);n.width.push(e.width)})});Stream.combine(i.map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);var t=e.reduce(function(e,t){return Math.max(e,t)},0);o.map(function(e){e.height.push(t)});return t}).pushAll(t.minHeight);return[o]})])};var sideBySide=function(e,t){e.gutterSize=e.gutterSize||0;e.handleSurplusWidth=e.handleSurplusWidth||ignoreSurplusWidth;return div.all([componentName("sideBySide"),children(t),wireChildren(function(t,n,i){var r=Stream.combine(i.map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);return e});r.onValue(function(n){t.minWidth.push(n.reduce(function(e,t){return e+t},e.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.once(0),left:Stream.never(),width:Stream.never(),height:n.height}});Stream.all([n.width,r],function(t,n){var i=0;var r=n.map(function(t,n){var r={left:i+e.gutterSize*n,width:t};i+=t;return r});r=e.handleSurplusWidth(t,r);r.map(function(e,t){var n=o[t];n.left.push(e.left);n.width.push(e.width)})});Stream.combine(i.map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)}).pushAll(t.minHeight);return[o]})])};var stack2=function(e,t){e.gutterSize=e.gutterSize||0;e.handleSurplusHeight=e.handleSurplusHeight||ignoreSurplusHeight;return div.all([componentName("stack2"),children(t),wireChildren(function(t,n,i){var r=Stream.combine(i.map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);return e});r.onValue(function(n){t.minHeight.push(n.reduce(function(e,t){return e+t},e.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.create(),left:Stream.once(0),width:n.width,height:Stream.never()}});Stream.all([n.height,r],function(t,n){var i=0;var r=n.map(function(t,n){var r={top:i+e.gutterSize*n,height:t};i+=t;return r});r=e.handleSurplusHeight(t,r);r.map(function(e,t){var n=o[t];n.top.push(e.top);n.height.push(e.height)})});Stream.combine(i.map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)}).pushAll(t.minWidth);return[o]})])};var intersperse=function(e,t){var n=[];e.map(function(e){n.push(e);n.push(t)});n.pop();return n};var stackTwo=function(e,t){e.gutterSize=e.gutterSize||0;e.align=e.align||"left";return div.all([componentName("stack"),children(t),wireChildren(function(t,n,i){var r=i[0];var o=i[1];var a=e.gutterSize;var s=[];t.minHeight.push(0);t.minWidth.push(0);Stream.combine([r.minHeight,o.minHeight],function(e,t){return e+t+a}).pushAll(t.minHeight);Stream.combine([r.minWidth,o.minWidth],function(e,t){return Math.max(e,t)}).pushAll(t.minWidth);return[[{top:Stream.once(0),left:Stream.once(0),width:n.width,height:r.minHeight},{top:r.minHeight.map(function(e){return e+a}),left:Stream.once(0),width:n.width,height:o.minHeight}]]})])};var stack=function(e,t){e.gutterSize=e.gutterSize||0;e.collapseGutters=e.collapseGutters||false;e.align=e.align||"left";if(t.length===0){t=[nothing]}return div.all([componentName("stack"),children(t),wireChildren(function(t,n,i){var r=e&&e.gutterSize||0;var o=function(t){if(t.length===0){return Stream.once(0)}return Stream.combine(t.map(function(t,i){var r;if(e&&e.mhs&&e.mhs[i]){var o=e.mhs[i](n);return Stream.combine([t.minHeight,o],function(e,t){return Math.max(e,t)})}else{return t.minHeight}return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(function(t,n){return t+n+(e.collapseGutters&&n===0?0:r)},-r);return n})};var a=[];i.reduce(function(t,i,s){var l=o(t).map(function(t){return t+(s===0||e.collapseGutters&&t===0?0:r)});var u;if(e&&e.mhs&&e.mhs[t.length]){var c=e.mhs[t.length](n);u=Stream.combine([i.minHeight,c],function(e,t){return Math.max(e,t)})}else{u=i.minHeight}a.push({top:l,left:Stream.once(0),width:n.width,height:u});t.push(i);return t},[]);o(i).pushAll(t.minHeight);Stream.combine(i.map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)}).pushAll(t.minWidth);return[a]})])};var adjustPosition=function(e,t){var n=e.top||0;var i=e.left||0;var r=e.expand;return div.all([componentName("adjustPosition"),child(t),wireChildren(function(e,t,o){o.minWidth.map(function(e){return e+r?i:0}).pushAll(e.minWidth);o.minHeight.map(function(e){return e+r?n:0}).pushAll(e.minHeight);return[{top:t.top.map(function(e){return e+n}),left:t.left.map(function(e){return e+i}),width:t.width,height:t.height}]})])};var padding=function(e,t){var n=e.all||0,i=e.all||0,r=e.all||0,o=e.all||0;if($.isNumeric(e)){n=i=r=o=e}else{for(var a in e){var s=a.toLowerCase();if(s.indexOf("top")!==-1){n=e[a]}if(s.indexOf("bottom")!==-1){i=e[a]}if(s.indexOf("left")!==-1){r=e[a]}if(s.indexOf("right")!==-1){o=e[a]}}}return div.all([componentName("padding"),child(t),wireChildren(function(e,t,a){a.minWidth.map(function(e){return e+r+o}).pushAll(e.minWidth);a.minHeight.map(function(e){return e+n+i}).pushAll(e.minHeight);return[{top:Stream.once(n,"padding top"),left:Stream.once(r,"padding left"),width:t.width.map(function(e){return e-r-o}),height:t.height.map(function(e){return e-n-i})}]})])};var alignLRM=function(e){return div.all([componentName("alignLRM"),child(e.middle||nothing),child(e.left||nothing),child(e.right||nothing),wireChildren(function(e,t,n,i,r){var o=Stream.combine([n,i,r].map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);var t=e.reduce(function(e,t){return Math.max(e,t)},0);return t});o.pushAll(e.minHeight);Stream.combine([n,i,r].map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);var t=e.reduce(function(e,t){return e+t},0);return t}).pushAll(e.minWidth);var a=function(e,t){return Stream.combine([e,t],function(e,t){return Math.min(e,t)})};var s=a(t.width,n.minWidth);var l=a(t.width,i.minWidth);var u=a(t.width,r.minWidth);return[{top:Stream.once(0),left:Stream.combine([t.width,s],function(e,t){return(e-t)/2}),width:s,height:t.height},{top:Stream.once(0),left:Stream.once(0),width:l,height:t.height},{top:Stream.once(0),left:Stream.combine([t.width,u],function(e,t){return e-t}),width:u,height:t.height}]})])};var alignTBM=function(e){e.middle=e.middle||nothing;e.bottom=e.bottom||nothing;e.top=e.top||nothing;return div.all([componentName("alignTBM"),child(e.middle),child(e.bottom),child(e.top),wireChildren(function(e,t,n,i,r){var o=Stream.combine([n,i,r].map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);var t=e.reduce(function(e,t){return Math.max(e,t)},0);return t});o.pushAll(e.minWidth);Stream.combine([n,i,r].map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);var t=e.reduce(function(e,t){return e+t},0);return t}).pushAll(e.minHeight);return[{top:Stream.combine([t.height,n.minHeight],function(e,t){return(e-t)/2}),left:Stream.once(0),width:t.width,height:n.minHeight},{top:Stream.combine([t.height,i.minHeight],function(e,t){return e-t}),left:Stream.once(0),width:t.width,height:i.minHeight},{top:Stream.once(0),left:Stream.once(0),width:t.width,height:r.minHeight}]})])};var invertOnHover=function(e){var t=Stream.once(false,"invert");var n=function(e,n){return Stream.combine([t,e,n],function(e,t,n){return e?n:t},"choose stream")};return div.all([componentName("invert-on-hover"),child(e.and($css("transition","background-color 0.2s linear, color 0.1s linear"))),wireChildren(function(e,t,i){i.minHeight.pushAll(e.minHeight);i.minWidth.pushAll(e.minWidth);return[{backgroundColor:n(t.backgroundColor,t.fontColor),fontColor:n(t.fontColor,t.backgroundColor),top:Stream.once(0),left:Stream.once(0),width:t.width,height:t.height}]}),mouseoverThis(function(){t.push(true)}),mouseoutThis(function(){t.push(false)})])};var border=function(e,t,n){var i=t.left||t.all||0;var r=t.right||t.all||0;var o=t.top||t.all||0;var a=t.bottom||t.all||0;var s=t.radius||0;var l=colorString(e);return div.all([componentName("border"),child(div.all([componentName("border-child"),$css("border-left",px(i)+" solid "+l),$css("border-right",px(r)+" solid "+l),$css("border-top",px(o)+" solid "+l),$css("border-bottom",px(a)+" solid "+l),$css("border-radius",px(s)),child(n),wireChildren(passThroughToFirst)])),wireChildren(function(e,t,n){n.minWidth.map(function(e){return e+i+r}).pushAll(e.minWidth);n.minHeight.map(function(e){return e+o+a}).pushAll(e.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:t.width.map(function(e){return e-i-r}),height:t.height.map(function(e){return e-o-a})}]})])};var componentStream=function(e){var t;return div.all([componentName("component-stream"),function(n,i){var r=n.newCtx();r.top.push(0);r.left.push(0);i.width.pushAll(r.width);i.height.pushAll(r.height);var o=Stream.create();e.pushAll(o);o.map(function(e){var i=function(e){if(t){t.destroy()}t=e.create(r);t.$el.css("transition","inherit");t.minWidth.pushAll(n.minWidth);t.minHeight.pushAll(n.minHeight)};if(e.then){e.then(function(e){i(e)},function(e){console.error("child components failed to load");console.log(e)})}else{i(e)}});return function(){o.end();if(t){t.destroy()}}}])};var promiseComponent=function(e){var t=Stream.once(nothing);e.then(function(e){t.push(e)},function(e){console.log(e)});return componentStream(t)};var toggleComponent=function(e,t){return componentStream(t.map(function(t){return e[t]}))};var modalDialog=function(e){return function(t,n){var i=Stream.once(false);t.pushAll(i);n=n||0;return div.all([$css("z-index",100),componentName("toggle-height"),child(e),wireChildren(function(e,t,r){e.minWidth.push(0);e.minHeight.push(0);var o=r.$el;o.css("position","fixed");o.css("transition",o.css("transition")+", opacity "+n+"s");o.css("display","none");i.onValue(function(e){if(e){o.css("display","");setTimeout(function(){o.css("opacity",1)},100)}else{o.css("opacity",0);setTimeout(function(){o.css("display","none")},n*1e3)}});return[{width:Stream.combine([windowWidth,r.minWidth],function(e,t){return Math.min(e,t)}),height:Stream.combine([windowHeight,r.minHeight],function(e,t){return Math.min(e,t)}),left:Stream.combine([windowWidth,r.minWidth],function(e,t){return Math.max(0,(e-t)/2)}),top:Stream.combine([windowHeight,r.minHeight],function(e,t){return Math.max(0,(e-t)/2)})}]})])}};var toggleHeight=function(e){var t=Stream.once(false);e.pushAll(t);return function(e){return div.all([$css("overflow","hidden"),componentName("toggle-height"),child(e),wireChildren(function(e,n,i){i.minWidth.pushAll(e.minWidth);Stream.combine([i.minHeight,t],function(e,t){return t?e:0}).pushAll(e.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height}]})])}};var dropdownPanel=function(e,t,n,i){i=i||{};i.transition=i.transition||"0.5s";return div.all([componentName("dropdown-panel"),child(div.all([child(t),wireChildren(function(e,t,r){r.minWidth.pushAll(e.minWidth);r.minHeight.pushAll(e.minHeight);r.$el.css("transition","top "+i.transition);e.$el.css("pointer-events","none");r.$el.css("pointer-events","initial");r.$el.css("z-index","1000");return[{width:t.width,height:r.minHeight,top:Stream.combine([n,r.minHeight],function(e,t){return e?0:-t}),left:Stream.once(0)}]}),$css("overflow","hidden")])),child(e),wireChildren(function(e,t,n,i){i.minWidth.pushAll(e.minWidth);i.minHeight.pushAll(e.minHeight);return[{width:t.width,height:n.minHeight,top:t.height,left:Stream.once(0)},{width:t.width,height:t.height,top:Stream.once(0),left:Stream.once(0)}]})])};var fixedHeaderBody=function(e,t,n){e.transition=e.transition||"0.5s";return div.all([componentName("fixedHeaderBody"),child(n),child(t),wireChildren(function(t,n,i,r){r.$el.css("position","fixed");setTimeout(function(){r.$el.css("transition","height "+e.transition);i.$el.css("transition","top "+e.transition)});Stream.combine([i,r].map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return e+t},0)}).pushAll(t.minHeight);Stream.combine([i,r].map(function(e){return e.minWidth}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)}).pushAll(t.minWidth);return[{top:r.minHeight,left:Stream.once(0),width:n.width,height:i.minHeight},{top:Stream.once(0),left:Stream.once(0),width:n.width,height:r.minHeight}]})])};var stickyHeaderBody=function(e,t,n){return div.all([componentName("stickyHeaderBody"),child(e),child(n),child(t),wireChildren(function(e,t,n,i,r){Stream.combine([n,i,r].map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return e+t},0)}).pushAll(e.minHeight);var o=false;return[{top:Stream.once(0),left:Stream.once(0),width:t.width,height:n.minHeight},{top:Stream.combine([n.minHeight,r.minHeight],function(e,t){return e+t}),left:Stream.once(0),width:t.width,height:i.minHeight},{top:Stream.combine([n.minHeight,t.scroll,t.topAccum],function(e,t,n){var i=r.$el;e=Math.floor(e);if(e>t+n){i.css("position","absolute");i.css("transition","");if(o){window.scrollTo(0,e+n)}o=false;return e}else if(e<t+n){i.css("position","fixed");setTimeout(function(){i.css("transition","inherit")},20);if(!o){window.scrollTo(0,e+n)}o=true;return n}}),left:Stream.once(0),width:t.width,height:r.minHeight}]})])};var grid=function(e,t){e.gutterSize=e.gutterSize||0;e.handleSurplusWidth=e.handleSurplusWidth||ignoreSurplusWidth;e.handleSurplusHeight=e.handleSurplusHeight||ignoreSurplusHeight;return padding(e.outerGutter?e.gutterSize:0,div.all([componentName("grid"),children(t),wireChildren(function(t,n,i){if(i.length===0){t.minWidth.push(0);t.minHeight.push(0)}var r=Stream.combine(i.map(function(e){return e.minWidth}),function(){return Array.prototype.slice.call(arguments)});var o=Stream.combine(i.map(function(e){return e.minHeight}),function(){return Array.prototype.slice.call(arguments)});r.map(function(t){return t.reduce(function(t,n){return e.useFullWidth?t+n:Math.max(t,n)},e.useFullWidth?e.gutterSize*(t.length-1):0)}).pushAll(t.minWidth);var a=i.map(function(e){return{top:Stream.never(),left:Stream.never(),width:Stream.never(),height:Stream.never()}});var s=Stream.combine([n.width,r],function(t,n){var r=function(){return{cells:[],contexts:[],height:0}};var o=i.reduce(function(i,o,s){var l=i.rows;var u=i.currentRow;var c=n[s];var d=u.cells.reduce(function(t,n){return t+n+e.gutterSize},0);var f=Math.min(c,t);if(f>0&&f+d>t){l.push(u);u=r()}u.cells.push(f);u.contexts.push(a[s]);return{rows:l,currentRow:u}},{rows:[],currentRow:r()});var s=o.rows;s.push(o.currentRow);s.map(function(n,i){var r=0;var o=n.cells.map(function(t){var n={left:r,width:t};r+=t+e.gutterSize;return n});o=e.handleSurplusWidth(t,o,e,i);o.map(function(e,t){var i=n.contexts[t];i.width.push(e.width)})});return s});var l=Stream.combine([o,s],function(n,i){var r=0;i.map(function(e){e.height=0;e.cells.map(function(t,i){e.height=Math.max(e.height,n[r+i])});r+=e.cells.length});t.minHeight.push(i.map(function(e){return e.height}).reduce(function(t,n){return t+n+e.gutterSize},-e.gutterSize));return i});Stream.all([n.width,n.height,l],function(t,n,i){if(e.bottomToTop){i=i.slice(0).reverse()}var r=0;i=e.handleSurplusHeight(n,i,e);i.map(function(n,i){var o=0;var a=n.cells.map(function(t){var i={top:r,left:o,width:t,height:n.height};o+=t+e.gutterSize;return i});a=e.handleSurplusWidth(t,a,e,i);a.map(function(e,t){var i=n.contexts[t];i.top.push(e.top);i.left.push(e.left);i.width.push(e.width);i.height.push(e.height)});r+=n.height+e.gutterSize})});return[a]})]))};var backgroundImagePosition={fit:"fit",fill:"fill"};var withMinHeightStream=function(e,t){return div.all([componentName("with-min-height-stream"),child(t),wireChildren(function(t,n,i){e(i,n).pushAll(t.minHeight);i.minWidth.pushAll(t.minWidth);return[{top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height}]})])};var extendToWindowBottom=function(e,t){t=t||Stream.once(0);return withMinHeightStream(function(e,n){return Stream.combine([e.minHeight,n.top,n.topAccum,t,windowResize],function(e,t,n,i){return Math.max(e,window.innerHeight-t-n-i)})},e)};var overlays=function(e){return div.all([children(e),wireChildren(function(e,t,n){var i=function(e){return Stream.combine(e,function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)})};i(n.map(function(e){return e.minHeight})).test().pushAll(e.minHeight);i(n.map(function(e){return e.minWidth})).test().pushAll(e.minWidth);return[n.map(function(e){return{top:Stream.once(0),left:Stream.once(0),width:t.width,height:t.height}})]})])};var withBackground=function(e,t){return div.all([componentName("with-background"),child(e),child(t),wireChildren(function(e,t,n,i){i.minWidth.pushAll(e.minWidth);i.minHeight.pushAll(e.minHeight);var r={top:Stream.once(0),left:Stream.once(0),width:t.width,height:t.height};return[r,r]})])};var withBackgroundImage=function(e,t){var n=Stream.once(e.aspectRatio||1);if(!e.src.map){e.src=Stream.once(e.src)}return div.all([componentName("with-background-image"),$css("overflow","hidden"),child(img.all([$css("visibility","hidden"),function(t,i){t.minWidth.push(0);t.minHeight.push(0);e.src.map(function(e){t.$el.prop("src",e)});t.$el.on("load",function(){var e=findMinWidth(t.$el);var i=findMinHeight(t.$el);var r=e/i;n.push(r)});Stream.all([i.width,i.height],function(){t.$el.css("visibility","")})}])),child(t),wireChildren(function(e,t,i,r){r.minWidth.pushAll(e.minWidth);r.minHeight.pushAll(e.minHeight);var o=e.newCtx();t.top.push(0);t.left.push(0);t.width.pushAll(o.width);t.height.pushAll(o.height);var a=e.newCtx();a.top.push(0);a.left.push(0);Stream.all([n,t.width,t.height],function(e,t,n){var i=t/n;if(e<i){a.width.push(t);a.height.push(t/e)}else{a.width.push(n*e);a.height.push(n)}});return[a,o]})])};var table=function(e,t){e=e||{};var n=(e.paddingSize||0)*2;return div.all(t.map(function(e){return children(e)})).all([componentName("table"),wireChildren(function(){var e=Array.prototype.slice.call(arguments);var t=e[0];var i=e[1];var r=e.slice(2);var o=Stream.combine(r.reduce(function(e,t){e.push(Stream.combine(t.map(function(e){return e.minWidth}),function(){return Array.prototype.slice.call(arguments)}));return e},[]),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return t.map(function(t,n){return Math.max(e[n]||0,t)})},[])});o.map(function(e){var i=e.reduce(function(e,t){return e+t+n},-n);t.minWidth.push(i)});var a=r.reduce(function(e,t){e.push(Stream.combine(t.map(function(e){return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)}));return e},[]);Stream.combine(a,function(){var e=Array.prototype.slice.call(arguments);var i=e.reduce(function(e,t){return e+t+n},-n);t.minHeight.push(i)});return a.map(function(e,t){return r[t].map(function(e,i){return{width:o.map(function(e){return e[i]}),height:a[t],top:Stream.combine(a.slice(0,t).concat([Stream.once(0)]),function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return e+t+n},-n)}),left:o.map(function(e){return e.reduce(function(e,t,r){return e+(r<i?t+n:0)},0)})}})})})])};var tabs=function(e,t){var n=t||Stream.once(0);return stack({},[sideBySide({},e.map(function(e,t){return alignTBM({bottom:toggleComponent([e.tab.left,e.tab.right,e.tab.selected],n.map(function(e){if(t<e){return 0}if(t>e){return 1}return 2})).all([link,clickThis(function(){n.push(t)})])})})),componentStream(n.map(function(t){return e[t].content}))])};var matchStrings=function(e){return function(t){for(var n=0;n<e.length;n++){var i=e[n];if(t.indexOf(i.string)===0){return i.router(t.substring(i.string.length))}}}};var routeToComponent=function(e){return function(){return e}};var routeToComponentF=function(e){return function(){return e()}};var routeToFirst=function(e){return function(t){for(var n=0;n<e.length;n++){var i=e[n](t);if(i){return i}}}};var routeMatchRest=function(e){return function(t){return Q(t).then(e)}};var ignoreHashChange=false;var route=function(e){var t;return div.all([child(div.all([componentName("route"),function(n,i){windowHash.onValue(function(r){if(ignoreHashChange){ignoreHashChange=false;return}if(t){t.destroy()}Q.all([e(r)]).then(function(e){var r=e[0];t=r.create(i);t.$el.css("transition","inherit");t.minWidth.pushAll(n.minWidth);t.minHeight.pushAll(n.minHeight)},function(e){console.error("child components failed to load");console.log(e)})})}])),wireChildren(passThroughToFirst)])};(function(){var e=[console.error,function(){debugger}];var t={handleWith:function(e){return function(t){return function(n,i){if(n!==null&&typeof n!=="undefined"){return e(n)}else{return t(i,function(t){return e(null,t)})}}}},reportError:function(t){e.map(function(e){e(t)})},handle:function(e){return t.handleWith(t.reportError)(e)},addLogger:function(t){e.push(t)}};if(typeof exports==="undefined"){window.Err=t}else{module.exports=t}})();(function(){var e=function(e){return{name:"file",accept:e||"*"}};var t={id:{name:"id"},string:{name:"string"},paragraph:{name:"paragraph"},html:{name:"html"},password:{name:"password"},number:{name:"number"},date:{name:"date"},bool:{name:"bool"},foreignKey:function(e,t){return{name:"foreignKey",table:e,nameField:t}},enumeration:function(e){return{name:"enumeration",options:e}},oneOf:function(e){return{name:"oneOf",options:e}},file:e,image:e("image/*"),listOf:function(e){return{name:"listOf",editorType:e}}};if(typeof exports==="undefined"){window.editorType=t}else{module.exports=t}})();(function(){var e=function(e,t){return{string:{title:"String",fromString:function(e){return t?t(e):e}},id:{title:"Object ID",fromString:function(t){return new e(t)}},json:{title:"JSON object",fromString:function(e){return e}},number:{title:"Number",fromString:function(e){return e}},date:{title:"Date",fromString:function(e){return e&&new Date(e)}},bool:{title:"Boolean",fromString:function(e){return e}}}};if(typeof exports==="undefined"){window.type=e(ObjectId)}else{var t=require("mongodb").ObjectID;var n=require("sanitize-html");module.exports=e(t,n)}})();(function(){var e=function(e,t,n,i){var r=function(e,t,n,i){return i(true)};var o=function(e,t,n,i){return i(false)};var a=function(e,t,n,i){if(!e){return i(false)}return n.admin.findOne({user:e._id},function(e){return i(e)})};var s=function(e){return function(t,n,r,o){if(!t){return o(false)}if(!n){return o(false)}return o(i.equal(t._id,n[e]))}};var l=function(e,t,n,i){return i(e)};var u=function(e){if(typeof exports!=="undefined"){var t=require("async");return function(n,i,r,o){return t.map(e,function(e,t){return e(n,i,r,function(e){return t(null,e)})},function(e,t){return o(t.reduce(function(e,t){return e||t},false))})}}};var c=function(e,t,n){return function(i,r,o,a){return o[e].findOne({_id:r[t]},function(e){return n(i,e,o,a)})}};var d=[{name:"upload",fields:[{name:"_id",type:n.id},{name:"creator",type:n.id}],mayFind:r,mayInsert:s("creator"),mayUpdate:s("creator"),mayRemove:o},{name:"profile",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"firstName",type:n.string,editorType:e.string,displayName:"First Name"},{name:"lastName",type:n.string,editorType:e.string,displayName:"Last Name"},{name:"email",type:n.string,editorType:e.string,displayName:"Email"},{name:"birthday",type:n.date,editorType:e.date,displayName:"Birthday"},{name:"bio",type:n.string,editorType:e.html,displayName:"Bio"},{name:"imageUrl",type:n.string,editorType:e.image,displayName:"Profile Picture"},{name:"holibirther",type:n.bool,editorType:e.bool,displayName:"I am a Holibirther"},{name:"knowAHolibirther",type:n.bool,editorType:e.bool,displayName:"I know a Holibirther"},{name:"receiveMarketingEmails",type:n.bool,editorType:e.bool,displayName:"I wish to receive emails from Holibirthday"},{name:"unsubscribeToken",type:n.string}],mayFind:r,mayInsert:o,mayUpdate:u([s("user"),a]),mayRemove:o},{name:"user",fields:[{name:"_id",type:n.id},{name:"email",type:n.id},{name:"emailConfirmationToken",type:n.string},{name:"passwordResetToken",type:n.string},{name:"passwordResetDate",type:n.date},{name:"passwordEncrypted",type:n.string},{name:"facebookId",type:n.string}],mayFind:o,mayInsert:o,mayUpdate:o,mayRemove:o},{name:"userEmailConfirmed",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"email",type:n.string}],mayFind:o,mayInsert:o,mayUpdate:o,mayRemove:o},{name:"admin",fields:[{name:"_id",type:n.id},{name:"user",type:n.id}],mayFind:s("user"),mayInsert:o,mayUpdate:o,mayRemove:o},{name:"holibirthday",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"month",type:n.number,editorType:e.number,displayName:"Holibirth-month"},{name:"day",type:n.number,editorType:e.number,displayName:"Holibirth-day"},{name:"date",type:n.date,editorType:e.date,displayName:"Holibirthdate"},{name:"createDate",type:n.date},{name:"imageUrl",type:n.string}],mayFind:r,mayInsert:s("user"),mayUpdate:s("user"),mayRemove:s("user")},{name:"pointsChange",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"amount",type:n.number},{name:"reason",type:n.string},{name:"createDate",type:n.date}],mayFind:r,mayInsert:o,mayUpdate:o,mayRemove:o},{name:"pointsTotal",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"amount",type:n.number},{name:"createDate",type:n.date}],mayFind:r,mayInsert:o,mayUpdate:o,mayRemove:o},{name:"storyLike",fields:[{name:"_id",type:n.id},{name:"user",type:n.user},{name:"story",type:n.story}],mayFind:r,mayInsert:s("user"),mayUpdate:o,mayRemove:o},{name:"story",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"name",type:n.string},{name:"text",type:n.string},{name:"storyType",type:n.string},{name:"imageUrl",type:n.string},{name:"imageWidth",type:n.number},{name:"isPublic",type:n.bool},{name:"createDate",type:n.date},{name:"updateDate",type:n.date}],storyType:{best:"best",worst:"worst",forgotmenot:"forgotmenot",blog:"blog"},mayFind:r,mayInsert:function(e,t,n,i){if(t.storyType==="blog"){if(!e){return i(false)}return n.admin.findOne({user:e._id},function(e){return i(e)})}return i(e)},mayUpdate:u([a,s("user")]),mayRemove:u([a,s("user")])},{name:"comment",fields:[{name:"_id",type:n.id},{name:"story",type:n.id},{name:"user",type:n.id},{name:"text",type:n.string},{name:"createDate",type:n.string},{name:"updateDate",type:n.string}],mayFind:r,mayInsert:s("user"),mayUpdate:s("user"),mayRemove:u([a,s("user")])},{name:"storyTag",fields:[{name:"_id",type:n.id},{name:"story",type:n.id},{name:"tag",type:n.string}],mayFind:r,mayInsert:u([c("story","story",s("user")),a]),mayUpdate:u([c("story","story",s("user")),a]),mayRemove:u([c("story","story",s("user")),a])},{name:"uniqueTag",fields:[{name:"_id",type:n.id},{name:"tag",type:n.string},{name:"count",type:n.number}],mayFind:r,mayInsert:o,mayUpdate:o,mayRemove:o},{name:"dailyTheme",fields:[{name:"_id",type:n.id},{name:"createDate",type:n.date},{name:"updateDate",type:n.date},{name:"type",type:n.string,options:{featuredStory:"featuredStory",poll:"poll",someText:"someText"},displayName:"Type",editorType:e.enumeration([{name:"Featured Story",value:"featuredStory"},{name:"Poll",value:"poll"},{name:"Rich Text",value:"someText"}])},{name:"storyId",type:n.id,displayName:"Story",editorType:e.foreignKey("story","name")},{name:"storyText",type:n.string,displayName:"Description",editorType:e.html},{name:"giftId",type:n.number,displayName:"Gift",editorType:{name:"gift"}},{name:"giftText",type:n.string,displayName:"Description",editorType:e.html},{name:"pollTitle",type:n.string,displayName:"Title",editorType:e.string},{name:"pollDescription",type:n.string,displayName:"Description",editorType:e.html},{name:"pollChoices",type:n.json,displayName:"Choices",editorType:e.listOf(e.string)},{name:"pollImage",type:n.string,displayName:"Picture",editorType:e.image},{name:"someTextTitle",type:n.string,displayName:"Title",editorType:e.string},{name:"someTextText",type:n.string,displayName:"Text",editorType:e.html},{name:"someTextImage",type:n.string,displayName:"Picture",editorType:e.image}],mayFind:r,mayInsert:a,mayUpdate:a,mayRemove:a},{name:"dailyThemePollResponse",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"dailyTheme",type:n.id},{name:"choice",type:n.number},{name:"createDate",type:n.date}],mayFind:r,mayInsert:l,mayUpdate:o,mayRemove:o},{name:"gafyStyle",fields:[{name:"_id",type:n.id},{name:"styleNumber",type:n.string,editorType:e.string,displayName:"Style Number"},{name:"styleDescription",type:n.string,editorType:e.string,displayName:"Style Description"},{name:"imageUrl",type:n.string,displayName:"Style Picture",editorType:e.image},{name:"sizesImageUrl",type:n.string,displayName:"Sizes Chart Picture",editorType:e.image},{name:"sizes",type:n.json,editorType:e.listOf(e.string),displayName:"Sizes"},{name:"colors",type:n.json,editorType:{name:"gafyColor"},displayName:"Colors"},{name:"price",type:n.json,editorType:e.number,displayName:"Price"}],mayFind:r,mayInsert:a,mayUpdate:a,mayRemove:a},{name:"gafyDesign",fields:[{name:"_id",type:n.id},{name:"designNumber",type:n.string,displayName:"Design Number",editorType:e.string},{name:"designDescription",type:n.string,displayName:"Design Description",editorType:e.string},{name:"printLocation",type:n.string,displayName:"Print Location",editorType:e.string},{name:"imageUrl",type:n.string,displayName:"Design Image",editorType:e.image},{name:"styles",type:n.json,displayName:"Styles",editorType:{name:"gafyStyle"}},{name:"colors",type:n.json,displayName:"Colors",editorType:{name:"gafyColor"}},{name:"month",type:n.string,displayName:"Month / Timeless",editorType:e.oneOf(["Timeless","January","February","March","April","May","June","July","August","September","October","November","December"])}],mayFind:r,mayInsert:a,mayUpdate:a,mayRemove:a},{name:"contactUsMessage",fields:[{name:"_id",type:n.id},{name:"name",type:n.string},{name:"email",type:n.string},{name:"message",type:n.string}],mayFind:o,mayInsert:r,mayUpdate:o,mayRemove:o},{name:"siteCopyItem",fields:[{name:"_id",type:n.id},{name:"uniqueName",type:n.string},{name:"value",type:n.string}],mayFind:r,mayInsert:a,mayUpdate:a,mayRemove:a,options:[{name:"Home Tagline",multiline:false},{name:"Home Share Your Story",multiline:false},{name:"Home Claim Your Holibirthday",multiline:false},{name:"Home Find Friends",multiline:false},{name:"Edit Story Title",multiline:false},{name:"Edit Story Smaller Title",
multiline:false},{name:"Edit Story Instructions",multiline:true},{name:"Edit Story Submit Instructions",multiline:true},{name:"Order Confirmation Email: From",multiline:false},{name:"Order Confirmation Email: From Name",multiline:false},{name:"Order Confirmation Email: Subject",multiline:false},{name:"Order Confirmation Email: Text ( {{orderNumber}} includes order number)",multiline:true},{name:"Header Gifts",multiline:true},{name:"Header Cart",multiline:true},{name:"Header Wishlist",multiline:true},{name:"Header My Profile",multiline:true},{name:"Header Sign In",multiline:true},{name:"Header Sign Out",multiline:true},{name:"Header Register",multiline:true},{name:"Header Admin",multiline:true}]},{name:"gafyOrder",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"orderBatch",type:n.string},{name:"customerEmailAddress",type:n.string},{name:"firstName",type:n.string},{name:"lastName",type:n.string},{name:"addressLine1",type:n.string},{name:"addressLine2",type:n.string},{name:"addressCity",type:n.string},{name:"addressState",type:n.string},{name:"addressZip",type:n.string},{name:"addressCountry",type:n.string},{name:"designNumber",type:n.string},{name:"designDescription",type:n.string},{name:"printLocation",type:n.string},{name:"styleNumber",type:n.string},{name:"styleDescription",type:n.string},{name:"color",type:n.string},{name:"size",type:n.string},{name:"quantity",type:n.number},{name:"shippingMethod",type:n.string}],mayFind:o,mayInsert:r,mayUpdate:o,mayRemove:o},{name:"stripePayment",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"email",type:n.string},{name:"orderBatch",type:n.string},{name:"amount",type:n.number},{name:"stripeToken",type:n.string}],mayFind:o,mayInsert:r,mayUpdate:o,mayRemove:o},{name:"stripeDonation",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"email",type:n.string},{name:"amount",type:n.number},{name:"stripeToken",type:n.string}],mayFind:o,mayInsert:r,mayUpdate:o,mayRemove:o},{name:"gafyWishlist",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"items",type:n.json}],mayFind:r,mayInsert:s("user"),mayUpdate:s("user"),mayRemove:s("user")},{name:"sendEmail",fields:[{name:"_id",type:n.id},{name:"constraintSource",type:n.string},{name:"monthGT",type:n.number},{name:"dayGT",type:n.number},{name:"monthLT",type:n.number},{name:"dayLT",type:n.number},{name:"from",type:n.string},{name:"fromName",type:n.string},{name:"subject",type:n.string},{name:"text",type:n.string}],mayFind:o,mayInsert:a,mayUpdate:o,mayRemove:o},{name:"famousBirthday",fields:[{name:"_id",type:n.id},{name:"name",type:n.string,displayName:"Name",editorType:e.string},{name:"birthday",type:n.date,displayName:"Birthday (year is ignored)",editorType:e.date},{name:"description",type:n.string,displayName:"Description",editorType:e.paragraph},{name:"imageUrl",type:n.string,displayName:"Image",editorType:e.image}],mayFind:r,mayInsert:a,mayUpdate:a,mayRemove:a},{name:"contactOtherUser",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"otherUser",type:n.id}],mayFind:s("user"),mayInsert:s("user"),mayUpdate:s("user"),mayRemove:s("user")},{name:"contactCustom",fields:[{name:"_id",type:n.id},{name:"user",type:n.id},{name:"name",type:n.string,displayName:"Name",editorType:e.string},{name:"birthday",type:n.date,displayName:"Birthday",editorType:e.date},{name:"email",type:n.string,displayName:"Email",editorType:e.string}],mayFind:s("user"),mayInsert:s("user"),mayUpdate:s("user"),mayRemove:s("user")},{name:"mailchimpTemplate",fields:[{name:"_id",type:n.id},{name:"mailchimpTemplateId",type:n.string},{name:"event",type:n.string,options:{holibirthdayInThreeWeeks:"holibirthdayInThreeWeeks",friendsHolibirthdayInThreeWeeks:"friendsHolibirthdayInThreeWeeks",holibirthdayTomorrow:"holibirthdayTomorrow",friendsHolibirthdayTomorrow:"friendsHolibirthdayTomorrow",storyDeleted:"storyDeleted",commentDeleted:"commentDeleted"}},{name:"toName",type:n.string},{name:"fromName",type:n.string},{name:"subject",type:n.string}],mayFind:a,mayInsert:a,mayUpdate:a,mayRemove:a},{name:"mailchimpList",fields:[{name:"_id",type:n.id},{name:"mailchimpListType",type:n.string,options:{holibirthers:"holibirthers",friendsOfHolibirthers:"friendsOfHolibirthers"}},{name:"mailchimpListId",type:n.string}],mayFind:a,mayInsert:a,mayUpdate:a,mayRemove:a}];d.map(function(e){d[e.name]=e;e.fields.map(function(t){e.fields[t.name]=t})});if(typeof exports!=="undefined"){var f=require("async");var h=function(){var e=[];return{use:function(t){e.push(t)},invoke:function(){var t=Array.prototype.slice.call(arguments);var n=t.length-1;var i=t.splice(n,1)[0];f.map(e,function(e,n){thisArgs=t.slice();thisArgs.push(n);e.apply(null,thisArgs)},i)}}};d.map(function(e){e.findMiddleware=h();e.insertMiddleware=h();e.updateMiddleware=h();e.removeMiddleware=h();e.postFindMiddleware=h();e.postInsertMiddleware=h();e.postUpdateMiddleware=h();e.postRemoveMiddleware=h()})}return d};if(typeof exports==="undefined"){ObjectId.equal=function(e,t){return e&&t&&e.toString()===t.toString()};window.schema=e(window.editorType,window.Err,window.type,ObjectId)}else{var t=require("mongodb").ObjectID;t.equal=function(e,t){return e&&t&&e.toString()===t.toString()};var n=require("./editorType");var i=require("./Err");var r=require("./type");module.exports=e(n,i,r,t)}})();$(function(){waitForWebfonts(["BebasNeue","CelebrationTime","FontAwesome","Open Sans","Raleway Thin"],function(){var e=setInterval(function(){if(document.readyState==="complete"){clearInterval(e);window.app()}},100)})});define("myHolibirthdayView",["bar","bodyColumn","chooseNonHoliday","colors","confettiBackground","db","famousBirthdaysDisplay","fonts","holibirthdayRow","meP","months","prettyForms","profileP","separatorSize","signInForm","signInStream","submitButton","writeOnImage"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p,g,y){var v=function(e){return div.all([children(e.options.map(function(e){return padding({top:30,bottom:30,left:20,right:20},alignLRM({middle:text(e+"").all([s.bebasNeue,$css("font-size",40)])})).all([withBackgroundColor(white),function(e){e.$el.css("position","relative");e.$el.css("visibility","")}])})),wireChildren(function(t,n,i){n.height.promise.then(function(){var n=t.$el.slotMachine();var i=100;var r=2e3;var o=Math.random();var a=r+Math.random()*i;e.stream.onValue(function(e){n.setRandomize(function(){return e.index});setTimeout(function(){n.shuffle()},o);setTimeout(function(){n.stop()},a)})});var r=function(e){return Stream.combine(e,function(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){return Math.max(e,t)},0)})};r(i.map(function(e){return e.minHeight})).pushAll(t.minHeight);r(i.map(function(e){return e.minWidth})).pushAll(t.minWidth);return[i.map(function(){return{width:n.width,height:n.height}})]})])};var b=function(e){var t=e.filter(function(e,t){if(e){t(e)}});var r=false;var o;var a=150;var l=overlays([alignLRM({middle:nothing.all([withMinWidth(2,true),withMinHeight(a,true),withBackgroundColor(black)])}),alignTBM({top:border(black,{all:2},padding(5,text("Pull").all([s.bebasNeue,$css("font-size",20)]))).all([$css("cursor","move"),withBackgroundColor(i.holibirthdayRed),withFontColor(white),mousedownThis(function(e){r=true;o=e.clientY;return false}),function(t){$("body").on("mouseup",function(){if(r){r=false;t.$el.animate({"margin-top":0})}});$("body").on("mousemove",function(i){if(r){var s=Math.max(0,i.clientY-o);var l=a-parseInt(t.$el.css("height"));t.$el.css("margin-top",s);if(s>l){t.$el.css("margin-top",l);t.$el.animate({"margin-top":0});r=false;e.push(n())}}})}])})]);return stack({gutterSize:h},[sideBySide({gutterSize:h},[alignTBM({middle:border(black,{all:1},sideBySide({},[v({options:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],stream:t.map(function(e){return{index:e&&e.getUTCMonth()}})}),v({options:[0,1,2,3],stream:t.map(function(e){return{index:e&&Math.floor(e.getUTCDate()/10)}})}),v({options:[0,1,2,3,4,5,6,7,8,9],stream:t.map(function(e){return{index:e&&e.getUTCDate()%10}})})]))}),l]).all([$css("user-select","none")])])};return promiseComponent(o.famousBirthday.find({}).then(function(e){var n=function(t){if(!t){return[]}return e.filter(function(e){return e.birthday.getUTCMonth()===t.getUTCMonth()&&e.birthday.getUTCDate()===t.getUTCDate()})};return u.then(function(e){if(e){return f.then(function(i){var u={user:Stream.once(e._id),date:Stream.once(null)};var c;Stream.combineObject(u).onValue(function(e){c=e});var d=Stream.once(false);u.date.map(function(){return false}).pushAll(d);var f=function(t,n){return stack({gutterSize:h},[alignLRM({middle:b(u.date)}),alignLRM({middle:toggleHeight(d)(stack({},[text("You must pull the lever first").all([s.ralewayThinBold,$css("font-size",30)])]))}),alignLRM({middle:g(black,text(i.holibirther&&n?"Change Holibirthday":"Claim Birthday").all([s.bebasNeue])).all([link,clickThis(function(){if(c){var t=document.createElement("canvas");var r=$(t);r.appendTo($("body")).prop("width",1080).prop("height",702);var a=t.getContext("2d");var s=function(e,t,n){a.font=n;var i=a.measureText(t).width;a.fillText(t,e.x-i/2,e.y)};var l=new Image;l.onload=function(){a.drawImage(l,0,0);s({x:540,y:310},i.firstName+" "+i.lastName,"bold 50px Raleway Thin");s({x:540,y:540},moment(c.date).utc().format("MMMM Do"),"bold 50px Raleway Thin");if(i.birthday){s({x:160,y:595},"Old Birthday","20px BebasNeue");s({x:160,y:615},moment(i.birthday).utc().format("MMMM Do"),"20px BebasNeue")}setTimeout(function(){var i=window.dataURLtoBlob(t.toDataURL());o.uploadFile(i,"certificate.png").then(function(t){c.imageUrl="/api/uploadFile/find/"+t;o.profile.update({user:e._id},{holibirther:true}).then(function(){if(n){o.holibirthday.update({user:e._id},c).then(function(){window.location.hash="#!user/"+e._id+"/certificate";window.location.reload()})}else{o.holibirthday.insert(c).then(function(){window.location.hash="#!user/"+e._id+"/certificate";window.location.reload()})}})});r.remove()})};l.src="./content/certificate-01.png"}else{d.push(true)}})])})])};return o.holibirthday.findOne({user:e._id}).then(function(o){if(i.holibirther&&o){var c=o.date;u.date.push(c);return stack({gutterSize:h},[linkTo("#!user/"+e._id+"/certificate",r(t(l(stack({gutterSize:h},[text("Your Holibirthday Is").all([s.ralewayThinBold,$css("font-size",40)]),text(moment(c).utc().format("MMMM Do")).all([s.ralewayThinBold,$css("font-size",20)])]))))),t(alignLRM({middle:f(u,true)})),componentStream(u.date.delay(2500).map(function(e){return a(n(e))}))])}else{return stack({gutterSize:h},[r(t(l(text("Claim Your Holibirthday").all([s.ralewayThinBold,$css("font-size",40)])))),t(alignLRM({middle:f(u)})),componentStream(u.date.delay(2500).map(function(e){return a(n(e))}))])}})})}return stack({gutterSize:h},[r(t(l(text("Claim Your Holibirthday").all([s.ralewayThinBold,$css("font-size",40)])))),t(paragraph("You must sign in to claim a holibirthday").all([s.h1,link,clickThis(function(e){p.push(true);e.stopPropagation()})]))])})}))});define("auth",["domain"],function(e){return{signIn:function(t){return $.ajax({type:"post",url:e+"/auth/login",data:JSON.stringify(t),contentType:"application/json"})},signOut:function(){return $.get("/auth/logout")},loginWithFacebook:function(t){return $.ajax({type:"post",url:e+"/auth/facebook",data:JSON.stringify({username:t.accessToken,password:t.accessToken}),contentType:"application/json"})},register:function(t){return $.ajax({type:"post",url:e+"/auth/register",data:JSON.stringify(t),contentType:"application/json"})},resendConfirmEmail:function(t){return $.ajax({type:"post",url:e+"/auth/resendConfirmEmail",data:JSON.stringify({email:t.email}),contentType:"application/json"})},resetPasswordRequest:function(t){return $.ajax({type:"post",url:e+"/auth/resetPasswordRequest",data:JSON.stringify({email:t.email}),contentType:"application/json"})},resetPassword:function(t){return $.ajax({type:"post",url:e+"/auth/resetPassword",data:JSON.stringify({passwordResetToken:t.token,password:t.password}),contentType:"application/json"})},setPassword:function(t){return $.ajax({type:"post",url:e+"/auth/setPassword",data:JSON.stringify({password:t.password}),contentType:"application/json"})},confirmEmail:function(t){return $.ajax({type:"post",url:e+"/auth/confirmEmail",data:JSON.stringify({emailConfirmationToken:t}),contentType:"application/json"})},grecaptchaSitekeyP:$.get(e+"/grecaptcha/sitekey"),grecaptchaP:function(){var e=Q.defer();var t=function(){if(typeof grecaptcha==="undefined"){setTimeout(t,100)}else{e.resolve(grecaptcha)}};t();return e.promise}(),StripeP:$.get(e+"/stripe/publishableKey").then(function(e){if(window.Stripe){window.Stripe.setPublishableKey(e);return window.Stripe}else{console.log("Stripe not loaded")}})}});define("forms",["ckeditorP"],function(e){return{inputBox:function(e,t,n,i,r){t=t||"text";return border(color({r:169,b:169,g:169}),{all:!r&&(t==="text"||t==="password"||t==="date"||t==="number")?1:0},input.all((i||[]).concat([$prop("name",n),$prop("type",t),withBackgroundColor(white),withFontColor(black),keyupThis(function(n){if(t==="text"){e.push($(n.target).val())}}),changeThis(function(n){var i=$(n.target);var r=i.val();if(t==="date"){e.push(moment(r).toDate())}else if(t==="checkbox"){e.push(i.prop("checked"))}else{e.push(r)}}),function(n){var i=n.$el;e.onValue(function(e){var n;if(t==="date"){if(e){n=moment(e).utc().format("YYYY-MM-DD")}}else if(t==="checkbox"){setTimeout(function(){i.prop("checked",e)});n=e}else{n=e}if(i.val()!==n){i.val(n)}})}])))},plainTextareaBox:function(e,t){return textarea.all([$prop("id",t),$prop("name",t),$prop("rows",10),keyupThis(function(t){e.push($(t.target).val())}),changeThis(function(t){e.push($(t.target).val())}),function(t){e.onValue(function(e){t.$el.val(e)})},withBackgroundColor(white)])},textareaBox:function(t,n){return promiseComponent(e().then(function(e){return div.all([child(textarea.all([$prop("id",n),$prop("name",n),$prop("rows",21),keyupThis(function(e){t.push($(e.target).val())}),changeThis(function(e){t.push($(e.target).val())}),function(n,i){var r=false;var o=t.promise.then(function(o){n.$el.val(o);e.config.resize_enabled=false;var a=CKEDITOR.replace(n.$el[0]);a.on("instanceReady",function(){a.on("change",function(){t.push(a.getData())});Stream.combine([i.width,i.height],function(e,t){if(!r){a.resize(px(e),px(t),true,true)}})});return a});return function(){r=true;o.then(function(e){if(!r){try{e.destroy()}catch(t){console.log("ckeditor exception happened")}}})}}])),wireChildren(function(e,t,n){n.minHeight.pushAll(e.minHeight);n.minWidth.pushAll(e.minWidth);return[{width:t.width,height:t.height}]})])}))},selectBox:function(e){return border(color({r:169,b:169,g:169}),{all:1},select.all([children(e.options.map(function(e){if(!e.name||!e.value){e={name:e,value:e}}return option.all([$html(e.name),$prop("value",e.value),$css("visibility","")])})),$prop("name",e.name),withBackgroundColor(white),withFontColor(black),changeThis(function(t){e.stream.push($(t.target).val())}),function(t){var n=t.$el;e.stream.onValue(function(e){setTimeout(function(){n.val(e)})})}]))}}});define("privacyPolicyView",["bodyColumn","confettiBackground","fonts","holibirthdayRow","separatorSize"],function(e,t,n,i,r){return stack({gutterSize:r},[t(i(text("Privacy Policy").all([n.h1]))),e(paragraph(["<style>","#ppBody","{","font-size:11pt;","width:100%;","margin:0 auto;","text-align:justify;","}","","#ppHeader","{","font-family:verdana;","font-size:21pt;","width:100%;","margin:0 auto;","}","",".ppConsistencies","{","display:none;","}",'</style><div id="ppBody"><div class="ppConsistencies"><div class="col-2">','<div class="quick-links text-center">Information Collection</div>','</div><div class="col-2">','<div class="quick-links text-center">Information Usage</div>','</div><div class="col-2">','<div class="quick-links text-center">Information Protection</div>','</div><div class="col-2"></div><div class="col-2">','<div class="quick-links text-center">3rd Party Disclosure</div>','</div><div class="col-2">','<div class="quick-links text-center">3rd Party Links</div>','</div><div class="col-2"></div></div><div style="clear:both;height:10px;"></div><div class="ppConsistencies"><div class="col-2">','<div class="col-12 quick-links2 gen-text-center">Google AdSense</div>','</div><div class="col-2">','<div class="col-12 quick-links2 gen-text-center">',"Fair Information Practices",'<div class="col-8 gen-text-left gen-xs-text-center" style="font-size:12px;position:relative;left:20px;">Fair information<br> Practices</div>',"</div>",'</div><div class="col-2">','<div class="col-12 quick-links2 gen-text-center coppa-pad">',"COPPA","","</div>",'</div><div class="col-2">','<div class="col-12 quick-links2 quick4 gen-text-center caloppa-pad">',"CalOPPA","","</div>",'</div><div class="col-2">','<div class="quick-links2 gen-text-center">Our Contact Information<br></div>','</div></div><div style="clear:both;height:10px;"></div>','<div class="innerText">This privacy policy has been compiled to better serve those who are concerned with how their "Personally identifiable information" (PII) is being used online. PII, as used in US privacy law and information security, is information that can be used on its own or with other information to identify, contact, or locate a single person, or to identify an individual in context. Please read our privacy policy carefully to get a clear understanding of how we collect, use, protect or otherwise handle your Personally Identifiable Information in accordance with our website.<br></div><span id="infoCo"></span><br><div class="grayText"><strong>What personal information do we collect from the people that visit our blog, website or app?</strong></div><br /><div class="innerText">When ordering or registering on our site, as appropriate, you may be asked to enter your name, email address, birth date or other details to help you with your experience.</div><br><div class="grayText"><strong>When do we collect information?</strong></div><br /><div class="innerText">We collect information from you when you register on our site  or enter information on our site.</div><br><span id="infoUs"></span><br><div class="grayText"><strong>How do we use your information? </strong></div><br /><div class="innerText"> We may use the information we collect from you when you register, make a purchase, sign up for our newsletter, respond to a survey or marketing communication, surf the website, or use certain other site features in the following ways:<br><br></div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To personalize user"s experience and to allow us to deliver the type of content and product offerings in which you are most interested.</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To improve our website in order to better serve you.</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To allow us to better service you in responding to your customer service requests.</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To administer a contest, promotion, survey or other site feature.</div><span id="infoPro"></span><br><div class="grayText"><strong>How do we protect visitor information?</strong></div><br /><div class="innerText">We do not use vulnerability scanning and/or scanning to PCI standards.</div><div class="innerText">We do not use Malware Scanning.<br><br></div><div class="innerText">Your personal information is contained behind secured networks and is only accessible by a limited number of persons who have special access rights to such systems, and are required to keep the information confidential. In addition, all sensitive/credit information you supply is encrypted via Secure Socket Layer (SSL) technology. </div><br><div class="innerText">We implement a variety of security measures when a user enters, submits, or accesses their information to maintain the safety of your personal information.</div><br><div class="innerText">All transactions are processed through a gateway provider and are not stored or processed on our servers.</div><span id="trDi"></span><br><div class="grayText"><strong>Third Party Disclosure</strong></div><br /><div class="innerText">We do not sell, trade, or otherwise transfer to outside parties your personally identifiable information unless we provide you with advance notice. This does not include website hosting partners and other parties who assist us in operating our website, conducting our business, or servicing you, so long as those parties agree to keep this information confidential. We may also release your information when we believe release is appropriate to comply with the law, enforce our site policies, or protect ours or others" rights, property, or safety. <br><br> However, non-personally identifiable visitor information may be provided to other parties for marketing, advertising, or other uses. </div><span id="trLi"></span><br><div class="grayText"><strong>Third party links</strong></div><br /><div class="innerText">Occasionally, at our discretion, we may include or offer third party products or services on our website. These third party sites have separate and independent privacy policies. We therefore have no responsibility or liability for the content and activities of these linked sites. Nonetheless, we seek to protect the integrity of our site and welcome any feedback about these sites.</div><span id="gooAd"></span><br><div class="blueText"><strong>Google</strong></div><br /><div class="innerText">Google"s advertising requirements can be summed up by Google"s Advertising Principles. They are put in place to provide a positive experience for users. https://support.google.com/adwordspolicy/answer/1316548?hl=en <br><br></div><div class="innerText">We have not enabled Google AdSense on our site but we may do so in the future.</div><span id="calOppa"></span><br><div class="blueText"><strong>California Online Privacy Protection Act</strong></div><br /><div class="innerText">CalOPPA is the first state law in the nation to require commercial websites and online services to post a privacy policy.  The law"s reach stretches well beyond California to require a person or company in the United States (and conceivably the world) that operates websites collecting personally identifiable information from California consumers to post a conspicuous privacy policy on its website stating exactly the information being collected and those individuals with whom it is being shared, and to comply with this policy. -  See more at: http://consumercal.org/california-online-privacy-protection-act-caloppa/#sthash.0FdRbT51.dpuf<br></div><div class="innerText"><br><strong>According to CalOPPA we agree to the following:</strong></div><div class="innerText">Users can visit our site anonymously</div><div class="innerText">Once this privacy policy is created, we will add a link to it on our home page, or as a minimum on the first significant page after entering our website.</div><div class="innerText">Our Privacy Policy link includes the word "Privacy", and can be easily be found on the page specified above.</div><div class="innerText"><br>Users will be notified of any privacy policy changes:</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> On our Privacy Policy Page</div><div class="innerText">Users are able to change their personal information:</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> By logging in to their account</div><div class="innerText"><br><strong>How does our site handle do not track signals?</strong></div><div class="innerText">We honor do not track signals and do not track, plant cookies, or use advertising when a Do Not Track (DNT) browser mechanism is in place. </div><div class="innerText"><br><strong>Does our site allow third party behavioral tracking?</strong></div><div class="innerText">It"s also important to note that we do not allow third party behavioral tracking</div><span id="coppAct"></span><br><div class="blueText"><strong>COPPA (Children Online Privacy Protection Act)</strong></div><br /><div class="innerText">When it comes to the collection of personal information from children under 13, the Children"s Online Privacy Protection Act (COPPA) puts parents in control.  The Federal Trade Commission, the nation"s consumer protection agency, enforces the COPPA Rule, which spells out what operators of websites and online services must do to protect children"s privacy and safety online.<br><br></div><div class="innerText">We do not specifically market to children under 13.</div><span id="ftcFip"></span><br><div class="blueText"><strong>Fair Information Practices</strong></div><br /><div class="innerText">The Fair Information Practices Principles form the backbone of privacy law in the United States and the concepts they include have played a significant role in the development of data protection laws around the globe. Understanding the Fair Information Practice Principles and how they should be implemented is critical to comply with the various privacy laws that protect personal information.<br><br></div><div class="innerText"><strong>In order to be in line with Fair Information Practices we will take the following responsive action, should a data breach occur:</strong></div><div class="innerText">We will notify the users via email</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Within 7 business days</div><div class="innerText">We will notify the users via in site notification</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Within 7 business days</div><div class="innerText"><br>We also agree to the individual redress principle, which requires that individuals have a right to pursue legally enforceable rights against data collectors and processors who fail to adhere to the law. This principle requires not only that individuals have enforceable rights against data users, but also that individuals have recourse to courts or a government agency to investigate and/or prosecute non-compliance by data processors.</div><span id="canSpam"></span><br><div class="blueText"><strong>CAN SPAM Act</strong></div><br /><div class="innerText">The CAN-SPAM Act is a law that sets the rules for commercial email, establishes requirements for commercial messages, gives recipients the right to have emails stopped from being sent to them, and spells out tough penalties for violations.<br><br></div><div class="innerText"><strong>We collect your email address in order to:</strong></div><div class="innerText"><br><strong>To be in accordance with CANSPAM we agree to the following:</strong></div><div class="innerText"><strong><br>If at any time you would like to unsubscribe from receiving future emails, you can email us at</strong></div> and we will promptly remove you from <strong>ALL</strong> correspondence.</div><br><div class="innerText">If there are any questions regarding this privacy policy you may contact us using the information below.<br><br></div><div class="innerText"><br>Last Edited on 2015-06-09</div></div>'].join("\n")))])});define("loginWithFacebook",["auth","fonts","separatorSize","socialMedia","submitButton"],function(e,t,n,i,r){var o=Q.defer();FB.getLoginStatus(function(e){if(e.status==="unknown"||e.status==="not_authorized"||e.status==="connected"){o.resolve(false)}o.resolve(e.authResponse)},true);return function(){return promiseComponent(o.promise.then(function(o){return button.all([child(r(i.facebook.color,sideBySide({gutterSize:n},[text(i.facebook.icon).all([$css("font-size","20px")]),text("sign in with Facebook").all([t.bebasNeue])])).all([withFontColor(i.facebook.color)])),wireChildren(passThroughToFirst)]).all([link,clickThis(function(t){t.stopPropagation();t.preventDefault();if(o){e.loginWithFacebook(o).then(function(){window.location.reload()})}else{FB.login(function(t){e.loginWithFacebook(t.authResponse).then(function(){window.location.reload()})},{scope:"email, public_profile, user_friends, user_birthday"})}})])}))}});define("resetPasswordView",["auth","bar","bodyColumn","fonts","prettyForms","separatorSize"],function(e,t,n,i,r,o){return function(t){var a=Stream.once("");var s=Stream.once("");var l=Stream.once(false);a.map(function(){l.push(false)});s.map(function(e){l.push(a.lastValue()!==e)});var u=r.input({name:"Password",fieldName:"password",stream:a,type:"password"});var c=r.input({name:"Password Again",fieldName:"confirmPassword",stream:s,type:"password"});var d=r.submit(black,"Submit",function(){if(!l.lastValue()){e.resetPassword({password:a.lastValue(),token:t}).then(function(){f.push(text("Reset!  You may now log in.").all([i.h1]))},function(){f.push(text("Invalid token.").all([i.h1]))})}});var f=Stream.once(alignLRM({left:stack({gutterSize:o},[text("Reset Password").all([i.h1]),u,c,toggleHeight(l)(paragraph("Passwords must match")),d])}));return n(componentStream(f))}});define("profileEditViewP",["auth","bodyColumn","confettiBackground","daysByMonth","db","defaultFormFor","fonts","holibirthdayRow","meP","months","prettyForms","profilesP","separatorSize","siteCopyItemsP","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m){return function(o){var p=function(t){var n=Stream.once("");var i=Stream.once("");var r=Stream.once(false);n.map(function(){r.push(false)});i.map(function(e){r.push(n.lastValue()!==e)});return t(function(e){var t=c.input({name:e.find("Edit Profile New Password"),fieldName:"password",stream:n,type:"password"});var o=c.input({name:e.find("Edit Profile Confirm New Password"),fieldName:"confirmPassword",stream:i,type:"password"});return stack({gutterSize:f},[nothing,text(e.find("Edit Profile Change Your Password")).all([a.bebasNeue]),t,o,toggleHeight(r)(paragraph("Passwords must match"))])},function(){var t=Q.defer();var i=n.lastValue();if(r.lastValue()){t.reject()}else if(i.length>0){e.setPassword({password:n.lastValue()}).then(function(){t.resolve()})}else{t.resolve()}return t.promise})};return p(function(e,p){return d.then(function(d){return r.holibirthday.findOne({user:o}).then(function(g){return h.then(function(h){return l.then(function(l){var y=d.filter(function(e){return e.user===o})[0];y.firstName=y.firstName||"";y.lastName=y.lastName||"";y.email=y.email||"";y.birthday=y.birthday||null;y.bio=y.bio||"";y.imageUrl=y.imageUrl||"./content/man.png";y.holibirther=y.holibirther||false;y.knowAHolibirther=y.knowAHolibirther||false;y.receiveMarketingEmails=y.receiveMarketingEmails||false;g=g||{user:o,month:0,day:1};g.month=u[g.month];var v=Stream.splitObject(g);var b=Stream.combineObject(v);var w=Stream.splitObject(y);var S=Stream.combineObject(w);return stack({gutterSize:f},[n(t(s(text(h.find("Edit Profile Title")).all([a.h1]),y.imageUrl))),t(stack({gutterSize:f},[c.input({name:h.find("Edit Profile First Name"),stream:w.firstName}),c.input({name:h.find("Edit Profile Last Name"),stream:w.lastName}),c.input({name:h.find("Edit Profile Email"),stream:w.email}),c.input({name:h.find("Edit Profile Receive Marketing Emails"),stream:w.receiveMarketingEmails,type:"checkbox"}),c.input({name:h.find("Edit Profile Birthday"),stream:w.birthday,type:"date"}),c.textarea({name:h.find("Edit Profile Bio"),stream:w.bio}),c.imageUpload({name:h.find("Edit Profile Image URL"),stream:w.imageUrl}),stack({},[c.input({name:h.find("Edit Profile Holibirther"),stream:w.holibirther,type:"checkbox"}),componentStream(w.holibirther.map(function(e){return e?stack({gutterSize:f},[nothing,c.select({name:h.find("Edit Profile Holibirthday Month"),options:u,stream:v.month}),componentStream(v.month.map(function(e){var t=i[e];var n=[];for(var r=0;r<t;r++){n.push(r+1)}return c.select({name:h.find("Edit Profile Holibirthday Month"),options:n,stream:v.day})}))]):nothing}))]),c.input({name:h.find("Edit Profile Know a Holibirther"),stream:w.knowAHolibirther,type:"checkbox"}),l._id===o&&!l.facebookId?e(h):nothing,alignLRM({
middle:m(black,text("Submit").all([a.bebasNeue])).all([link,clickThis(function(){var e=S.lastValue();return p().then(function(){return r.profile.update({_id:e._id},e).then(function(){if(e.holibirther){var t=b.lastValue();t.date=new Date(t.month+" "+t.day+" 2000");if(t._id){return r.holibirthday.update({_id:t._id},{date:t.date}).then(function(){window.location.hash="#!user/"+e.user;window.location.reload()})}else{return r.holibirthday.insert(t).then(function(){window.location.hash="#!user/"+e.user;window.location.reload()})}}else{window.location.hash="#!user/"+e.user;window.location.reload()}})})})])})]))])})})})})})}});define("footer",["colors","fonts","separatorSize"],function(e,t,n){var i=[{name:"Contact Holibirthday",link:"#!contactUs"},{name:"Privacy Policy",link:"#!privacyPolicy"}].map(function(e){return linkTo(e.link,text(e.name).all([t.ralewayThinBold]))});return alignLRM({middle:sideBySide({gutterSize:n},i)}).all([withBackgroundColor(e.pageBackgroundColor)])});define("profilesP",["db"],function(e){return e.profile.find()});define("signInForm",["auth","bodyColumn","colors","fonts","loginWithFacebook","prettyForms","separatorSize"],function(e,t,n,i,r,o,a){return function(){var s=Stream.once(false);var l=toggleHeight(s)(text("Please fill out all fields"));var u=Stream.once(false);var c=toggleHeight(u)(text("Email not confirmed (click to resend)").all([link,clickThis(function(t,n){n();e.resendConfirmEmail({email:y.username.lastValue()}).then(function(){u.push(false);d.push(true)})})]));var d=Stream.once(false);var f=toggleHeight(d)(text("Resent!"));var h=Stream.once(false);var m=toggleHeight(h)(text("Incorrect email or password (click to reset)").all([link,clickThis(function(t,n){n();e.resetPasswordRequest({email:y.username.lastValue()}).then(function(){h.push(false);p.push(true)})})]));var p=Stream.once(false);var g=toggleHeight(p)(text("Check your email!"));var y={username:Stream.once(""),password:Stream.once("")};var v;Stream.combineObject(y).onValue(function(e){v=e;s.push(false)});var b=o.submit(black,"Submit",function(t){t();if(v===undefined){s.push(true)}else{e.signIn(v).then(function(){window.location.hash="#!";window.location.reload()},function(e){if(e.responseText.indexOf("confirm")!==-1){u.push(true)}else{h.push(true)}})}});var w=o.input({name:"email",fieldName:"username",stream:y.username});var S=o.input({name:"password",fieldName:"password",stream:y.password,type:"password"});var T=text("or").all([i.ralewayThinBold]);var k=sideBySide({handleSurplusWidth:giveToSecond},[alignTBM({middle:stack({},[r()])}),alignLRM({middle:alignTBM({middle:T})}),stack({},[sideBySide({gutterSize:a},[w,S,b]),l,c,f,m,g])]);var x=stack({gutterSize:a,collapseGutters:true},[alignLRM({middle:stack({},[r()])}),alignLRM({middle:T}),alignLRM({middle:sideBySide({gutterSize:a},[w,S])}),l,c,f,m,g,alignLRM({middle:b})]);var M=Stream.never();return border(n.middleGray,{bottom:1},t(padding({top:a,bottom:a},form.all([child(componentStream(M.map(function(e){return e>700?k:x}))),function(e,t){t.width.pushAll(M)},wireChildren(passThroughToFirst)]))).all([withBackgroundColor(n.pageBackgroundColor)]))}});define("siteCopyItemsP",["db"],function(e){return e.siteCopyItem.find({}).then(function(e){e.find=function(t){var n=e.filter(function(e){return e.uniqueName===t})[0];return n?n.value:"No Copy"};return e})});define("db",["domain"],function(e){return function(){var t={};schema.map(function(n){var i=e+"/api/"+n.name+"/";var r=function(e){n.fields.map(function(t){if(e[t.name]){if(t.type!==type.id){e[t.name]=t.type.fromString(e[t.name])}}})};var o=function(e){return e.then(function(e){if(e){if(Array.isArray(e)){e.map(r)}else{r(e)}}return e})};t[n.name]={findOne:function(e){var t=Q.defer();$.ajax({type:"post",url:i+"find",data:JSON.stringify(e),contentType:"application/json"}).then(function(e){if(e.length===0){t.resolve(null)}t.resolve(e[0])});return o(t.promise)},find:function(e){return o($.ajax({type:"post",url:i+"find",data:JSON.stringify(e),contentType:"application/json"}))},insert:function(e){return o($.ajax({type:"post",url:i+"insert",data:JSON.stringify(e),contentType:"application/json"}))},update:function(e,t){return o($.ajax({type:"post",url:i+"update",data:JSON.stringify({query:e,update:t}),contentType:"application/json"}))},insertOrUpdate:function(e){if(e._id){return t[n.name].update({_id:e._id},e)}return t[n.name].insert(e)},remove:function(e){return o($.ajax({type:"post",url:i+"remove",data:JSON.stringify(e),contentType:"application/json"}))}}});t.uploadFile=function(e,t){var n=new FormData;if(t){n.append("file",e,t)}else{n.append("file",e)}return $.ajax({url:"/api/uploadFile/insert",type:"post",data:n,cache:false,processData:false,contentType:false})};return t}()});define("wishlistView",["bodyColumn","cart","confettiBackground","db","fonts","formatPrice","gafyColors","holibirthdayRow","meP","separatorSize","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c){return function(d){var f=Q.defer();return promiseComponent(i.gafyDesign.find().then(function(h){return i.gafyStyle.find().then(function(m){return l.then(function(l){if(d){i.gafyWishlist.findOne({user:d}).then(function(e){f.resolve(e.items)})}else if(l){i.gafyWishlist.findOne({user:l._id}).then(function(e){if(e){location.hash="#!wishlist/"+l._id}else{f.resolve(t.wishlistItems)}})}else{f.resolve(t.wishlistItems)}var p=l&&d===l._id||!l&&!d;return f.promise.then(function(i){var l=function(e,n){var s=h.filter(function(t){return t._id===e.designId})[0];var l=m.filter(function(t){return t._id===e.styleId})[0];var c=Stream.once(false);return sideBySide({handleSurplusWidth:giveToFirst},[linkTo("#!design/"+e.designId,grid({minColumnWidth:10,gutterSize:u},[alignLRM({left:image({src:s.imageUrl,minHeight:200,chooseWidth:0})}),alignLRM({left:image({src:l.imageUrl,minHeight:200,chooseWidth:0})}),stack({gutterSize:u},[text(a[e.color].name+" "+s.designDescription+" "+l.styleDescription).all([r.ralewayThinBold]),alignLRM({left:div.all([withBackgroundColor(a[e.color].color),withMinWidth(50),withMinHeight(50)])}),text("Size: "+e.size).all([r.ralewayThinBold])])])),stack({},[alignLRM({right:text(o(l.price)).all([r.ralewayThinBold,$css("font-size",30)])}),alignLRM({right:componentStream(c.map(function(e){return e?text("(Added to Cart)").all([$css("font-size",15),link,clickThis(function(){t.addItem(i[n]);window.location.reload()})]):nothing}))}),alignLRM({right:p?text("Add to Cart").all([$css("font-size",15),link,clickThis(function(){t.addItem(i[n]);c.push(true)})]):nothing}),alignLRM({right:p?text("(Remove Item)").all([$css("font-size",15),link,clickThis(function(){t.removeWishlistItem(n);window.location.reload()})]):nothing})])])};return stack({gutterSize:u},[n(e(s(text("Wish List").all([r.ralewayThinBold,$css("font-size",40)])))),e(stack({gutterSize:u},[stack({gutterSize:u},i.map(l)),alignLRM({right:text("Total: "+o(i.reduce(function(e,t){return e+m.filter(function(e){return e._id===t.styleId})[0].price},0))).all([r.ralewayThinBold,$css("font-size",30)])}),alignLRM({right:sideBySide({gutterSize:u},[linkTo("#!gifts",c(black,sideBySide({gutterSize:u},[r.fa("cart-plus"),text("Continue Shopping")]))),linkTo("#!cart",c(black,sideBySide({gutterSize:u},[r.fa("shopping-cart"),text("Cart")])))])})]))])})})})})).all([function(){l.then(function(e){if(e){f.promise.then(function(t){i.gafyWishlist.findOne({user:d}).then(function(n){if(n){i.gafyWishlist.update({_id:n._id},{user:e._id,items:t}).then(function(){location.hash="#!wishlist/"+e._id})}else{i.gafyWishlist.insert({user:e._id,items:t}).then(function(){location.hash="#!wishlist/"+e._id})}})})}})}])}});define("confettiBackground",["colors","domain"],function(e,t){return function(n){return withBackground(alignLRM({right:image({src:t+"/content/confetti.png",chooseWidth:1})}).all([withBackgroundColor(e.holibirthdayRed)]),n.all([withFontColor(white)]))}});define("socialMediaButton",["fonts","separatorSize"],function(e,t){return function(n){return function(i){return border(i.color,{all:2,radius:2},padding(10,sideBySide({gutterSize:t},[text(i.icon).all([$css("font-size","20px")]),text(n(i.shareVerb)).all([e.bebasNeue])]))).all([link,withFontColor(i.color),clickThis(function(){i.shareThisPage()})])}}});define("gift",["bodyColumn","confettiBackground","domain","fonts","holibirthdayRow","separatorSize","siteCopyItemsP"],function(e,t,n,i,r,o,a){return promiseComponent(a.then(function(a){return stack({gutterSize:o},[t(e(r(stack({gutterSize:o},[text(a.find("Gifts Title")).all([i.ralewayThinBold,i.h1])]),n+"/content/man.png")))])}))});define("bar",[],function(){return{horizontal:function(e,t){e=e||0;t=t||transparent;return div.all([componentName("vertical-separator"),withMinWidth(0,true),withMinHeight(e,true),withBackgroundColor(t)])},vertical:function(e,t){e=e||0;t=t||transparent;return div.all([componentName("horizontal-separator"),withMinWidth(e,true),withMinHeight(0,true),withBackgroundColor(t)])}}});define("separatorSize",[],function(){return 20});define("fonts",[],function(){return{ralewayThin:$css("font-family","Raleway Thin"),bebasNeue:function(e){e.$el.css("font-family","BebasNeue");e.$el.css("font-size","20px");setTimeout(function(){e.updateDimensions()})},celebrationTime:$css("font-family","CelebrationTime"),ralewayThinBold:function(e){e.$el.css("font-family","Raleway Thin");e.$el.css("font-weight","bold");setTimeout(function(){e.updateDimensions()})},h1:function(e){e.$el.css("font-family","Raleway Thin");e.$el.css("font-weight","bold");e.$el.css("font-size",px(40));setTimeout(function(){e.updateDimensions()})},h2:function(e){e.$el.css("font-family","Raleway Thin");e.$el.css("font-weight","bold");e.$el.css("font-size",px(30));setTimeout(function(){e.updateDimensions()})},h3:function(e){e.$el.css("font-family","Raleway Thin");e.$el.css("font-weight","bold");e.$el.css("font-size",px(20));setTimeout(function(){e.updateDimensions()})},fa:function(e){return text('<i	class="fa	fa-'+e+'"></i>')},faI:function(e){return'<i	class="fa	fa-'+e+'"></i>'}}});define("profileP",["meP","profilesP"],function(e,t){return e.then(function(e){return e&&t.then(function(t){return t.filter(function(t){return t.user===e._id})[0]})})});define("formFor",["db","fonts","forms","gafyColors","gafyStyleSmall","opacityGridSelect","prettyForms","separatorSize"],function(e,t,n,i,r,o,a,s){var l=function(e,n,i){return stack({},[text(e).all([t.ralewayThinBold,t.h3]).all(i||[]),n])};var u=function(u){var c={};u.fields.map(function(u){c[u.name]=function(c,d){switch(u.editorType&&u.editorType.name){case"string":return a.input({name:u.displayName,fieldName:u.name,labelAll:c,stream:d,type:"text"});case"paragraph":return a.plainTextarea({name:u.displayName,fieldName:u.name,labelAll:c,stream:d});case"password":return a.input({name:u.displayName,fieldName:u.name,labelAll:c,stream:d,type:"password"});case"html":return a.textarea({name:u.displayName,fieldName:u.name,labelAll:c,stream:d});case"date":return a.input({name:u.displayName,fieldName:u.name,labelAll:c,stream:d,type:"date"});case"number":return a.input({name:u.displayName,fieldName:u.name,labelAll:c,stream:d,type:"number"});case"file":if(u.editorType.accept.indexOf("image")!==-1){return a.imageUpload({name:u.displayName,fieldName:u.name,labelAll:c,stream:d})}return a.fileUpload({name:u.displayName,fieldName:u.name,labelAll:c,stream:d});case"bool":return a.checkbox({name:u.displayName,fieldName:u.name,stream:d});case"foreignKey":return promiseComponent(e[u.editorType.table].find({}).then(function(e){return l(u.displayName,n.selectBox({options:e.map(function(e){return{name:e[u.editorType.nameField],value:e._id}}),name:u.name,stream:d}))}));case"listOf":var f=Stream.create();d.map(function(e){if(!e.join){e=[]}return e.join("\n")}).pushAll(f);f.map(function(e){return e.split("\n")}).pushAll(d);return l(u.displayName+" (one per line)",n.plainTextareaBox(f,u.name).all([$addClass("pre")]));case"oneOf":return l(u.displayName,stack({},u.editorType.options.map(function(e){return sideBySide({gutterSize:s},[n.inputBox(Stream.create(),"radio",u.name).all([$prop("value",e),clickThis(function(){d.push(e)}),function(t){setTimeout(function(){d.onValue(function(n){if(n===e){t.$el.find("input").click()}})})}]),padding({top:1},text(e).all([t.ralewayThinBold]))])})));case"enumeration":return l(u.displayName,n.selectBox({options:u.editorType.options,name:u.name,stream:d}));case"gafyColor":return l(u.displayName,o(d,i.sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return{component:stack({},[alignLRM({middle:div.all([withBackgroundColor(e.color),withMinWidth(50),withMinHeight(50)])}),text(e.name),text(rgbColorString(e.color))]),value:e.name}}),true));case"gafyStyle":return promiseComponent(e.gafyStyle.find({}).then(function(e){return l(u.displayName,o(d,e.map(function(e){return{component:r(e),value:e._id}}),true))}));default:return text("no form element")}}});return function(e){return function(t,n){var i={};var r={};for(var o in t){var a=t[o]!==undefined?Stream.once(t[o]):Stream.create();i[o]=a;if(c[o]){r[o]=c[o](e,a)}}return form.all([child(n(Stream.combineObject(i),r)),wireChildren(passThroughToFirst)])}}};var c=[];schema.map(function(e){var t=u(e);c.push(t);c[e.name]=t});return c});define("header",["adminP","auth","bar","bodyColumn","colors","domain","fonts","meP","separatorSize","signInForm","signInStream","siteCopyItemsP"],function(e,t,n,i,r,o,a,s,l,u,c,d){return promiseComponent(d.then(function(n){var d=function(e){e.all=e.all||[];return function(t){return padding(e.padding,alignTBM({middle:text(t).all(e.all)}))}};var f=function(e){return d({padding:10,all:[a.celebrationTime,$css("font-weight","bold"),$css("font-size","20px")]})(e)};var h=function(e,i,r){var o=[];if(i){o.push(linkTo("#!admin",f(n.find("Header Admin"))))}o.push(linkTo("#!browseStories",f(n.find("Header Browse"))));o.push(linkTo("http://holibirthdaygift.com/",f(n.find("Header Gifts"))));o.push(linkTo("#!causes",f(n.find("Header Causes"))));if(e){o.push(linkTo("#!user/"+e._id,f(n.find("Header My Profile"))));o.push(f(n.find("Header Sign Out")).all([link,clickThis(function(){t.signOut().then(function(){window.location.hash="#!";window.location.reload()})})]))}else{o.push(f(n.find("Header Sign In")).all([link,clickThis(function(e){r.push(!r.lastValue());e.stopPropagation()})]));o.push(linkTo("#!register",f(n.find("Header Register"))))}return o};return s.then(function(t){return e.then(function(e){var n=Stream.once(false);$("body").on("click",function(){c.push(false);n.push(false)});var s=h(t,e,c);var d=sideBySide({gutterSize:l},s);var m=f(a.faI("bars")).all([link,clickThis(function(e){n.push(!n.lastValue());e.stopPropagation()})]);return dropdownPanel(dropdownPanel(border(r.middleGray,{bottom:1},alignLRM({middle:i(stack({},[alignLRM({left:alignTBM({middle:toggleComponent([linkTo(o+"/#!",image({src:"https://www.holibirthday.com/content/man3.png",minHeight:44,minWidth:55.45})),image({src:"https://www.holibirthday.com/content/man3.png",minHeight:44,minWidth:55.45}).all([function(e,t){e.$el.css("cursor","pointer");Stream.combine([windowScroll,t.height,windowHash],function(t,n,i){e.$el.css("opacity",(i===""||i==="#"||i==="#!")&&t>0?1:0);setTimeout(function(){e.$el.css("transition","opacity 0.1s")})})},clickThis(function(){$("body").animate({scrollTop:0},300)})])],windowHash.map(function(e){if(-1!==window.location.origin.indexOf("gift")){return 0}return e===""||e==="#"||e==="#!"?1:0}))}),right:componentStream(windowWidth.map(function(e){if(e>560){n.push(false);return d}return m}))})]))})).all([withBackgroundColor(r.pageBackgroundColor)]),alignLRM({right:border(black,{left:1,bottom:1},stack({gutterSize:l},s).all([withBackgroundColor(r.pageBackgroundColor)]))}),n),u().all([clickThis(function(e){e.stopPropagation()})]),c)})})}))});define("months",[],function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]});define("holibirthdayView",["bodyColumn","colors","confettiBackground","db","fonts","holibirthdayRow","meP","separatorSize","socialMedia","socialMediaButton"],function(e,t,n,i,r,o,a,s,l,u){return function(n){return promiseComponent(Q.all([i.holibirthday.findOne({user:n}),i.profile.findOne({user:n})]).then(function(n){return a.then(function(i){var o=n[0];var a=n[1];if(!o){return nothing}var c=Stream.create();var d=document.createElement("canvas");var f=$(d);f.appendTo($("body")).prop("width",1080).prop("height",702);var h=d.getContext("2d");var m=function(e,t,n){h.font=n;var i=h.measureText(t).width;h.fillText(t,e.x-i/2,e.y)};var p=new Image;p.onload=function(){h.drawImage(p,0,0);m({x:540,y:310},a.firstName+" "+a.lastName,"bold 50px Raleway Thin");m({x:540,y:540},moment(o.date).utc().format("MMMM Do"),"bold 50px Raleway Thin");if(a.birthday){m({x:160,y:595},"Old Birthday","20px BebasNeue");m({x:160,y:615},moment(a.birthday).utc().format("MMMM Do"),"20px BebasNeue")}setTimeout(function(){c.push(d.toDataURL());f.remove()})};p.src="./content/certificate-01.png";var g=u(function(e){return e+(i&&i._id===a.user?" your certificate":" this certificate")});var y=e(alignLRM({middle:sideBySide({gutterSize:s},[g(l.facebook),g(l.twitter)].map(function(e){return e.all([withBackgroundColor(t.pageBackgroundColor),clickThis(function(e){e.stopPropagation()})])}))}));return stack2({gutterSize:s,handleSurplusHeight:giveHeightToNth(0)},[o?componentStream(c.map(function(t){return e(keepAspectRatio(linkTo(t,image({src:t,useNativeSize:true}))))})).all([withMinWidth(0,true),withMinHeight(0,true)]):e(text(a.firstName+" "+a.lastName+" does not have a holibirthday!").all([r.ralewayThinBold,r.h1])),y])})}))}});define("prettyForms",["db","fonts","forms","separatorSize","submitButton"],function(e,t,n,i,r){var o={input:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),alignLRM({left:n.inputBox(e.stream,e.type,e.fieldName)})])},select:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.selectBox(e)])},textarea:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.textareaBox(e.stream,e.fieldName).all([$addClass("pre")])])},plainTextarea:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.plainTextareaBox(e.stream,e.fieldName).all([$addClass("pre")])])},fileUpload:function(e,n){n=n||function(){};e.accept=e.accept||"*";return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),input.all([$prop("type","file"),$prop("accept",e.accept),changeThis(function(t){var i=t.target.files[0];n(i);if(e.stream){e.stream.push(i)}})])])},imageUpload:function(e){var t=Stream.once("./content/man.png");e.stream.pushAll(t);e.accept=e.accept||"image/*";return grid({gutterSize:i},[o.input({name:e.name,accept:e.accept,labelAll:e.labelAll,stream:e.stream}).all([withMinWidth(300,true)]),image({src:t,minWidth:300})])},checkbox:function(e){var r=false;e.stream.onValue(function(e){r=e});return sideBySide({gutterSize:i},[n.inputBox(e.stream,"checkbox",e.fieldName),padding({top:1},text(e.name).all([t.ralewayThinBold]))]).all([clickThis(function(t){e.stream.push(!r);t.stopPropagation();return false})])},radios:function(e){return stack({},e.options.map(function(r){return sideBySide({gutterSize:i},[n.inputBox(Stream.create(),"radio",e.fieldName).all([$prop("value",r.value),function(t){setTimeout(function(){e.stream.onValue(function(e){if(e===r.value){t.$el.find("input").prop("checked",true)}else{t.$el.find("input").prop("checked",false)}})})},clickThis(function(){e.stream.push(r.value)})]),padding({top:1},text(r.name).all([t.ralewayThinBold]))])}))},submit:function(e,n,i){return stack({},[input.all([$prop("type","submit"),submitThis(function(){i();return false}),withMinHeight(0,true),$css("display","none")]),r(e,text(n).all([t.bebasNeue])).all([link,clickThis(function(e,t){var n=t();i(n)})])])}};return o});define("registerView",["auth","bar","bodyColumn","fonts","loginWithFacebook","meP","prettyForms","separatorSize"],function(e,t,n,i,r,o,a,s){return function(){var l=30;var u=Stream.once(false);var c=Stream.once(false);var d={firstName:Stream.never(),lastName:Stream.never(),email:Stream.never(),holibirther:Stream.once(false),knowAHolibirther:Stream.once(false),password:Stream.never(),confirmPassword:Stream.never()};var f;Stream.combineObject(d).onValue(function(e){f=e;u.push(false)});var h=Stream.once(0);var m=a.submit(black,"Submit",function(t){e.grecaptchaP.then(function(n){var i=n.getResponse();if(f===undefined||i===""){u.push(true);t()}else if(f.password!==f.confirmPassword){c.push(true);t()}else{f.captchaResponse=i;e.register(f).then(function(){h.push(1)})}})});var p=a.input({name:"First Name",fieldName:"firstName",stream:d.firstName});var g=a.input({name:"Last Name",fieldName:"lastName",stream:d.lastName});var y=a.input({name:"Email",fieldName:"email",stream:d.email});var v=a.checkbox({name:"Am a Holibirther",fieldName:"holibirther",stream:d.holibirther});var b=a.checkbox({name:"Know a Holibirther",fieldName:"knowAHolibirther",stream:d.knowAHolibirther});var w=a.input({name:"Password",fieldName:"password",stream:d.password,type:"password"});var S=a.input({name:"Password Again",fieldName:"confirmPassword",stream:d.confirmPassword,type:"password"});var T=div.all([$prop("id","grecaptcha-div"),function(t){e.grecaptchaP.then(function(){e.grecaptchaSitekeyP.then(function(e){grecaptcha.render("grecaptcha-div",{sitekey:e});var n=setInterval(function(){t.updateDimensions(true)},100);t.minHeight.onValue(function(){clearInterval(n)})})})}]);var k=text("or").all([i.ralewayThinBold]);return n(padding({top:s*4},sideBySide({handleSurplusWidth:giveToFirst,gutterSize:s*4},[stack({gutterSize:s},[paragraph("Sign in to share a Holibirthday story").all([i.ralewayThinBold,$css("font-size",l)]),paragraph("That Fourth of July birthday cookout where your friends caught the house on fire.").all([i.ralewayThinBold,$css("font-size",l)]),paragraph("Your grandfather being born on April Fools day and nothing he said could be taken seriously.").all([i.ralewayThinBold,$css("font-size",l)])]),form.all([child(stack({gutterSize:s},[r(),alignLRM({middle:k}),toggleComponent([stack({gutterSize:s},[p,g,y,v,b,w,S,T,stack({},[toggleHeight(u)(stack({},[paragraph("Please fill out all fields"),t.horizontal(s)])),toggleHeight(c)(stack({},[paragraph("Passwords must match"),t.horizontal(s)])),m])]),stack({gutterSize:s},[paragraph("Success!").all([i.ralewayThinBold]),paragraph("Please check your email to confirm your email address.").all([i.ralewayThinBold])])],h).all([withMinWidth(300,true)])])),wireChildren(passThroughToFirst)])]))).all([function(){o.then(function(e){if(e){location.hash="#!";location.reload()}})}])}()});define("gafyDesignSmall",["colors","fonts"],function(e,t){return function(e){return stack({},[alignLRM({middle:image({src:e.imageUrl,chooseWidth:0,minHeight:200})}),padding({all:10},alignLRM({middle:text(e.designDescription).all([t.h2])}))]).all([withMinWidth(300,true)])}});define("chooseNonHoliday",[],function(){return function(){var e=function(e,t){return e.month===t.month&&e.dayTens===t.dayTens&&e.dayOnes===t.dayOnes};var t=function(){var e=new Date((new Date).getTime()*Math.random());var t=e.getUTCMonth();var n=e.getUTCDate();var i=parseInt(n/10+"");var r=n%10;return{month:t,dayTens:i,dayOnes:r,date:e}};var n=function(t){if(t.month===10){if(t.dayTens>=2){return true}}if(t.month===11){return true}var n=[{month:0,dayTens:0,dayOnes:1,reason:"New Years"},{month:0,dayTens:0,dayOnes:2,reason:"day after new years"},{month:3,dayTens:0,dayOnes:1,reason:"April Fool's"},{month:6,dayTens:0,dayOnes:4,reason:"Independence Day"},{month:8,dayTens:0,dayOnes:7,reason:"labor day"},{month:9,dayTens:3,dayOnes:1,reason:"halloween"},{month:11,dayTens:2,dayOnes:1,reason:"christmas eve eve eve eve"},{month:11,dayTens:2,dayOnes:2,reason:"christmas eve eve eve"},{month:11,dayTens:2,dayOnes:3,reason:"christmas eve eve"},{month:11,dayTens:2,dayOnes:4,reason:"christmas eve"},{month:11,dayTens:2,dayOnes:5,reason:"christmas"},{month:11,dayTens:2,dayOnes:6,reason:"day after christmas"},{month:11,dayTens:2,dayOnes:7,reason:"day after day after christmas"},{month:11,dayTens:2,dayOnes:8,reason:"day after day after day after christmas"},{month:11,dayTens:2,dayOnes:9,reason:"day after day after day after day after christmas"},{month:11,dayTens:3,dayOnes:0,reason:"New Years eve eve"},{month:11,dayTens:3,dayOnes:1,reason:"New Years eve"}];return n.filter(function(n){return e(n,t)}).length>0};var i=t();while(n(i)){i=t()}return i.date}});define("storyPaginate",["bar","colors","fonts","separatorSize"],function(e,t,n,i){var r=function(e){return function(t,n){var i=[];for(var r=0;r<n.length;r+=t.perPage){i.push(n.slice(r,r+t.perPage))}if(i.length===0){i.push([])}return e(i,t.pageS)}};return r(function(n,r){var o=false;return componentStream(r.map(function(a){var s=alignLRM({middle:sideBySide({gutterSize:i},n.map(function(e,n){var i=""+(n+1);return a===n?text(i):text(i).all([withFontColor(t.linkBlue),$css("text-decoration","underline"),link,clickThis(function(){r.push(n)})])}))});return stack({gutterSize:i},[s,stack({gutterSize:i},intersperse(n[a],e.horizontal(1,t.middleGray))),s]).all([function(e,t){if(o){var n=-50+t.topAccum.lastValue()+t.top.lastValue();$("body").animate({scrollTop:n},300)}o=true}])}))})});define("areYouSure",["fonts","separatorSize","submitButton"],function(e,t,n){return function(i){i=i||{};i.text=i.text||"Are you sure?";i.yesText=i.yesText||"Yes";i.noText=i.noText||"No";i.onYes=i.onYes||function(){};i.onNo=i.onNo||function(){};var r=Q.defer();var o=function(){r.promise.then(function(e){e.$el.css("opacity",0);setTimeout(function(){e.destroy()},200)})};var a=extendToWindowBottom(alignLRM({middle:alignTBM({middle:stack({gutterSize:t},[paragraph(i.text,300).all([e.h1,e.ralewayThinBold,$css("text-align","center")]),alignLRM({left:n(black,text(i.noText).all([e.bebasNeue])).all([link,clickThis(function(){i.onNo();o()})]),right:n(black,text(i.yesText).all([e.bebasNeue])).all([link,clickThis(function(){i.onYes();o()})])})])})})).all([$css("position","fixed"),function(e){e.$el.css("opacity",0);setTimeout(function(){e.$el.css("transition","opacity 0.2s").css("opacity",1)})}]);r.resolve(rootComponent(a))}});define("domain",[],function(){return"https://www.holibirthday.com"});define("app",["bar","colors","footer","header","pageRoutes","separatorSize"],function(e,t,n,i,r,o){var a=extendToWindowBottom(alignTBM({top:fixedHeaderBody({},i,stack({},[e.horizontal(o),route(r),e.horizontal(o)])),bottom:n})).all([withBackgroundColor(t.pageBackgroundColor)]);return a});define("submitButton",[],function(){return function(e,t){if(!t){debugger}return border(e,{all:2,radius:5},padding({all:8,top:10},alignLRM({middle:alignTBM({middle:t})})))}});window.app=function(){if(-1===window.location.origin.indexOf("holibirthdaygift")){require(["app"],function(e){rootComponent(e)})}else{require(["gift","header","footer"],function(e,t,n){rootComponent(t.all([$addClass("reset"),$css("z-index",100),$css("position","fixed")]));var i=$(document.createElement("div")).appendTo($("#footer")).css("position","relative");rootComponent(n.all([$addClass("reset"),$css("z-index",100)]),{$el:i});var r=$(document.createElement("div")).prependTo("#content").css("position","relative");var o=rootComponent(e,{$el:r});o.minHeight.map(function(e){r.css("height",e)})})}};define("cart",[],function(){var e="shoppingCart";var t="wishlist";var n=JSON.parse(window.localStorage.getItem(e))||[];var i=JSON.parse(window.localStorage.getItem(t))||[];return{items:n,wishlistItems:i,addItem:function(t){n.push(t);window.localStorage.setItem(e,JSON.stringify(n))},removeItem:function(t){n.splice(t,1);window.localStorage.setItem(e,JSON.stringify(n))},editItem:function(t,i){n[t]=i;window.localStorage.setItem(e,JSON.stringify(n))},addWishlistItem:function(e){i.push(e);window.localStorage.setItem(t,JSON.stringify(i))},removeWishlistItem:function(e){i.splice(e,1);window.localStorage.setItem(t,JSON.stringify(i))},editWishlistItem:function(e,n){i[e]=n;window.localStorage.setItem(t,JSON.stringify(i))}}});define("gafyDesignRow",["fonts","separatorSize"],function(e,t){return function(n){return grid({handleSurplusWidth:giveToSecond},[alignTBM({middle:image({src:n.imageUrl,minWidth:300,chooseHeight:0})}),alignTBM({middle:padding({left:30,right:30},stack({gutterSize:t},[text(n.designDescription).all([e.ralewayThinBold,$css("font-size",40)])])).all([withMinWidth(300,true)])})])}});define("contactsView",["areYouSure","bar","bodyColumn","colors","confettiBackground","db","defaultFormFor","domain","fonts","holibirthdayRow","meP","separatorSize","signInForm","signInStream","socialMedia","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p){return promiseComponent(c.then(function(s){if(!s){return stack({gutterSize:d},[r(n(u(text("Contacts").all([l.ralewayThinBold,l.h1])))),n(paragraph("You must sign in to add contacts").all([l.bebasNeue,$css("font-size","30px"),link,clickThis(function(e){h.push(true);e.stopPropagation()})]))])}var c=new Date;var f=365*24*60*60*1e3;var g=function(e){if(!e){return f}var t=new Date(c);t.setUTCMonth(e.getUTCMonth());t.setUTCDate(e.getUTCDate());var n=t.getTime()-c.getTime();if(n<0){n+=f}return n};return m.facebook.api("/me/friends","get",{}).then(function(c){var f=c.data&&c.data.map(function(e){return e.id})||[];return $.ajax({type:"post",url:"/userIdsByFacebookIds",data:JSON.stringify(f),contentType:"application/json"}).then(function(c){return Q.all([o.contactOtherUser.find({user:s._id}),o.contactCustom.find({user:s._id})]).then(function(f){var h=Stream.once(f[0]);var y=Stream.once(f[1]);var v=h.map(function(e){return c.map(function(e){return{user:e}}).concat(e.map(function(e){return{user:e.otherUser}}))});return componentStream(v.map(function(f){return promiseComponent(Q.all([o.profile.find({$or:f}),o.holibirthday.find({$or:f})]).then(function(f){var v=f[0];var b=f[1];var w=h.map(function(t){return t.map(function(t){var n=v.filter(function(e){return e.user===t.otherUser})[0];var i=b.filter(function(e){return e.user===n.user})[0];return{row:[linkTo("#!user/"+n.user,text(n.firstName+" "+n.lastName).all([l.ralewayThinBold])),text(n.birthday?"Born on<br>"+moment(n.birthday).utc().format("MMMM Do"):"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text(i?"Holiborn on<br>"+moment(i.date).utc().format("MMMM Do"):"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text(n.email||"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text("(remove this contact)").all([l.ralewayThinBold]).all([link,clickThis(function(){e({onYes:function(){o.contactOtherUser.remove({user:s._id,otherUser:n.user}).then(function(){h.push(h.lastValue().filter(function(e){return e._id!==t._id}))})}})})])].map(function(e){return alignTBM({middle:e})}),howLong:Math.min(g(n.birthday),g(i&&i.date))}})});var S=y.map(function(t){return t.map(function(t){return{row:[text(t.name).all([l.ralewayThinBold]),text(t.birthday?"Born on<br>"+moment(t.birthday).utc().format("MMMM Do"):"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),nothing,text(t.email||"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text("(remove this contact)").all([l.ralewayThinBold]).all([link,clickThis(function(){e({onYes:function(){o.contactCustom.remove({_id:t._id}).then(function(){y.push(y.lastValue().filter(function(e){return e._id!==t._id}))})}})})])].map(function(e){return alignTBM({middle:e})}),howLong:g(t.birthday)}})});var T=Stream.combine([w,S],function(e,t){return e.concat(t).sort(function(e,t){return t.howLong-e.howLong}).map(function(e){return e.row})});return stack({gutterSize:d},[r(n(u(text("Contacts").all([l.ralewayThinBold,l.h1])))),n(alignLRM({middle:componentStream(T.map(function(e){return a.contactCustom({user:s._id,name:"",birthday:null,email:""},function(n,r){return alignLRM({middle:stack({gutterSize:d},intersperse(e.map(function(e){return grid({gutterSize:d,useFullWidth:true,handleSurplusWidth:justifyAndCenterSurplusWidth
},e.map(function(e){return e.all([withMinWidth(170,true)])}))}).concat([grid({gutterSize:d,useFullWidth:true,handleSurplusWidth:justifyAndCenterSurplusWidth},[r.name,r.birthday,nothing,r.email,alignTBM({middle:p(black,text("Add Contact").all([l.bebasNeue])).all([link,clickThis(function(e,t){var i=t();o.contactCustom.insert(n.lastValue()).then(function(e){y.push(y.lastValue().concat([e]));i()})})])})].map(function(e){return e.all([withMinWidth(170,true)])}))]),t.horizontal(1).all([withBackgroundColor(i.middleGray)])))})})}))})),t.horizontal(1).all([withBackgroundColor(black)]),componentStream(h.map(function(t){var i=c.filter(function(e){return t.filter(function(t){return e===t.otherUser}).length===0});if(i.length===0){return nothing}return n(stack({gutterSize:d,collapseGutters:true},[s.facebookId?alignLRM({middle:text("Facebook friends who use Holibirthday").all([l.h2])}):nothing,alignLRM({middle:table({paddingSize:d},i.map(function(t){var n=v.filter(function(e){return e.user===t})[0];var i=b.filter(function(e){return e.user===n.user})[0];return[linkTo("#!user/"+n.user,text(n.firstName+" "+n.lastName).all([l.ralewayThinBold])),text(n.birthday?"Born on<br>"+moment(n.birthday).utc().format("MMMM Do"):"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text(i?"Holiborn on<br>"+moment(i.date).utc().format("MMMM Do"):"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),text(n.email||"&nbsp;").all([l.ralewayThinBold,$css("text-align","center")]),alignTBM({middle:p(black,text("Add Contact").all([l.bebasNeue])).all([link,clickThis(function(){e({onYes:function(){o.contactOtherUser.insert({user:s._id,otherUser:n.user}).then(function(e){h.push(h.lastValue().concat([e]))})}})})])})]}))})]))})),alignLRM({middle:p(m.facebook.color,sideBySide({gutterSize:d},[text(m.facebook.icon).all([$css("font-size","20px")]),text(s.facebookId?"Invite More Facebook Friends":"Invite Facebook Friends").all([l.bebasNeue])])).all([withFontColor(m.facebook.color),link,clickThis(function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Mobile|Opera Mini/i.test(navigator.userAgent)){FB.ui({display:"popup",method:"share",href:location.origin})}else{FB.ui({display:"popup",method:"send",link:location.origin})}})])})])}))}))})})})}))});define("formatPrice",[],function(){return function(e){return"$"+Math.floor(e/100)+"."+e%100}});define("gafyStyleSmall",["colors","fonts"],function(e,t){return function(n){return border(e.middleGray,{all:1},stack({},[alignLRM({middle:image({src:n.imageUrl||"./content/man.png",chooseWidth:0,minHeight:200})}),padding({all:10},alignLRM({middle:text(n.styleDescription).all([t.h2])}))])).all([withMinWidth(300,true)])}});define("formFieldsFor",[],function(){var e=function(e){return function(e,t){return form.all([child(t({})),wireChildren(passThroughToFirst)])}};var t=[];schema.map(function(n){formFieldsForTable=e(n);t.push(n);t[n.name]=n});return t});define("adminView",["areYouSure","bar","bodyColumn","colors","db","defaultFormFor","fonts","formLayouts","forms","gafyDesignSmall","gafyStyleSmall","months","prettyForms","separatorSize","storiesP","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p){var g=function(e){var t=padding({top:10,bottom:10,left:10,right:10},paragraph(e,0).all([a.h3]));return{left:border(i.middleGray,{top:1,left:1},padding({left:1,right:2},t)),right:border(i.middleGray,{top:1,right:1},padding({left:2,right:1},t)),selected:border(i.middleGray,{top:1,left:1,right:1},padding({all:1},t))}};var y=function(e){return border(i.middleGray,{all:1},padding({all:h},e))};var v=promiseComponent(r.dailyTheme.findOne({}).then(function(e){e=e||{};return o.dailyTheme({_id:e._id||null,type:e.type||schema.dailyTheme.fields.type.options.featuredStory,storyId:e.storyId||null,storyText:e.storyText||"",giftId:e.giftId||null,giftText:e.giftText||"",pollTitle:e.pollTitle||"",pollDescription:e.pollDescription||"",pollChoices:e.pollChoices||"",pollImage:e.pollImage||"./content/man.png",someTextTitle:e.someTextTitle||"",someTextText:e.someTextText||"",someTextImage:e.someTextImage||"./content/man.png"},function(e,t){var n=stack({gutterSize:h},[t.storyId,t.storyText]);var i=stack({gutterSize:h},[t.giftId,t.giftText]);var o=stack({gutterSize:h},[t.pollTitle,t.pollDescription,t.pollChoices,t.pollImage]);var s=stack({gutterSize:h},[t.someTextTitle,t.someTextText,t.someTextImage]);var l=alignLRM({left:p(black,text("Publish")).all([link,clickThis(function(){var t=e.lastValue();delete t._id;r.dailyTheme.insert(t).then(function(){window.location.hash="#!";window.location.reload()})})])});return stack({gutterSize:h},[text("Daily Theme").all([a.h1]),t.type,componentStream(e.map(function(e){switch(e.type){case schema.dailyTheme.fields.type.options.featuredStory:return n;case schema.dailyTheme.fields.type.options.featuredGift:return i;case schema.dailyTheme.fields.type.options.poll:return o;case schema.dailyTheme.fields.type.options.someText:return s}})),l])})}));var b=promiseComponent(r.siteCopyItem.find({}).then(function(e){var t=function(t,n){var i=e.filter(function(e){return e.uniqueName===t})[0]||{uniqueName:t,value:n==="imageUpload"?"/content/man.png":""};var o=Stream.once(i.value);var s=o.map(function(){return true});s.push(false);return stack({gutterSize:h},[f[n||"input"]({name:t,stream:o}),alignLRM({left:sideBySide({gutterSize:h},[p(black,text("Save").all([a.bebasNeue])).all([link,clickThis(function(){i.value=o.lastValue();(i._id?r.siteCopyItem.update({_id:i._id},i):r.siteCopyItem.insert(i)).then(function(e){i._id=i._id||e._id;s.push(false)})})]),componentStream(s.map(function(e){return e?alignTBM({middle:text("(unsaved)")}):nothing}))])})])};return tabs([{tab:g("Home Page"),content:y(stack({gutterSize:h},[t("Home Tagline"),t("Home Share Your Story"),t("Home Claim Your Holibirthday"),t("Home Find Friends"),t("Home Stories"),t("Home Browse Stories")]))},{tab:g("Story View"),content:y(stack({gutterSize:h},[t("Story Comment Sign In"),t("Story Comment Post"),t("Story Comment Delete"),t("Story By (include a space)"),t("Story Category (include a space)"),t("Story Tags (include a space)"),t("Story Edit"),t("Story Delete")]))},{tab:g("Edit Story"),content:y(stack({gutterSize:h},[t("Edit Story Must Sign In"),t("Edit Story Title"),t("Edit Story Smaller Title"),t("Edit Story Instructions","plainTextarea"),t("Edit Story Submit Instructions"),t("Edit Story Title Field"),t("Edit Story Body Field"),t("Edit Story Category Field"),t("Edit Story Tags Field"),t("Edit Story Image URL Field"),t("Edit Story Add Tag"),t("Edit Story Submit Story")]))},{tab:g("Profile"),content:y(stack({gutterSize:h},[t("Profile Born On (include space)"),t("Profile Holibirthday Points (include space)"),t("Profile My Contacts"),t("Profile Add Contact"),t("Profile Claim a Holibirthday"),t("Profile Holibirthday Points / View Leaderboards"),t("Profile Holibirthday Points Total"),t("Profile Edit")]))},{tab:g("Edit Profile"),content:y(stack({gutterSize:h},[t("Edit Profile Title"),t("Edit Profile First Name"),t("Edit Profile Last Name"),t("Edit Profile Email"),t("Edit Profile Receive Marketing Emails"),t("Edit Profile Birthday"),t("Edit Profile Bio"),t("Edit Profile Image URL"),t("Edit Profile Holibirther"),t("Edit Profile Holibirthday Month"),t("Edit Profile Holibirthday Day"),t("Edit Profile Know a Holibirther"),t("Edit Profile Change Your Password"),t("Edit Profile New Password"),t("Edit Profile Confirm New Password")]))},{tab:g("Daily Theme"),content:y(stack({gutterSize:h},[t("Daily Theme Placeholder"),t("Daily Theme Poll Vote / Abstain"),t("Daily Theme Poll Sign In")]))},{tab:g("Gifts"),content:y(stack({gutterSize:h},[t("Gifts Title")]))},{tab:g("Causes"),content:y(stack({gutterSize:h},[t("Causes Title"),t("Causes Donate Now"),t("Causes","textarea"),t("Causes Image","imageUpload")]))},{tab:g("Site Header"),content:y(stack({gutterSize:h},[t("Header Browse"),t("Header Gifts"),t("Header Causes"),t("Header My Profile"),t("Header Contacts"),t("Header Sign In"),t("Header Sign Out"),t("Header Register"),t("Header Admin")]))},{tab:g("Donation Email"),content:y(stack({gutterSize:h},[t("Donate Confirmation Email: From"),t("Donate Confirmation Email: From Name"),t("Donate Confirmation Email: Subject"),t("Donate Confirmation Email: Text ( {{donationNumber}} includes donation number)","plainTextarea")]))}])}));var w=function(e){return stack({},[text(e.name).all([a.h3])])};var S=promiseComponent(r.famousBirthday.find({}).then(function(t){var n=Stream.once(t);var i=s.stack({formBuilder:o.famousBirthday,stackConfig:{gutterSize:h},fields:["name","birthday","imageUrl"]});var l=Stream.once(0);var u=Stream.once(t.length>0?t[0]._id:null);var c=Stream.combine([n,u],function(e,t){return e.filter(function(e){return e._id===t})[0]||{}});return stack({gutterSize:h},[tabs([{tab:g("Famous Birthdays List"),content:y(stack({gutterSize:h},[text("Famous Birthdays List").all([a.h2]),componentStream(n.map(function(e){var t=[];e.map(function(e){var n=moment(e.birthday);var i=n.month();var r=n.date();t[i]=t[i]||[[]];t[i][r]=t[i][r]||[];t[i][r].push(e)});var n=Stream.once(d[0]);return stack({gutterSize:h},[f.select({name:"Month",options:d,stream:n}),componentStream(n.map(function(e){var n=d.indexOf(e);var i=t[n];return stack({gutterSize:h},i.map(function(e,t){return t===0?nothing:stack({},[text(d[n]+" "+t).all([a.h2]),stack({},e.map(function(e){return w(e).all([link,clickThis(function(){u.push(e._id);l.push(2)})])}))])}))}))])}))]))},{tab:g("Add Famous Birthday"),content:y(stack({gutterSize:h},[text("Add Famous Birthday").all([a.h2]),i({name:"",birthday:new Date,description:"",imageUrl:"./content/man.png"},function(e){var t=Stream.once(0);e.onValue(function(){t.push(0)});return stack({gutterSize:h},[toggleComponent([nothing,text("You must fill out all fields")],t),alignLRM({left:p(black,text("Add Famous Birthday")).all([link,clickThis(function(){var i=e.lastValue();if(!i){t.push(1);return}i.birthday=moment(moment(i.birthday).utc().format("YYYY-MM-DD")).format();r.famousBirthday.insert(i).then(function(e){n.push(n.lastValue().concat([e]));l.push(0)})})])})])})]))},{tab:g("Edit Famous Birthday"),content:y(stack({gutterSize:h},[componentStream(n.map(function(e){return f.select({name:"Editing Famous Birthday",options:e.map(function(e){return{name:e.name,value:e._id}}),stream:u}).all([changeThis(function(e){u.push($(e.target).val())})])})),text("Edit Famous Birthday").all([a.h2]),componentStream(c.map(function(t){return i(t,function(t){var i=Stream.once(0);t.onValue(function(){i.push(0)});return stack({gutterSize:h},[toggleComponent([nothing,text("You must fill out all fields")],i),alignLRM({left:sideBySide({gutterSize:h},[p(black,text("Save Famous Birthday").all([a.bebasNeue])).all([link,clickThis(function(){var e=t.lastValue();if(!e){i.push(1);return}e.birthday=moment(moment(e.birthday).utc().format("YYYY-MM-DD")).format();r.famousBirthday.update({_id:e._id},e).then(function(){var t=n.lastValue().slice(0);for(var i=0;i<t.length;i++){if(t[i]._id===e._id){t[i]=e}}n.push(t);l.push(0)})})]),p(black,text("Delete Famous Birthday")).all([link,clickThis(function(){e({onYes:function(){var e=t.lastValue();if(!e){i.push(1);return}r.famousBirthday.remove({_id:e._id},e).then(function(){var t=n.lastValue().slice(0);for(var i=0;i<t.length;i++){if(t[i]._id===e._id){t.splice(i,1)}}n.push(t);l.push(0)})}})})])])})])})}))]))}],l)])}));var T=promiseComponent($.ajax({url:"/mailchimp/templates"}).then(function(e){var t=e.map(function(e){return{name:e.name,value:e.id}});t.sort(function(e,t){return e.name.localeCompare(t.name)});return r.mailchimpTemplate.find({}).then(function(e){return alignLRM({left:stack({gutterSize:h},[{name:"Holibirthday in Three Weeks",event:schema.mailchimpTemplate.fields.event.options.holibirthdayInThreeWeeks},{name:"Holibirthday Tomorrow",event:schema.mailchimpTemplate.fields.event.options.holibirthdayTomorrow},{name:"Friend's Holibirthday in Three Weeks",event:schema.mailchimpTemplate.fields.event.options.friendsHolibirthdayInThreeWeeks},{name:"Friend's Holibirthday Tomorrow",event:schema.mailchimpTemplate.fields.event.options.friendsHolibirthdayTomorrow},{name:"Your Story Deleted",event:schema.mailchimpTemplate.fields.event.options.storyDeleted},{name:"Your Comment Deleted",event:schema.mailchimpTemplate.fields.event.options.commentDeleted}].map(function(n){var i=Stream.splitObject(e.filter(function(e){return e.event===n.event})[0]||{event:n.event,mailchimpTemplateId:"",toName:"",fromName:"",subject:""});var o=Stream.combineObject(i);var s=Stream.once(false);var u=false;o.map(function(){if(u){s.push(true)}u=true});return stack({gutterSize:h},[text(n.name).all([a.h2]),l.selectBox({options:t,stream:i.mailchimpTemplateId}),f.input({name:"toName",stream:i.toName}),f.input({name:"fromName",stream:i.fromName}),f.input({name:"subject",stream:i.subject}),sideBySide({gutterSize:h},[p(black,text("Save").all([a.bebasNeue])).all([link,clickThis(function(e,t){var n=t();r.mailchimpTemplate.insertOrUpdate(o.lastValue()).then(function(){n();s.push(false)})})]),alignTBM({middle:componentStream(s.map(function(e){return e?text("(unsaved)"):nothing}))})])])}))})})}));var k=promiseComponent($.ajax({url:"/mailchimp/lists"}).then(function(e){var t=e.map(function(e){return{name:e.name,value:e.id}});t.sort(function(e,t){return e.name.localeCompare(t.name)});return r.mailchimpList.find({}).then(function(e){return alignLRM({left:stack({gutterSize:h},[{name:"Holibirthers",internalType:"holibirthers"},{name:"Friends of Holibirthers",internalType:"friendsOfHolibirthers"}].map(function(n){var i=Stream.splitObject(e.filter(function(e){return e.mailchimpListType===n.internalType})[0]||{mailchimpListType:n.internalType,mailchimpListId:""});var o=Stream.combineObject(i);var s=Stream.once(false);var u=false;o.map(function(){if(u){s.push(true)}u=true});return stack({gutterSize:h},[text(n.name).all([a.h2]),l.selectBox({options:t,stream:i.mailchimpListId}),sideBySide({gutterSize:h},[p(black,text("Save").all([a.bebasNeue])).all([link,clickThis(function(e,t){var n=t();r.mailchimpList.insertOrUpdate(o.lastValue()).then(function(){n();s.push(false)})})]),alignTBM({middle:componentStream(s.map(function(e){return e?text("(unsaved)"):nothing}))})])])}))})})}));return n(stack({},[t.horizontal(h),tabs([{tab:g("Daily Theme"),content:y(v)},{tab:g("Site Copy"),content:y(b)},{tab:g("Famous Birthdays"),content:y(S)},{tab:g("Mailchimp Templates"),content:y(T)},{tab:g("Mailchimp Lists"),content:y(k)}],Stream.once(0))]))});define("adminP",["db","meP"],function(e,t){return t.then(function(t){if(t){return e.admin.findOne({user:t._id})}})});define("socialMedia",[],function(){return function(){var e=function(e){var t=575,n=400,i=($(window).width()-t)/2,r=($(window).height()-n)/2,o="status=1"+",width="+t+",height="+n+",top="+r+",left="+i;window.open(e,"twitter",o)};return{facebook:{icon:'<i	class="fa	fa-facebook"></i>',color:color({r:59,g:89,b:152}),name:"Facebook",shareVerb:"share",shareThisPage:function(){return FB.ui({display:"popup",method:"share",href:location.href})},api:function(){var e=Array.prototype.slice.call(arguments);var t=Q.defer();e[3]=function(e){t.resolve(e)};FB.api.apply(null,e);return t.promise}},twitter:{icon:'<i	class="fa	fa-twitter"></i>',color:color({r:0,g:172,b:237}),name:"Twitter",shareVerb:"tweet",shareThisPage:function(){return e("https://twitter.com/intent/tweet?url="+encodeURIComponent(location.href))},countShares:function(){}}}}()});define("storyDetailViewP",["adminP","areYouSure","bar","bodyColumn","confettiBackground","db","fonts","forms","meP","prettyForms","profilesP","separatorSize","signInStream","siteCopyItemsP","socialMedia","socialMediaButton","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p,g){var y=function(e){return promiseComponent(l.then(function(t){return h.then(function(n){if(!t){return text(n.find("Story Comment Sign In")).all([a.bebasNeue,link,clickThis(function(e){f.push(true);e.stopPropagation()})])}var i={user:t._id,story:e._id,text:""};var r=Stream.splitObject(i);var l=Stream.combineObject(r);var c;l.onValue(function(e){c=e});return form.all([child(stack({},[stack({},[s.plainTextareaBox(r.text,"text").all([$prop("rows",6)]),alignLRM({left:u.submit(black,n.find("Story Comment Post"),function(){o.comment.insert(c).then(function(){window.location.reload()})})})].map(function(e){return padding({top:10},e)}))])),wireChildren(function(e,t,n){n.minHeight.pushAll(e.minHeight);n.minWidth.pushAll(e.minWidth);return[t]})])})}))};var v=function(n){return promiseComponent(o.comment.find({story:n._id}).then(function(n){n.sort(function(e,t){return new Date(t.createDate).getTime()-new Date(e.createDate).getTime()});return c.then(function(i){return e.then(function(e){return h.then(function(r){return stack({gutterSize:d*2},n.map(function(n){var a=i.filter(function(e){return e.user===n.user})[0];return sideBySide({handleSurplusWidth:giveToNth(2),gutterSize:d},[stack({gutterSize:d,collapseGutters:true},[linkTo("#!user/"+a.user,image({src:a.profileImageURL||"./content/man.png",minWidth:100,chooseHeight:true})),linkTo("#!user/"+a.user,text(a.firstName+" "+a.lastName)),e?text(r.find("Story Comment Delete")).all([link,clickThis(function(e){e.stopPropagation();t({onYes:function(){o.comment.remove({_id:n._id}).then(function(){window.location.reload()})}})})]):nothing]),border(black,{all:1},padding(10,text(n.text))).all([withBackgroundColor(white)])])}))})})})}))};var b=p(function(e){return e+" this story"});return function(n){return promiseComponent(c.then(function(s){var u=s.filter(function(e){return e.user===n.user})[0];return l.then(function(s){return e.then(function(e){return h.then(function(l){return stack({gutterSize:d},[r(i(grid({handleSurplusWidth:giveToSecond},[alignTBM({middle:image({src:n.imageUrl||"./content/man.png",minWidth:300,chooseHeight:0})}),alignTBM({middle:padding({left:30,right:30},stack({gutterSize:d/2},[paragraph(n.name,150).all([a.h1]),linkTo("#!user/"+u.user,paragraph(l.find("Story By (include a space)")+u.firstName+" "+u.lastName).all([a.h2])),n.storyType?text(l.find("Story Category (include a space)")+n.storyType).all([a.h3]):nothing,promiseComponent(o.storyTag.find({story:n._id}).then(function(e){return e.length>0?sideBySide({handleSurplusWidth:giveToSecond},[text(l.find("Story Tags (include a space)")).all([a.h3]),grid({gutterSize:d/2,useFullWidth:true},e.map(function(e){return text(e.tag).all([a.h3])}))]):nothing}))]))}).all([withMinWidth(300,true)])]))),i(stack({},[div.all([componentName("story-detail-text"),function(e){var t=$(n.text);t.find("div").css("position","initial");t.appendTo(e.$el);e.updateDimensions()}])])),i(grid({gutterSize:d},[b(m.facebook),b(m.twitter)])),i(y(n)),i(v(n)),i(e||s&&s._id===n.user?alignLRM({left:sideBySide({gutterSize:d},[linkTo("#!editStory/"+n._id,g(black,text(l.find("Story Edit")).all([a.bebasNeue]))),g(black,text(l.find("Story Delete")).all([a.bebasNeue])).all([link,clickThis(function(){return t({onYes:function(){o.story.remove({_id:n._id}).then(function(){window.location.hash="#!";window.location.reload()})}})})])])}):nothing)])})})})}))}});define("confirmEmailView",["auth","bodyColumn","fonts"],function(e,t,n){return function(i){var r=Stream.once(text("Confirming Email...").all([n.h1]));e.confirmEmail(i).then(function(){r.push(text("Confirmed!  You may now log in.").all([n.h1]))},function(){r.push(text("Invalid token.").all([n.h1]))});return t(componentStream(r))}});define("homeViewP",["bar","bodyColumn","colors","confettiBackground","dailyTheme","db","fonts","separatorSize","siteCopyItemsP","storiesP","storyPaginate","storyRowP"],function(e,t,n,i,r,o,a,s,l,u,c,d){var f=function(e,t){return border(n.holibirthdayDarkRed,{top:5,radius:5},padding(10,alignTBM({middle:stack({},[paragraph(e,150).all([a.bebasNeue,$css("text-align","center"),withFontColor(white)]),a.fa(t).all([$css("text-align","center"),$css("font-size","60px"),withFontColor(white)])])})).all([withBackgroundColor(n.holibirthdayRed)]))};return l.then(function(e){return u.then(function(o){o.sort(function(e,t){return new Date(t.createDate).getTime()-new Date(e.createDate).getTime()});var l=function(e,t){return border(black,1,withBackgroundImage({src:e.imageUrl||"./content/man.png"},t.all([withBackgroundColor(color({a:.5})),withFontColor(white)])))};var u=t(image({src:"/content/banner.png",chooseHeight:1}));var h=t(grid({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:s},[alignLRM({middle:linkTo("#!editStory",f(e.find("Home Share Your Story"),"bullhorn"))}),alignLRM({middle:linkTo("#!myHolibirthday",f(e.find("Home Claim Your Holibirthday"),"gift"))}),alignLRM({middle:linkTo("#!contacts",f(e.find("Home Find Friends"),"users"))})]));var m=paragraph(e.find("Home Tagline")).all([a.bebasNeue,$css("text-align","center"),$css("font-size",30)]);var p=i(t(r));var g=t(c({perPage:5,pageS:Stream.once(0)},o.map(d)));return stack({gutterSize:s*2},[stack({gutterSize:s*2},[u,m]),stack({gutterSize:s},[h]),stack({gutterSize:s},[p,alignLRM({middle:linkTo("#!browseStories",text(e.find("Home Stories")).all([a.h1]))}),g,alignLRM({middle:linkTo("#!browseStories",text(e.find("Home Browse Stories")).all([withFontColor(n.linkBlue),$css("text-decoration","underline")]))})])])})})});define("leaderboardsView",["bodyColumn","colors","confettiBackground","db","fonts","holibirthdayRow","separatorSize"],function(e,t,n,i,r,o,a){return promiseComponent(i.pointsTotal.find({}).then(function(s){return i.profile.find({$or:s.map(function(e){return e.user})}).then(function(i){return stack({gutterSize:a},[n(e(o(stack({gutterSize:a},[paragraph("Holibirthday Leaderboards").all([r.h1,r.ralewayThinBold])])))),e(alignLRM({middle:stack({gutterSize:a,collapseGutters:true},s.sort(function(e,t){return t.amount-e.amount}).map(function(e){var n=i.filter(function(t){return t.user===e.user})[0];return n?linkTo("#!user/"+n.user,sideBySide({gutterSize:a,handleSurplusWidth:giveToSecond},[alignTBM({middle:text(""+e.amount).all([withFontColor(t.darkGreen),r.ralewayThinBold,r.h2])}).all([withMinWidth(100,true)]),alignTBM({middle:paragraph(n.firstName+" "+n.lastName).all([r.ralewayThinBold,r.h2])})])):nothing}))}))])})}))});define("gafyColors",[],function(){return[{name:"Black",color:color({r:0,g:0,b:0})},{name:"White",color:color({r:255,g:255,b:255})},{name:"Toasted Oatmeal",color:color({r:242,g:238,b:226})},{name:"Light Grey",color:color({r:204,g:204,b:204})},{name:"Grey",color:color({r:188,g:188,b:178})},{name:"Brown",color:color({r:129,g:86,b:30})},{name:"Dark Brown",color:color({r:100,g:65,b:17})},{name:"Yellow",color:color({r:254,g:255,b:1})},{name:"Gold",color:color({r:252,g:206,b:0})},{name:"Dark Gold",color:color({r:251,g:166,b:24})},{name:"Old Gold",color:color({r:176,g:137,b:8})},{name:"Orange",color:color({r:237,g:104,b:35})},{name:"Texas Orange",color:color({r:187,g:94,b:25})},{name:"Deep Orange",color:color({r:234,g:82,b:35})},{name:"Red",color:color({r:220,g:27,b:54})},{name:"Mid Red",color:color({r:180,g:3,b:19})},{name:"Dark Red",color:color({r:193,g:4,b:0})},{name:"Fuchsia",color:color({r:172,g:4,b:125})},{name:"Maroon",color:color({r:129,g:2,b:55})},{name:"Magenta",color:color({r:188,g:38,b:163})},{name:"Flesh",color:color({r:251,g:201,b:150})},{name:"Natural",color:color({r:230,g:205,b:177})},{name:"Tan",color:color({r:213,g:149,b:87})},{name:"Pink",color:color({r:251,g:138,b:190})},{name:"Hot Pink",color:color({r:197,g:10,b:117})},{name:"Burgundy",color:color({r:135,g:3,b:26})},{name:"Lime",color:color({r:163,g:254,b:161})},{name:"Spring Green",color:color({r:8,g:164,b:91})},{name:"Kelly Green",color:color({r:4,g:108,b:81})},{name:"Olive Green",color:color({r:114,g:116,b:75})},{name:"Dark Green",color:color({r:6,g:58,b:37})},{name:"Light Blue",color:color({r:9,g:158,b:216})},{name:"Turquoise",color:color({r:70,g:181,b:200})},{name:"Ocean Blue",color:color({r:6,g:169,b:202})},{name:"Columbia Blue",color:color({r:163,g:209,b:232})},{name:"Aqua",color:color({r:7,g:151,b:138})},{name:"Royal Blue",color:color({r:48,g:74,b:171})},{name:"Dark Royal",color:color({r:1,g:0,b:204})},{name:"Navy",color:color({r:14,g:9,b:91})},{name:"Light Purple",color:color({r:177,g:129,b:229})},{name:"Purple",color:color({r:68,g:2,b:108})},{name:"Violet",color:color({r:120,g:89,b:169})},{name:"Purple Grape",color:color({r:143,g:55,b:168})},{name:"Silver Shimmer",color:color({r:204,g:204,b:204})},{name:"Gold Shimmer",color:color({r:208,g:159,b:7})},{name:"Vegas Gold",color:color({r:230,g:204,b:104})},{name:"Neon Yellow",color:color({r:240,g:236,b:69})},{name:"Neon Orange",color:color({r:247,g:176,b:0})},{name:"Neon Pink",color:color({r:237,g:108,b:201})},{name:"Neon Magenta",color:color({r:231,g:6,b:126})},{name:"Neon Red",color:color({r:249,g:90,b:84})},{name:"Neon Blue",color:color({r:14,g:122,b:233})},{name:"Neon Green",color:color({r:104,g:211,b:53})},{name:"Neon Purple",color:color({r:100,g:67,b:136})},{name:"Metallic Black",color:color({r:98,g:95,b:92})},{name:"Metallic Red",color:color({r:243,g:104,b:107})},{name:"Metallic Magenta",color:color({r:201,g:103,b:189})},{name:"Metallic Orange",color:color({r:236,g:133,b:121})},{name:"Metallic Yellow",color:color({r:221,g:206,b:105})},{name:"Metallic Blue",color:color({r:66,g:149,b:181})},{name:"Metallic Marine",color:color({r:76,g:76,b:175})},{name:"Metallic Purple",color:color({r:122,g:106,b:142})},{name:"Metallic Fuchsia",color:color({r:169,g:101,b:136})},{name:"Metallic Green",color:color({r:35,g:175,b:156})}]});define("browseStoriesView",["bodyColumn","categories","confettiBackground","db","fonts","holibirthdayRow","separatorSize","storiesP","storyPaginate","storyRowP"],function(e,t,n,i,r,o,a,s,l,u){var c=function(){return true};var d=function(){return false};var f=Stream.once("");var h=Stream.once(c);return promiseComponent(s.then(function(s){s.sort(function(e,t){return new Date(t.createDate).getTime()-new Date(e.createDate).getTime()});return stack({gutterSize:a},[n(e(o(stack({gutterSize:a/2},[text(f.map(function(e){return e+"Stories"})).all([r.h1]),padding({left:a},stack({gutterSize:a/2},[text("All Stories").all([r.h3,link,clickThis(function(){f.push("");h.push(c)})]),text("Category").all([r.h3]),grid({gutterSize:a},t.filter(function(e){return s.filter(function(t){return t.storyType===e.toLowerCase()}).length>0}).map(function(e){return text(e).all([r.bebasNeue,link,clickThis(function(){f.push(e+" ");h.push(function(t){return t.storyType===e.toLowerCase()})})])})),text("Tag").all([r.h3]),promiseComponent(i.uniqueTag.find({}).then(function(e){return grid({gutterSize:a},e.map(function(e){return text(e.tag).all([r.bebasNeue,link,clickThis(function(){f.push(e.tag+" ");h.push(d);i.storyTag.find({tag:e.tag}).then(function(e){h.push(function(t){return e.filter(function(e){return e.story===t._id}).length>0})})})])}))}))]))])))),componentStream(h.map(function(t){return e(l({perPage:10,pageS:Stream.once(0)},s.filter(t).map(u)))}))])}))});define("storyRowP",["fonts","holibirthdayRow","profilesP","separatorSize"],function(e,t,n,i){return function(r){return promiseComponent(n.then(function(n){var o=n.filter(function(e){return e.user===r.user})[0];var a=[];var s=0;var l=0;var u=100;var c=$(r.text);while(l<u&&s<c.length){var d=$(c[s]);var f=d.text().length;l+=f;s+=1;a.push(paragraph(d.html()||""))}return linkTo("#!story/"+r._id,t(stack({gutterSize:i},[paragraph(r.name).all([e.h2]),stack({gutterSize:16,collapseGutters:true},a),linkTo("#!user/"+o.user,text("by "+o.firstName+" "+o.lastName).all([e.ralewayThinBold]))]).all([withMinWidth(300,true)]),r.imageUrl||"./content/man.png"))}))}});define("categories",[],function(){return["Birthday","Holiday","Childhood","Family","College","High School","Workplace","Catharsis","Humor"]});define("daysByMonth",[],function(){return{January:31,February:29,March:31,April:30,May:31,June:30,July:31,August:31,September:30,October:31,November:30,December:31}});define("famousBirthdaysDisplay",["bodyColumn","fonts","separatorSize"],function(e,t,n){return function(i){return i.length>0?e(stack({gutterSize:n},[text("People with the Same Birthday").all([t.h1,t.ralewayThinBold]),grid({gutterSize:n,handleSurplusWidth:evenSplitSurplusWidth},i.map(function(e){return stack({gutterSize:n},[text(e.name).all([t.ralewayThinBold,$css("text-align","center")]),alignLRM({middle:image({src:e.imageUrl,minWidth:200})})])}))])):nothing}});define("gafy",[],function(){return{colorsForDesignAndStyle:function(e,t){var n={};var i=function(e){n[e.name]=e};if(e.colors){e.colors.map(i)}if(t.colors){t.colors.map(i)}var r=[];for(var o in n){r.push(n[o])}return r},stylesForDesign:function(e,t){if(!e||!e.filter||!t||!t.styles||!t.styles.filter){return[]}return e.filter(function(e){return t.styles.filter(function(t){return e._id===t}).length>0})}}});define("cartView",["bodyColumn","cart","confettiBackground","db","fonts","formatPrice","gafyColors","holibirthdayRow","separatorSize","submitButton"],function(e,t,n,i,r,o,a,s,l,u){return promiseComponent(i.gafyDesign.find().then(function(c){return i.gafyStyle.find().then(function(i){var d=function(e,n){var s=c.filter(function(t){return t._id===e.designId})[0];var u=i.filter(function(t){return t._id===e.styleId})[0];return sideBySide({handleSurplusWidth:giveToFirst},[linkTo("#!design/"+e.designId,grid({minColumnWidth:10,gutterSize:l},[alignLRM({left:image({src:s.imageUrl,minHeight:200,chooseWidth:0})}),alignLRM({left:image({src:u.imageUrl,minHeight:200,chooseWidth:0})}),stack({gutterSize:l},[text(a[e.color].name+" "+s.designDescription+" "+u.styleDescription).all([r.ralewayThinBold]),alignLRM({left:div.all([withBackgroundColor(a[e.color].color),withMinWidth(50),withMinHeight(50)])}),text("Size: "+e.size).all([r.ralewayThinBold])])])),stack({},[alignLRM({right:text(o(u.price)).all([r.ralewayThinBold,$css("font-size",30)])}),alignLRM({right:text("(Remove Item)").all([$css("font-size",15),link,clickThis(function(){t.removeItem(n);window.location.reload()})])})])])};return stack({gutterSize:l},[n(e(s(text("Shopping Cart").all([r.ralewayThinBold,$css("font-size",40)])))),e(stack({gutterSize:l},[stack({gutterSize:l},t.items.map(d)),alignLRM({right:text("Total: "+o(t.items.reduce(function(e,t){return e+i.filter(function(e){return e._id===t.styleId})[0].price},0))).all([r.ralewayThinBold,$css("font-size",30)])}),alignLRM({right:sideBySide({gutterSize:l},[linkTo("#!gifts",u(black,sideBySide({gutterSize:l},[r.fa("shopping-cart"),text("Continue Shopping")]))),linkTo("#!checkout",u(black,sideBySide({gutterSize:l},[r.fa("tag"),text("Check Out")])))])})]))])})}))});define("storiesP",["db"],function(e){return e.story.find()});define("checkoutView",["auth","bar","bodyColumn","cart","colors","confettiBackground","db","fonts","formatPrice","forms","gafyColors","meP","prettyForms","profileP","separatorSize","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p){return promiseComponent(a.gafyDesign.find().then(function(u){return a.gafyStyle.find().then(function(g){var y=Stream.once("none");var v=function(e,t){var n=u.filter(function(t){return t._id===e.designId})[0];var i=g.filter(function(t){return t._id===e.styleId})[0];return padding({top:m,bottom:m},alignLRM({left:sideBySide({gutterSize:m},[alignLRM({left:image({src:n.imageUrl,minHeight:50,chooseWidth:0})}),alignLRM({left:image({src:i.imageUrl,minHeight:50,chooseWidth:0})}),alignLRM({left:div.all([withBackgroundColor(c[e.color].color),withMinWidth(50),withMinHeight(50)])}),alignTBM({middle:text(e.size+" "+c[e.color].name+" "+n.designDescription+" "+i.styleDescription).all([s.ralewayThinBold])})]),right:text(l(i.price)).all([s.ralewayThinBold,$css("font-size",20)])})).all([withBackgroundColor(multiplyColor(t%2?1:1.1)(r.pageBackgroundColor))])};return d.then(function(r){return h.then(function(u){var d={};var h={firstName:Stream.once(""),lastName:Stream.once(""),line1:Stream.once(""),line2:Stream.once(""),city:Stream.once(""),state:Stream.once(""),zip:Stream.once(""),country:Stream.once("")};var b=Stream.combineObject(h);b.onValue(function(e){d.address=e});var w={user:Stream.once(r&&r._id||"000000000000000000000000"),
email:Stream.once(u&&u.email||""),number:Stream.once(""),cvc:Stream.once(""),exp_month:Stream.once(""),exp_year:Stream.once("")};var S=Stream.combineObject(w);var T=o(alignLRM({middle:n(sideBySide({handleSurplusWidth:giveToSecond},[alignTBM({middle:image({src:"./content/man.png",minWidth:300,chooseHeight:0})}),padding({left:30,right:30,top:50,bottom:50},text("Checkout").all([s.ralewayThinBold,$css("font-size",40)]))]))}));var k=i.items.reduce(function(e,t){return e+g.filter(function(e){return e._id===t.styleId})[0].price},0);var x=n(stack({},[stack({},i.items.map(v)),t.horizontal(1,black),t.horizontal(m/2),alignLRM({right:text("Total: "+l(k)).all([s.ralewayThinBold,$css("font-size",20)])})]));var M=stack({gutterSize:m},[text("Shipping Address").all([s.ralewayThinBold,$css("font-size",30)]),sideBySide({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:m},[f.input({name:"First Name",fieldName:"firstName",type:"text",stream:h.firstName}),f.input({name:"Last Name",fieldName:"lastName",type:"text",stream:h.lastName})]),f.input({name:"Line 1",fieldName:"address1",type:"text",stream:h.line1}),f.input({name:"Line 2",fieldName:"address2",type:"text",stream:h.line2}),sideBySide({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:m},[f.input({name:"City",fieldName:"city",type:"text",stream:h.city}),f.input({name:"State",fieldName:"state",type:"text",stream:h.state}),f.input({name:"Zip",fieldName:"zip",type:"text",stream:h.zip}),f.input({name:"Country",fieldName:"country",type:"text",stream:h.country})])]);var C=stack({gutterSize:m},[text("Billing Information").all([s.ralewayThinBold,$css("font-size",30)]),f.input({name:"Email",fieldName:"email",type:"text",stream:w.email}),f.input({name:"Card Number",type:"text",stream:w.number}),sideBySide({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:m},[f.input({name:"CVC",type:"text",stream:w.cvc}),f.input({name:"Exp Month",type:"text",stream:w.exp_month}),f.input({name:"Exp Year",type:"text",stream:w.exp_year})])]);var _=promiseComponent(e.StripeP.then(function(e){var t=Stream.once(false);var r=Stream.once(false);var o=Stream.once(false);return n(stack({gutterSize:m},[sideBySide({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:m},[M,C]),componentStream(r.map(function(e){return e?alignLRM({right:text("Please fill out all fields")}):nothing})),componentStream(o.map(function(e){return e?alignLRM({right:text("Could not charge card")}):nothing})),alignLRM({right:p(black,text("Place Order")).all([link,clickThis(function(){r.push(false);o.push(false);y.push(Math.random().toString().substring(2));var n=b.lastValue();var s=S.lastValue();var l=i.items.map(function(e){return{user:s.user,orderBatch:y.lastValue(),customerEmailAddress:s.email,firstName:n.firstName,lastName:n.lastName,addressLine1:n.line1,addressLine2:n.line2,addressCity:n.city,addressState:n.state,addressZip:n.zip,addressCountry:n.country,designNumber:e.designNumber,designDescription:e.designDescription,printLocation:e.printLocation,styleNumber:e.styleNumber,styleDescription:e.styleDescription,color:c[e.color].name,size:e.size,quantity:1,shippingMethod:"shipping method goes here"}});var u=["customerEmailAddress","firstName","lastName","addressLine1","addressLine2","addressCity","addressState","addressZip","addressCountry","designNumber","designDescription","printLocation","styleNumber","styleDescription","color","size","quantity","shippingMethod"];for(var d=0;d<l.length;d++){var f=l[d];for(var h=0;h<u.length;h++){if(f[u[h]].length===0){r.push(true);t.push(false);return}}}var m=function(){e.card.createToken({number:s.number,cvc:s.cvc,exp_month:s.exp_month,exp_year:s.exp_year},function(e,n){if(e!==200){o.push(true);t.push(false);return}a.stripePayment.insert({user:s.user,email:s.email,orderBatch:y.lastValue(),amount:k,stripeToken:n.id}).then(function(){while(i.items.length>0){i.removeItem(0)}window.location.hash="#!orderSuccess/"+y.lastValue();window.location.reload()},function(){o.push(true);t.push(false)})})};var p=function(e){if(e===l.length){m()}a.gafyOrder.insert(l[e]).then(function(){p(e+1)})};if(!t.lastValue()){t.push(true);p(0)}})])})]))}));return stack({gutterSize:m},[T,x,_])})})})}))});define("meP",["domain"],function(e){return function(){var t=Q.defer();$.get(e+"/auth/me").then(function(e){t.resolve(e)},function(){t.resolve()});return t.promise}()});define("formLayouts",[],function(){return{stack:function(e){return function(t,n){e.fields.map(function(e){t[e]=t[e]||undefined});return e.formBuilder(t,function(t,i){return stack(e.stackConfig,[stack(e.stackConfig||{},e.fields.map(function(e){return i[e]})),n(t,i)])})}}}});define("contactUsView",["bodyColumn","confettiBackground","db","fonts","holibirthdayRow","meP","prettyForms","separatorSize","submitButton"],function(e,t,n,i,r,o,a,s,l){var u=Stream.once("");var c=Stream.once("");var d=Stream.once("");var f=Stream.once("");return stack({gutterSize:s},[t(e(r(text("Contact Us").all([i.h1])))),e(a.input({name:"Name",stream:u})),e(a.input({name:"Email",stream:c})),e(a.textarea({name:"Message",stream:d})),e(componentStream(f.map(text))),e(alignLRM({left:l(black,text("Submit").all([i.bebasNeue])).all([link,clickThis(function(e,t){var i=t();f.push("sending");n.contactUsMessage.insert({name:u.lastValue(),email:c.lastValue(),message:d.lastValue()}).then(function(){f.push("sent")}).always(i)})])}))])});define("paginate",[],function(){});define("causesView",["bodyColumn","confettiBackground","fonts","holibirthdayRow","separatorSize","siteCopyItemsP"],function(e,t,n,i,r,o){return promiseComponent(o.then(function(o){return stack({gutterSize:r},[t(e(i(stack({gutterSize:r},[text(o.find("Causes Title")).all([n.ralewayThinBold,n.h1]),linkTo("#!donate",text(o.find("Causes Donate Now")).all([n.ralewayThinBold,n.h2]))]),o.find("Causes Image")))),e(paragraph(o.find("Causes")))])}))});define("storeView",["bar","bodyColumn","cart","colors","confettiBackground","db","fonts","formatPrice","gafy","gafyColors","gafyDesignRow","gafyDesignSmall","gafyStyleSmall","holibirthdayRow","meP","opacityGridSelect","separatorSize","siteCopyItemsP"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p,g,y){return promiseComponent(o.gafyDesign.find().then(function(o){return y.then(function(s){return m.then(function(l){return stack({gutterSize:g},[r(t(h(stack({gutterSize:g,collapseGutters:true},[text(s.find("Gifts Title")).all([a.ralewayThinBold,a.h1]),linkTo("#!cart",n.items.length>0?text(s.find("Gifts Cart")+" ("+n.items.length+")").all([a.ralewayThinBold,a.h1]):nothing),linkTo(l?"#!wishlist"+"/"+l._id:"#!wishlist",n.wishlistItems.length>0?text(s.find("Gifts Wishlist")+" ("+n.wishlistItems.length+")").all([a.ralewayThinBold,a.h1]):nothing)])))),t(text("Choose a Design").all([a.h1,a.ralewayThinBold])),t(stack({gutterSize:g},intersperse(o.map(function(e){return linkTo("#!design/"+e._id,c(e))}),e.horizontal(1).all([withMinHeight(1,true),withBackgroundColor(i.middleGray)]))))])})})}))});define("gafyDesignView",["bar","bodyColumn","cart","colors","confettiBackground","db","fonts","forms","gafy","gafyColors","gafyDesignRow","gafyDesignSmall","gafyStyleSmall","holibirthdayRow","opacityGridSelect","separatorSize","socialMedia","socialMediaButton","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p,g,y,v){return function(e){return promiseComponent(o.gafyDesign.findOne({_id:e}).then(function(e){return o.gafyStyle.find().then(function(i){var o=Stream.splitObject({style:null,color:null,size:null});var d=Stream.combineObject(o);var h=Stream.once(false);d.map(function(){h.push(false)});var b=y(function(e){return e+" this Design"});var w=t(sideBySide({gutterSize:p},[b(g.facebook),b(g.twitter)]));return stack({gutterSize:p},[linkTo("#!gifts",r(t(c(e)))),t(stack({gutterSize:p},[w,text("Style").all([a.h1,a.ralewayThinBold]),m(o.style,l.stylesForDesign(i,e).map(function(e){return{component:f(e),value:e}})),text("Color").all([a.h1,a.ralewayThinBold]),componentStream(o.style.map(function(t){return t?m(o.color,l.colorsForDesignAndStyle(e,t).map(function(e){var t=u.filter(function(t){return t.name===e})[0];return{component:stack({},[alignLRM({middle:div.all([withBackgroundColor(t.color),withMinWidth(50),withMinHeight(50)])}),text(t.name),text(rgbColorString(t.color))]),value:u.indexOf(t)}})):text("Choose a style")})),text("Size").all([a.h1,a.ralewayThinBold]),componentStream(o.style.map(function(e){return e?s.selectBox({name:"size",options:e.sizes,stream:o.size}):text("Choose a style")})),componentStream(h.map(function(e){return e?alignLRM({right:paragraph("You must choose a design, a style, a color, and a size",280)}):nothing})),alignLRM({right:sideBySide({gutterSize:p},[v(black,sideBySide({gutterSize:p},[a.fa("cart-plus"),text("Add to Wishlist")])).all([link,clickThis(function(){var t=d.lastValue();if(!t.style||!t.color||!t.size){h.push(true)}else{var i={designId:e._id,styleId:t.style._id,designNumber:e.designNumber,designDescription:e.designDescription,printLocation:e.printLocation,styleNumber:t.style.styleNumber,styleDescription:t.style.styleDescription,color:t.color,size:t.size};n.addWishlistItem(i);window.location.hash="#!wishlist";window.location.reload()}})]),v(black,sideBySide({gutterSize:p},[a.fa("shopping-cart"),text("Add to Cart")])).all([link,clickThis(function(){var t=d.lastValue();if(!t.style||!t.color||!t.size){h.push(true)}else{var i={designId:e._id,styleId:t.style._id,designNumber:e.designNumber,designDescription:e.designDescription,printLocation:e.printLocation,styleNumber:t.style.styleNumber,styleDescription:t.style.styleDescription,color:t.color,size:t.size};n.addItem(i);window.location.hash="#!cart";window.location.reload()}})])])})]))])})}))}});define("profileViewP",["adminP","bar","bodyColumn","colors","confettiBackground","db","fonts","holibirthdayRow","holibirthdayView","meP","months","profilesP","separatorSize","siteCopyItemsP","socialMedia","socialMediaButton","storiesP","storyRowP","submitButton","writeOnImage"],function(e,t,n,i,r,o,a,s,l,u,c,d,f,h,m,p,g,y,v,b){return function(c){var w=c.indexOf("/");var S=w===-1?c:c.substring(0,w);var T=Stream.once(w!==-1);$("body").on("click",function(){T.push(false)});var k=false;T.map(function(e){if(k){ignoreHashChange=true;window.location.hash="#!user/"+S+(e?"/certificate":"")}k=true});var x=function(e){return function(t){return div.all([child(t),wireChildren(function(t,n){t.minWidth.push(0);t.minHeight.push(0);return[{top:Stream.combine([n.top,n.scroll],function(t,n){return e.top(t-n)}),left:Stream.combine([n.left,n.leftAccum],function(t,n){return e.left(t+n)}),width:windowWidth,height:windowHeight}]})])}};var M=x({top:function(e){return-e},left:function(e){return-e}})(overlays([nothing.all([withBackgroundColor(color({a:.5}))]),padding({all:f},l(S))]).all([$css("transition","opacity 0.5s"),function(e){T.map(function(t){e.$el.css("z-index",t?1e3:-1);e.$el.css("display",t?"":"none")})}]));return promiseComponent(u.then(function(l){return e.then(function(e){return d.then(function(c){return h.then(function(d){var h=c.filter(function(e){return e.user===S})[0];var w=o.pointsChange.find({user:S});var k=w.then(function(e){return e.reduce(function(e,t){return e+t.amount},0)});var x=r(n(stack({},[s(grid({gutterSize:f,useFullWidth:true,handleSurplusWidth:giveToFirst},[alignTBM({middle:stack({gutterSize:f/2,collapseGutters:true},[paragraph(h.firstName+" "+h.lastName).all([a.ralewayThinBold,$css("font-size",40)]),h.birthday?text(d.find("Profile Born On (include space)")+moment(h.birthday).utc().format("MMMM Do")).all([a.ralewayThinBold,$css("font-size",20)]):nothing,promiseComponent(k.then(function(e){return text(d.find("Profile Holibirthday Points (include space)")+e).all([a.ralewayThinBold,$css("font-size",20)])})),l?promiseComponent(o.contactOtherUser.findOne({user:l._id,otherUser:S}).then(function(e){if(e){return nothing}else if(l._id===S){return linkTo("#!contacts",text(d.find("Profile My Contacts")).all([a.ralewayThinBold,$css("font-size",20)]))}return text(d.find("Profile Add Contact")).all([a.ralewayThinBold,$css("font-size",20),link,clickThis(function(e,t){t();o.contactOtherUser.insert({user:l._id,otherUser:S}).then(function(){window.location.hash="#!contacts";window.location.reload()})})])})):nothing])}),keepAspectRatio(promiseComponent(o.holibirthday.findOne({user:S}).then(function(e){if(h.holibirther&&e){var t=new Date(e.date);return image({src:b({width:308,height:200},"./content/certificate-01-thumbnail.png",[{center:{x:154,y:88},text:h.firstName+" "+h.lastName,font:"bold 14px Raleway Thin"},{center:{x:154,y:152},text:moment(t).utc().format("MMMM Do"),font:"bold 14px Raleway Thin"}].concat(h.birthday?[{center:{x:46,y:171},text:"Old Birthday",font:"6px BebasNeue"},{center:{x:46,y:176},text:moment(h.birthday).utc().format("MMMM Do"),font:"6px BebasNeue"}]:[])),useNativeSize:true}).all([link,clickThis(function(e){T.push(true);e.stopPropagation()})])}return u.then(function(e){if(e&&e._id===S){return linkTo("#!myHolibirthday",alignTBM({middle:v(white,text(d.find("Profile Claim a Holibirthday")).all([a.bebasNeue]))}).all([a.ralewayThinBold]))}else{return nothing}})})))]),h.imageUrl||"./content/man.png")])));var C=n(paragraph(h.bio));var _=promiseComponent(g.then(function(e){var t=e.filter(function(e){return e.user===S});return n(stack({gutterSize:f},t.map(y))).all([withMinWidth(0),withMinHeight(0)])}));var B=p(function(e){return e+(l&&l._id===h.user?" your profile":" this profile")});var z=n(grid({gutterSize:f},[B(m.facebook),B(m.twitter)]));var D=promiseComponent(w.then(function(e){return k.then(function(r){return r===0?nothing:n(stack({gutterSize:f},[t.horizontal(1,i.middleGray),linkTo("#!leaderboards",paragraph(d.find("Profile Holibirthday Points / View Leaderboards")).all([a.ralewayThinBold,$css("font-size",40)])),stack({gutterSize:f},e.map(function(e){return sideBySide({handleSurplusWidth:giveToNth(1),gutterSize:f},[alignTBM({middle:text(e.amount>=0?"+"+e.amount:e.amount).all([withFontColor(e.amount>=0?i.darkGreen:i.darkRed),a.ralewayThinBold,$css("font-size","30")])}),alignTBM({middle:paragraph(e.reason).all([a.ralewayThinBold,$css("font-size","30")])})])})),t.horizontal(1,i.middleGray),sideBySide({gutterSize:f},[alignTBM({middle:text(r>=0?""+r:r).all([withFontColor(r>=0?i.darkGreen:i.darkRed),a.ralewayThinBold,$css("font-size","30")])}),alignTBM({middle:text(d.find("Profile Holibirthday Points Total")).all([a.ralewayThinBold,$css("font-size","30")])})])]))})}));var N=e||l&&l._id===h.user?alignLRM({middle:linkTo("#!editProfile/"+S,v(black,text(d.find("Profile Edit")).all([a.bebasNeue])))}):nothing;return stack({gutterSize:f},[x,C,z,_,D,N,M])})})})}))}});define("colors",[],function(){return{pageBackgroundColor:color({r:242,g:243,b:244}),linkBlue:color({r:26,g:13,b:171}),darkGray:color({r:209,g:210,b:212}),middleGray:color({r:153,g:153,b:153}),holibirthdayRed:color({r:237,g:28,b:36}),holibirthdayDarkRed:color({r:190,g:30,b:45}),darkGreen:color({g:100}),darkRed:color({r:100})}});define("donateSuccess",["bodyColumn","confettiBackground","fonts","holibirthdayRow","separatorSize","siteCopyItemsP"],function(e,t,n,i,r,o){return function(a){return promiseComponent(o.then(function(o){return stack({gutterSize:r},[t(e(i(text(o.find("Causes Title")).all([n.ralewayThinBold,$css("font-size",40)]),o.find("Causes Image")))),e(stack({gutterSize:r},[text("Thank you for donating!").all([n.h1]),text("Your donation id is "+a)].map(function(e){return e.all([n.ralewayThinBold])})))])}))}});define("storyEditViewP",["bodyColumn","categories","colors","db","fonts","forms","meP","prettyForms","separatorSize","signInForm","signInStream","siteCopyItemsP"],function(e,t,n,i,r,o,a,s,l,u,c,d){return function(u){return promiseComponent(d.then(function(d){return Q.all([u._id?i.storyTag.find({story:u._id}):[]]).then(function(f){var h=f[0];var m=Stream.splitObject(u);var p=Stream.combineObject(m);var g=Stream.once(h);var y=[];var v=e(padding(20,stack({gutterSize:l},[text(d.find("Edit Story Title")).all([r.bebasNeue,$css("font-size","60px")]),text(d.find("Edit Story Smaller Title")).all([r.ralewayThinBold,$css("font-size","30px")]),paragraph(d.find("Edit Story Instructions").split("\n").join("<br>")).all([r.ralewayThinBold])])));var b=[r.ralewayThinBold,$css("font-size",30),$css("font-weight","bold")];var w=e(padding(20,stack({gutterSize:l},[s.input({name:d.find("Edit Story Title Field"),fieldName:"name",stream:m.name,labelAll:b}),s.textarea({name:d.find("Edit Story Body Field"),fieldName:"text",stream:m.text,labelAll:b}),stack({},[text(d.find("Edit Story Category Field")).all([r.ralewayThinBold]).all(b),s.radios({fieldName:"storyType",stream:m.storyType,labelAll:b,options:t.map(function(e){return{name:e,value:e.toLowerCase()}})})]),promiseComponent(i.uniqueTag.find({}).then(function(e){var t=Stream.once("");var i=function(){var e=t.lastValue().replace(",","").toLowerCase();var n=g.lastValue().slice(0);if(e.length>0&&n.filter(function(t){return t.tag===e}).length===0){n.push({tag:e});g.push(n)}t.push("")};return stack({},[text(d.find("Edit Story Tags Field")).all(b),border(white,{all:1},stack({},[componentStream(g.map(function(e){return grid({},e.map(function(t,n){return padding({all:l/2},sideBySide({gutterSize:l/4},[text(t.tag).all([r.bebasNeue]),alignTBM({middle:r.fa("close").all([$css("opacity","0.8"),link,clickThis(function(){e=e.slice(0);y.push(e.splice(n,1)[0]);g.push(e)})])})]))}))})),padding({all:l/2},sideBySide({gutterSize:l/2,handleSurplusWidth:giveToSecond},[text(d.find("Edit Story Add Tag")).all([r.bebasNeue]),dropdownPanel(o.inputBox(t,"text","tag",[r.bebasNeue],true).all([keyupThis(function(e){if(e.keyCode===188){i()}}),keydownThis(function(n){if(n.keyCode===13){i();n.stopPropagation();return false}if(n.keyCode===9){var r=t.lastValue();var o=e.filter(function(e){return e.tag.indexOf(r)!==-1&&g.lastValue().filter(function(t){return t.tag===e.tag}).length===0})[0];if(o){if(r===o.tag){i()}else{t.push(o.tag)}}else{i()}n.stopPropagation();return false}})]),border(white,{all:1},componentStream(t.map(function(o){return stack({},e.filter(function(e){return o!==""&&e.tag.indexOf(o)!==-1&&g.lastValue().filter(function(t){return t.tag===e.tag}).length===0}).map(function(e){return padding({all:l/2},text(e.tag)).all([r.bebasNeue,link,clickThis(function(){t.push(e.tag);i()}),hoverThis(function(e,t){var i=colorString(n.holibirthdayRed);var r=colorString(white);t.$el.css("background-color",e?r:i).css("color",e?i:r)})])}))}))).all([withBackgroundColor(n.holibirthdayRed)]),t.map(function(e){return e.length>0}),{transition:"none"})]))]))])})),s.imageUpload({name:d.find("Edit Story Image URL Field"),labelAll:b,stream:m.imageUrl}),paragraph(d.find("Edit Story Submit Instructions")).all([r.ralewayThinBold]),alignLRM({left:s.submit(white,d.find("Edit Story Submit Story"),function(){var e=p.lastValue();var t=function(e){return Q.all(g.lastValue().map(function(t){t.story=e._id;if(!t._id){return i.storyTag.insert(t)}return t}).concat(y.filter(function(e){return e._id}).map(function(e){return i.storyTag.remove(e)})))};if(e._id){return i.story.update({_id:e._id},e).then(function(){return t(e).then(function(){window.location.hash="#!story/"+e._id;window.location.reload()})})}else{return i.story.insert(e).then(function(e){return t(e).then(function(){window.location.hash="#!story/"+e._id;window.location.reload()})})}})})]))).all([withBackgroundColor(n.holibirthdayRed),withFontColor(white)]);return a.then(function(t){if(t){return stack({},[form.all([child(stack({},[stack({},[v,w].map(function(e){return padding({top:10},e)}))])),wireChildren(passThroughToFirst)])])}return e(stack({gutterSize:l},[text(d.find("Edit Story Title")).all([r.bebasNeue,$css("font-size","60px")]),paragraph(d.find("Edit Story Must Sign In")).all([r.bebasNeue,$css("font-size","30px"),link,clickThis(function(e){c.push(true);e.stopPropagation()})])]))})})}))}});define("defaultFormFor",["fonts","formFor"],function(e,t){var n=[e.h3];var i={};schema.map(function(e){i[e.name]=t[e.name](n)});return i});define("signInStream",[],function(){return Stream.once(false)});define("dailyTheme",["colors","db","fonts","holibirthdayRow","meP","prettyForms","separatorSize","signInStream","siteCopyItemsP","submitButton"],function(e,t,n,i,r,o,a,s,l,u){return promiseComponent(t.dailyTheme.find({}).then(function(c){return l.then(function(l){var d=c.sort(function(e,t){return t.updateDate.getTime()-e.updateDate.getTime()})[0];if(!d){return i(stack({gutterSize:a},[text(l.find("Daily Theme Placeholder")).all([n.ralewayThinBold,n.h1])]))}switch(d.type){case"featuredStory":return t.story.findOne({_id:d.storyId}).then(function(e){return t.profile.findOne({user:e.user}).then(function(t){return linkTo("#!story/"+e._id,i(stack({gutterSize:a},[text(e.name).all([n.ralewayThinBold,n.h1]),linkTo("#!user/"+t.user,text(t.firstName+" "+t.lastName).all([n.ralewayThinBold,n.h3])),paragraph(d.storyText).all([n.ralewayThinBold])]),e.imageUrl))})});case"poll":var f=Stream.create();var h=Stream.once(null);return promiseComponent(t.dailyThemePollResponse.find({dailyTheme:d._id}).then(function(c){var m=Stream.once(c);return componentStream(m.map(function(c){r.then(function(e){if(e){var t=c.filter(function(t){return t.user===e._id})[0];if(t){h.push(t)}}});var p=50;var g=d.pollChoices.map(function(e){return c.filter(function(t){return t.choice===e}).length});var y=Math.max(1,g.reduce(function(e,t){return e+t},0));var v=g.map(function(e){return e/y});var b=d.pollChoices.map(function(e,t){return{name:e,percentage:v[t],total:g[t]}});b.sort(function(e,t){return t.percentage-e.percentage});var w=border(white,{all:1},padding({all:a},sideBySide({gutterSize:a,handleSurplusWidth:giveToSecond},[stack({gutterSize:a},b.map(function(e){return alignTBM({middle:text(e.name).all([n.ralewayThinBold])}).all([withMinHeight(p,true)])})),stack({gutterSize:a},b.map(function(t){return withBackground(div.all([child(nothing.all([withBackgroundColor(e.holibirthdayDarkRed)])),wireChildren(function(e,n){e.minWidth.push(0);e.minHeight.push(0);return[{top:Stream.once(0),left:Stream.once(0),width:n.width.map(function(e){return e*t.percentage}),height:n.height}]})]),alignTBM({middle:padding({all:10},text(Math.round(t.percentage*100)+"% ("+t.total+")").all([n.ralewayThinBold]))}).all([withMinHeight(p,true)]))}))])));var S=stack({gutterSize:a},[o.radios({options:d.pollChoices.map(function(e){return{name:e,value:e}}),stream:f}),promiseComponent(r.then(function(e){if(e){return alignLRM({left:u(white,text(l.find("Daily Theme Poll Vote / Abstain")).all([n.bebasNeue])).all([link,clickThis(function(){t.dailyThemePollResponse.insert({user:e._id,dailyTheme:d._id,choice:f.lastValue()}).then(function(e){h.push(e);m.push(c.concat([e]))})})])})}else{return alignLRM({left:u(white,text(l.find("Daily Theme Poll Sign In")).all([n.bebasNeue,link,clickThis(function(e){s.push(true);e.stopPropagation()})]))})}}))]);return i(stack({gutterSize:a},[text(d.pollTitle).all([n.h1]),text(d.pollDescription).all([n.h2]),componentStream(h.map(function(e){if(e){return w}else{return S}}))]),d.pollImage)}))}));case"someText":return i(stack({gutterSize:a},[text(d.someTextTitle).all([n.h1]),paragraph(d.someTextText).all([n.h3])]),d.someTextImage);default:return i(stack({gutterSize:a},[text(l.find("Daily Theme Placeholder")).all([n.ralewayThinBold,n.h1])]))}})}))});define("gridSelect",[],function(){return function(e,t){return function(n,i,r){return grid(e,i.map(function(e,o){var a=t(e.component);return toggleComponent([a.selected.all([link,clickThis(function(){if(r){var t=n.lastValue()||[];var i=t.indexOf(e.value);if(i!==-1){var o=t.slice(0);o.splice(i,1);n.push(o)}}})]),a.deselected.all([link,clickThis(function(){if(r){var t=n.lastValue()||[];var i=t.indexOf(e.value);if(i===-1){n.push(t.concat([e.value]))}}else{n.push(e.value)}})])],n.map(function(e){if(r){return e.filter(function(e){return e===i[o].value}).length>0?0:1}else{return e===i[o].value?0:1}}))}))}}});define("giftDetailView",["bar","bodyColumn","cart","colors","confettiBackground","fonts","formatPrice","prettyForms","separatorSize","submitButton"],function(e,t,n,i,r,o,a,s,l,u){return function(e){var c=storeItems[e];var d={storeItem:Stream.once(e),color:Stream.once(0),size:Stream.once(0)};var f=Stream.combineObject(d);var h=alignTBM({middle:image({src:c.imageSrc,minWidth:250,chooseHeight:0})});var m=sideBySide({handleSurplusWidth:giveToFirst},[stack({gutterSize:l},[text(c.name).all([o.ralewayThinBold,$css("font-size",40)]),text("Style: "+c.style).all([o.ralewayThinBold,$css("font-size",20)]),text(c.description).all([o.ralewayThinBold,$css("font-size",20)])]),text(a(c.price)).all([o.ralewayThinBold,$css("font-size",20)])]);var p=r(t(grid({handleSurplusWidth:giveToSecond},[h,padding({left:30,right:30,top:50,bottom:50},m).all([withMinWidth(300,true)])])));var g=Stream.once(false);var y=multiplyColor(.5)(i.pageBackgroundColor);var v=t(border(y,{all:1,radius:5},sideBySide({handleSurplusWidth:giveToFirst},[grid({minColumnWidth:150,gutterSize:l,outerGutter:true},c.colors.map(function(e,t){return stack({},[alignLRM({middle:image({src:e.src,minWidth:100})})]).all([link,clickThis(function(){d.color.push(t);g.push(false)})])})),padding({top:l,right:l},o.fa("close").all([$css("font-size",40),withFontColor(y),link,clickThis(function(){g.push(false)}),withMinWidth(31,true)]))])).all([withBackgroundColor(i.pageBackgroundColor)]));var b=function(e){return e.map(function(e){return alignLRM({middle:e})})};var w=t(stack({gutterSize:l},[grid({minColumnWidth:350,handleSurplusWidth:evenSplitSurplusWidth},[stack({gutterSize:l},b([text("Choose Color").all([o.bebasNeue,$css("font-size",40)]),text(d.color.map(function(e){return c.colors[e].name})).all([o.ralewayThinBold,$css("font-size",30)]),alignLRM({left:image({src:d.color.map(function(e){return c.colors[e].src}),minWidth:100}).all([link,clickThis(function(){g.push(true)})])})])),stack({gutterSize:l},b([text("Choose Size").all([o.bebasNeue,$css("font-size",40)]),s.radios({name:"Category",fieldName:"storyType",stream:d.size,options:c.sizes.map(function(e,t){return{name:e,value:t}})}),image({src:c.sizeImageSrc,useNativeSize:true})])),stack({gutterSize:l,align:"middle"},b([text("Price").all([o.bebasNeue,$css("font-size",40)]),text(a(c.price)).all([o.ralewayThinBold,$css("font-size",30)])]))]),alignLRM({middle:u(black,sideBySide({gutterSize:l},[o.fa("shopping-cart"),text("Add to Cart")])).all([link,clickThis(function(){n.addItem(f.lastValue());window.location.hash="#!cart";window.location.reload()})])}),modalDialog(g,.5)(v)]));return stack({gutterSize:l},[p,w])}});define("holibirthdayRow",["domain","separatorSize"],function(e,t){return function(n,i){return adjustMinSize({mw:function(e){return Math.max(300,e)},mh:function(e){return Math.max(240,e)}})(padding({all:t},grid({handleSurplusWidth:giveToNth(1),bottomToTop:true,gutterSize:t},[alignTBM({middle:alignLRM({middle:image({src:i||e+"/content/man.png",minWidth:300,chooseHeight:true})})}),alignTBM({middle:n})])))}});define("writeOnImage",[],function(){return function(e,t,n){var i=Stream.create();var r=document.createElement("canvas");var o=$(r);o.appendTo($("body")).prop("width",e.width).prop("height",e.height);var a=r.getContext("2d");var s=function(e,t,n){a.font=n;var i=a.measureText(t).width;a.fillText(t,e.x-i/2,e.y)};var l=new Image;l.onload=function(){a.drawImage(l,0,0);n.map(function(e){if(e.center){s(e.center,e.text,e.font)}});setTimeout(function(){i.push(r.toDataURL());o.remove()})};l.src=t;return i}});define("orderSuccess",["bodyColumn","confettiBackground","fonts","separatorSize"],function(e,t,n,i){var r=t(alignLRM({middle:e(sideBySide({handleSurplusWidth:giveToSecond},[alignTBM({middle:image({src:"./content/man.png",minWidth:300,chooseHeight:0})}),padding({left:30,right:30,top:50,bottom:50},text("Checkout").all([n.ralewayThinBold,$css("font-size",40)]))]))}));return function(t){return stack({gutterSize:i},[r,e(stack({gutterSize:i},[text("Order Placed").all([n.h1]),text("Thank you for placing an order with Holibirthday"),text("Your order number is "+t)].map(function(e){return e.all([n.ralewayThinBold])})))])}});define("donateView",["auth","bodyColumn","confettiBackground","db","fonts","holibirthdayRow","meP","prettyForms","profileP","separatorSize","siteCopyItemsP","submitButton"],function(e,t,n,i,r,o,a,s,l,u,c,d){return promiseComponent(c.then(function(c){return a.then(function(a){return l.then(function(l){return e.StripeP.then(function(e){var f=Stream.once(false);var h=Stream.once(false);var m={user:Stream.once(a&&a._id||"000000000000000000000000"),amount:Stream.once(20),email:Stream.once(l&&l.email||""),number:Stream.once(""),cvc:Stream.once(""),exp_month:Stream.once(""),exp_year:Stream.once("")};var p=Stream.combineObject(m);var g=function(){var t=p.lastValue();var n=Q.defer();e.card.createToken({number:t.number,cvc:t.cvc,exp_month:t.exp_month,exp_year:t.exp_year},function(e,r){if(!t.email){h.push(true);return n.resolve()}if(e!==200){f.push(true);return n.resolve()}i.stripeDonation.insert({user:t.user,email:t.email,amount:Math.round(t.amount*100),stripeToken:r.id}).then(function(e){window.location.hash="#!donateSuccess/"+e._id;window.location.reload()},function(){f.push(true);return n.resolve()})});return n.promise};return stack({gutterSize:u},[n(t(o(stack({gutterSize:u},[text(c.find("Causes Title")).all([r.ralewayThinBold,r.h1])]),c.find("Causes Image")))),t(stack({gutterSize:u,collapseGutters:true},[s.input({name:"Donation Amount $",fieldName:"email",type:"text",stream:m.amount}),s.input({name:"Email",fieldName:"email",type:"text",stream:m.email}),s.input({name:"Card Number",type:"text",stream:m.number}),sideBySide({handleSurplusWidth:evenSplitSurplusWidth,gutterSize:u},[s.input({name:"CVC",type:"text",stream:m.cvc}),s.input({name:"Exp Month",type:"text",stream:m.exp_month}),s.input({name:"Exp Year",type:"text",stream:m.exp_year})]),componentStream(h.map(function(e){return e?alignLRM({right:text("Please fill out all fields")}):nothing})),componentStream(f.map(function(e){return e?alignLRM({right:text("Could not charge card")}):nothing})),alignLRM({right:d(black,text("Donate Now")).all([link,clickThis(function(e,t){h.push(false);f.push(false);var n=t();g().then(function(){n()})})])})]))])})})})}))});define("ckeditorP",[],function(){$("body").append('<script src="./ckeditor/ckeditor.js"></script>');return function(){var e=Q.defer();var t=setInterval(function(){if(window.CKEDITOR){e.resolve(window.CKEDITOR);clearInterval(t)}},100);return e.promise}});define("gafyColorsForDesignAndStyle",[],function(){return function(e,t){var n={};var i=function(e){n[e.name]=e};e.colors.map(i);t.colors.map(i);var r=[];for(var o in n){r.push(n[o])}return r}});define("siteCopyItem",[],function(){return function(e){return siteCopyItems}});define("pageRoutes",["meP","profileViewP","storiesP"],function(e,t,n){var i=function(e,t){var n=Q.defer();require([e],function(e){if(!t){n.resolve(e)}else{n.resolve(e.apply(null,t))}});return n.promise};return routeToFirst([matchStrings([{string:"#!admin",router:routeToComponentF(function(){return promiseComponent(i("adminView"))})},{string:"#!browseStories",router:routeToComponentF(function(){return promiseComponent(i("browseStoriesView"))})},{string:"#!register",router:routeToComponentF(function(){return promiseComponent(i("registerView"))})},{string:"#!confirmEmail/",router:routeMatchRest(function(e){return promiseComponent(i("confirmEmailView",[e]))})},{string:"#!resetPassword/",router:routeMatchRest(function(e){return promiseComponent(i("resetPasswordView",[e]))})},{string:"#!design/",router:routeMatchRest(function(e){return promiseComponent(i("gafyDesignView",[e]))})},{string:"#!gifts",router:routeToComponentF(function(){return promiseComponent(i("storeView"))})},{string:"#!cart",router:routeToComponentF(function(){return promiseComponent(i("cartView"))})},{string:"#!wishlist/",router:routeMatchRest(function(e){return promiseComponent(i("wishlistView",[e]))})},{string:"#!wishlist",router:routeToComponentF(function(){return promiseComponent(i("wishlistView",[]))})},{string:"#!checkout",
router:routeToComponentF(function(){return promiseComponent(i("checkoutView"))})},{string:"#!orderSuccess/",router:routeMatchRest(function(e){return promiseComponent(i("orderSuccess",[e]))})},{string:"#!myHolibirthday",router:routeToComponentF(function(){return promiseComponent(i("myHolibirthdayView"))})},{string:"#!contacts",router:routeToComponentF(function(){return promiseComponent(i("contactsView"))})},{string:"#!leaderboards",router:routeToComponentF(function(){return promiseComponent(i("leaderboardsView"))})},{string:"#!causes",router:routeToComponentF(function(){return promiseComponent(i("causesView"))})},{string:"#!donateSuccess/",router:routeMatchRest(function(e){return promiseComponent(i("donateSuccess",[e]))})},{string:"#!donate",router:routeToComponentF(function(){return promiseComponent(i("donateView"))})},{string:"#!story/",router:routeMatchRest(function(e){return n.then(function(t){var n=t.filter(function(t){return t._id===e})[0];return promiseComponent(i("storyDetailViewP",[n,true]))})})},{},{string:"#!user/",router:routeMatchRest(function(e){return t(e)})},{string:"#!editProfile/",router:routeMatchRest(function(e){return promiseComponent(i("profileEditViewP",[e]))})},{string:"#!editStory/",router:routeMatchRest(function(e){return n.then(function(t){var n=t.filter(function(t){return t._id===e})[0];return promiseComponent(i("storyEditViewP",[n]))})})},{string:"#!editStory",router:routeToComponentF(function(){return promiseComponent(e.then(function(e){return i("storyEditViewP",[{user:e&&e._id||"",name:"",text:"",imageUrl:"./content/man.png",storyType:"",isPublic:true}])}))})},{string:"#!holibirthday/",router:routeMatchRest(function(e){return promiseComponent(i("holibirthdayView",[e]))})},{string:"#!contactUs",router:routeToComponentF(function(){return promiseComponent(i("contactUsView"))})},{string:"#!privacyPolicy",router:routeToComponentF(function(){return promiseComponent(i("privacyPolicyView"))})}]),routeToComponentF(function(){return promiseComponent(i("homeViewP"))})])});define("bodyColumn",["separatorSize"],function(e){var t=1070;var n=870;return function(i,r){return alignLRM({middle:padding({left:e,right:e},i).all([withMinWidth(r?n:t,true)])}).all([componentName("body-column")])}});define("opacityGridSelect",["gridSelect","separatorSize"],function(e,t){return e({gutterSize:t},function(e){return{selected:border(black,{all:1},padding({all:5},e).all([withBackgroundColor(white)])),deselected:padding({all:6},e)}})});