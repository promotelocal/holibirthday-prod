define("bar",[],function(){return{horizontal:function(e,t){return e=e||0,t=t||transparent,div.all([componentName("vertical-separator"),withMinWidth(0,!0),withMinHeight(e,!0),withBackgroundColor(t)])},vertical:function(e,t){return e=e||0,t=t||transparent,div.all([componentName("horizontal-separator"),withMinWidth(e,!0),withMinHeight(0,!0),withBackgroundColor(t)])}}}),define("colors",[],function(){return{pageBackgroundColor:color({r:242,g:243,b:244}),linkBlue:color({r:26,g:13,b:171}),darkGray:color({r:209,g:210,b:212}),middleGray:color({r:153,g:153,b:153}),holibirthdayRed:color({r:237,g:28,b:36}),holibirthdayDarkRed:color({r:190,g:30,b:45}),darkGreen:color({g:100}),darkRed:color({r:100})}}),define("fonts",[],function(){return{ralewayThin:$css("font-family","Raleway Thin"),bebasNeue:$css("font-family","BebasNeue"),celebrationTime:$css("font-family","CelebrationTime"),ralewayThinBold:function(e){e.$el.css("font-family","Raleway Thin"),e.$el.css("font-weight","bold"),setTimeout(function(){e.updateDimensions()})},h1:function(e){e.$el.css("font-family","Raleway Thin"),e.$el.css("font-weight","bold"),e.$el.css("font-size",px(40)),setTimeout(function(){e.updateDimensions()})},h2:function(e){e.$el.css("font-family","Raleway Thin"),e.$el.css("font-weight","bold"),e.$el.css("font-size",px(30)),setTimeout(function(){e.updateDimensions()})},h3:function(e){e.$el.css("font-family","Raleway Thin"),e.$el.css("font-weight","bold"),e.$el.css("font-size",px(20)),setTimeout(function(){e.updateDimensions()})},fa:function(e){return text('<i class="fa fa-'+e+'"></i>')},faI:function(e){return'<i class="fa fa-'+e+'"></i>'}}}),define("separatorSize",[],function(){return 20}),define("footer",["fonts","separatorSize"],function(e,t){var n=[{name:"Contact Holibirthday",link:"#!contactUs"},{name:"Privacy Policy",link:"#!privacyPolicy"}].map(function(t){return linkTo(t.link,text(t.name).all([e.ralewayThinBold]))});return alignLRM({middle:sideBySide({gutterSize:t},n)})}),define("db",[],function(){return function(){var e={};return schema.map(function(t){var n="/api/"+t.name+"/",r=function(e){t.fields.map(function(t){e[t.name]&&t.type!==type.id&&(e[t.name]=t.type.fromString(e[t.name]))})},i=function(e){return e.then(function(e){return e&&(Array.isArray(e)?e.map(r):r(e)),e})};e[t.name]={findOne:function(e){var t=Q.defer();return i($.ajax({type:"post",url:n+"find",data:JSON.stringify(e),contentType:"application/json"}).then(function(e){e.length===0&&t.resolve(null),t.resolve(e[0])})),t.promise},find:function(e){return i($.ajax({type:"post",url:n+"find",data:JSON.stringify(e),contentType:"application/json"}))},insert:function(e){return i($.ajax({type:"post",url:n+"insert",data:JSON.stringify(e),contentType:"application/json"}))},update:function(e,t){return i($.ajax({type:"post",url:n+"update",data:JSON.stringify({query:e,update:t}),contentType:"application/json"}))},remove:function(e){return i($.ajax({type:"post",url:n+"remove",data:JSON.stringify(e),contentType:"application/json"}))}}}),e.uploadFile=function(e){var t=new FormData;return t.append("file",e),$.ajax({url:"/api/uploadFile/insert",type:"post",data:t,cache:!1,processData:!1,contentType:!1})},e}()}),define("meP",[],function(){return function(){var e=Q.defer();return $.get("/auth/me").then(function(t){e.resolve(t)},function(){e.resolve()}),e.promise}()}),define("adminP",["db","meP"],function(e,t){return t.then(function(t){if(t)return e.admin.findOne({user:t._id})})}),define("auth",[],function(){return{signIn:function(e){return $.ajax({type:"post",url:"/auth/login",data:JSON.stringify(e),contentType:"application/json"})},signOut:function(){return $.get("/auth/logout")},loginWithFacebook:function(e){return $.ajax({type:"post",url:"/auth/facebook",data:JSON.stringify({username:e.accessToken,password:e.accessToken}),contentType:"application/json"})},register:function(e){return $.ajax({type:"post",url:"/auth/register",data:JSON.stringify(e),contentType:"application/json"})},resendConfirmEmail:function(e){return $.post("/auth/resendConfirmEmail",{locationOrigin:window.location.origin,email:e})},grecaptchaSitekeyP:$.get("/grecaptcha/sitekey"),grecaptchaP:function(){var e=Q.defer(),t=function(){typeof grecaptcha=="undefined"?setTimeout(t,100):e.resolve(grecaptcha)};return t(),e.promise}(),StripeP:$.get("/stripe/publishableKey").then(function(e){return Stripe.setPublishableKey(e),Stripe})}}),define("bodyColumn",["separatorSize"],function(e){var t=1070;return function(n){return alignLRM({middle:padding({left:e,right:e},n).all([withMinWidth(t,!0)])}).all([componentName("body-column")])}}),define("socialMedia",[],function(){return function(){var e=function(e){var t=575,n=400,r=($(window).width()-t)/2,i=($(window).height()-n)/2,s="status=1,width="+t+",height="+n+",top="+i+",left="+r;window.open(e,"twitter",s)};return{facebook:{icon:'<i class="fa fa-facebook"></i>',color:color({r:59,g:89,b:152}),name:"Facebook",shareVerb:"share",shareThisPage:function(){return FB.ui({method:"share",href:location.href})},api:function(){var e=Array.prototype.slice.call(arguments),t=Q.defer();return e[3]=function(e){t.resolve(e)},FB.api.apply(null,e),t.promise}},twitter:{icon:'<i class="fa fa-twitter"></i>',color:color({r:0,g:172,b:237}),name:"Twitter",shareVerb:"tweet",shareThisPage:function(){return e("https://twitter.com/intent/tweet?url="+encodeURIComponent(location.href))},countShares:function(){}}}}()}),define("submitButton",[],function(){return function(e,t){if(!t)debugger;return border(e,{all:2,radius:5},padding(10,alignLRM({middle:t})))}}),define("loginWithFacebook",["auth","fonts","separatorSize","socialMedia","submitButton"],function(e,t,n,r,i){var s=Q.defer();return FB.getLoginStatus(function(e){(e.status==="unknown"||e.status==="not_authorized"||e.status==="connected")&&s.resolve(!1),s.resolve(e.authResponse)},!0),function(){return promiseComponent(s.promise.then(function(s){return button.all([child(i(r.facebook.color,sideBySide({gutterSize:n},[text(r.facebook.icon),text("sign in with Facebook").all([t.bebasNeue])])).all([withFontColor(r.facebook.color)])),wireChildren(passThroughToFirst)]).all([link,clickThis(function(t){t.stopPropagation(),t.preventDefault(),s?e.loginWithFacebook(s).then(function(){window.location.reload()}):FB.login(function(t){e.loginWithFacebook(t.authResponse).then(function(){window.location.reload()})},{scope:"email, public_profile, user_friends, user_birthday"})})])}))}}),define("ckeditorP",[],function(){return function(){$("body").append('<script src="./ckeditor/ckeditor.js"></script>');var e=Q.defer(),t=setInterval(function(){window.CKEDITOR&&(e.resolve(window.CKEDITOR),clearInterval(t))},100);return e.promise}}),define("forms",["ckeditorP"],function(e){return{inputBox:function(e,t,n,r){return t=t||"text",border(color({r:169,b:169,g:169}),{all:t==="text"||t==="password"||t==="date"||t==="number"?1:0},input.all((r||[]).concat([$prop("name",n),$prop("type",t),withBackgroundColor(white),withFontColor(black),keyupThis(function(n){t==="text"&&e.push($(n.target).val())}),changeThis(function(n){t==="date"?e.push(moment($(n.target).val()).toDate()):e.push($(n.target).val())}),function(n){var r=n.$el;e.onValue(function(e){var n;t==="date"?e&&(n=moment(e).format("YYYY-MM-DD")):t==="checkbox"?setTimeout(function(){r.prop("checked",e)}):n=e,n&&r.val()!==n&&r.val(n)})}])))},plainTextareaBox:function(e,t){return textarea.all([$prop("id",t),$prop("name",t),$prop("rows",10),keyupThis(function(t){e.push($(t.target).val())}),changeThis(function(t){e.push($(t.target).val())}),function(t){e.onValue(function(e){t.$el.val(e)})},withBackgroundColor(white)])},textareaBox:function(t,n){return promiseComponent(e().then(function(e){return div.all([child(textarea.all([$prop("id",n),$prop("name",n),$prop("rows",21),keyupThis(function(e){t.push($(e.target).val())}),changeThis(function(e){t.push($(e.target).val())}),function(n,r){var i=!1,s=t.promise.then(function(s){n.$el.val(s),e.config.resize_enabled=!1;var o=CKEDITOR.replace(n.$el[0]);return o.on("instanceReady",function(){o.on("change",function(){t.push(o.getData())}),Stream.combine([r.width,r.height],function(e,t){i||o.resize(px(e),px(t),!0,!0)})}),o});return function(){i=!0,s.then(function(e){if(!i)try{e.destroy()}catch(t){console.log("ckeditor exception happened")}})}}])),wireChildren(function(e,t,n){return n.minHeight.pushAll(e.minHeight),n.minWidth.pushAll(e.minWidth),[{width:t.width,height:t.height}]})])}))},selectBox:function(e){return border(color({r:169,b:169,g:169}),{all:1},select.all([children(e.options.map(function(e){if(!e.name||!e.value)e={name:e,value:e};return option.all([$html(e.name),$prop("value",e.value),$css("visibility","")])})),$prop("name",e.name),withBackgroundColor(white),withFontColor(black),changeThis(function(t){e.stream.push($(t.target).val())}),function(t){var n=t.$el;e.stream.onValue(function(e){setTimeout(function(){n.val(e)})})}]))}}}),define("prettyForms",["db","fonts","forms","separatorSize","submitButton"],function(e,t,n,r,i){var s={input:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.inputBox(e.stream,e.type,e.fieldName)])},select:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.selectBox(e)])},textarea:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.textareaBox(e.stream,e.fieldName).all([$addClass("pre")])])},plainTextarea:function(e){return stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),n.plainTextareaBox(e.stream,e.fieldName).all([$addClass("pre")])])},fileUpload:function(e,n){return n=n||function(){},e.accept=e.accept||"*",stack({},[text(e.name).all([t.ralewayThinBold]).all(e.labelAll||[]),input.all([$prop("type","file"),$prop("accept",e.accept),changeThis(function(t){var r=t.target.files[0];n(r),e.stream&&e.stream.push(r)})])])},imageUpload:function(t){var n=Stream.once("./content/man.png");return t.stream.pushAll(n),t.accept=t.accept||"image/*",grid({gutterSize:r},[s.fileUpload({name:t.name,accept:t.accept,labelAll:t.labelAll,stream:Stream.create()},function(n){e.uploadFile(n).then(function(e){t.stream.push("/api/uploadFile/find?filename="+encodeURIComponent(e))})}).all([withMinWidth(300,!0)]),image({src:n,minWidth:300})])},checkbox:function(e){var i=!1;return e.stream.onValue(function(e){i=e}),sideBySide({gutterSize:r},[n.inputBox(e.stream,"checkbox",e.fieldName),padding({top:1},text(e.name).all([t.ralewayThinBold]))]).all([clickThis(function(t){return e.stream.push(!i),t.stopPropagation(),!1})])},radios:function(e){return stack({},e.options.map(function(i){return sideBySide({gutterSize:r},[n.inputBox(Stream.create(),"radio",e.fieldName).all([$prop("value",i.value),function(t){e.stream.onValue(function(e){e===i.value?t.$el.click():t.$el.find("input").prop("checked",!1)})},clickThis(function(){e.stream.push(i.value)})]),padding({top:1},text(i.name).all([t.ralewayThinBold]))])}))},submit:function(e,n,r){return stack({},[input.all([$prop("type","submit"),submitThis(function(){return r(),!1}),withMinHeight(0,!0),$css("display","none")]),i(e,text(n).all([t.bebasNeue])).all([link,clickThis(function(e,t){var n=t();r(n)})])])}};return s}),define("signInForm",["auth","bodyColumn","colors","fonts","loginWithFacebook","prettyForms","separatorSize"],function(e,t,n,r,i,s,o){return function(){var u=Stream.once(!1),a=Stream.once(!1),f={username:Stream.once(""),password:Stream.once("")},l;Stream.combineObject(f).onValue(function(e){l=e,u.push(!1)});var c=s.submit(black,"Submit",function(){l===undefined?u.push(!0):e.signIn(l).then(function(){window.location.hash="#!",window.location.reload()},function(){a.push(!0)})}),h=s.input({name:"email",fieldName:"username",stream:f.username}),p=s.input({name:"password",fieldName:"password",stream:f.password,type:"password"}),d=text("or").all([r.ralewayThinBold]),v=sideBySide({handleSurplusWidth:giveToSecond},[alignTBM({middle:stack({},[i()])}),alignLRM({middle:alignTBM({middle:d})}),stack({},[sideBySide({gutterSize:o},[h,p,c]),toggleHeight(u)(text("Please fill out all fields")),toggleHeight(a)(text("Incorrect email or password"))])]),m=stack({},[alignLRM({middle:stack({},[i()])}),padding({top:10,bottom:10},alignLRM({middle:d})),alignLRM({middle:sideBySide({gutterSize:o},[h,p])}),toggleHeight(u)(text("Please fill out all fields")),toggleHeight(a)(text("Incorrect email or password")),alignLRM({middle:c})].map(function(e){return padding({top:10},e)})),g=Stream.never();return border(n.middleGray,{bottom:1},t(padding({top:o,bottom:o},form.all([child(componentStream(g.map(function(e){return e>700?v:m}))),function(e,t){t.width.pushAll(g)},wireChildren(passThroughToFirst)]))).all([withBackgroundColor(n.pageBackgroundColor)]))}}),define("siteCopyItemsP",["db"],function(e){return e.siteCopyItem.find({}).then(function(e){return e.find=function(t){var n=e.filter(function(e){return e.uniqueName===t})[0];return n?n.value:"No Copy"},e})}),define("header",["adminP","auth","bar","bodyColumn","colors","fonts","meP","separatorSize","signInForm","siteCopyItemsP"],function(e,t,n,r,i,s,o,u,a,f){return promiseComponent(f.then(function(n){var f=function(e){return e.all=e.all||[],function(t){return padding(e.padding,alignTBM({middle:text(t).all(e.all)}))}},l=function(e){return f({padding:10,all:[s.celebrationTime,$css("font-size","20px")]})(e)},c=function(e,r,i){var s=[];return r&&s.push(linkTo("#!admin",l(n.find("Header Admin")))),s.push(linkTo("#!gifts",l(n.find("Header Gifts")))),s.push(linkTo("#!causes",l(n.find("Header Causes")))),e?(s.push(linkTo("#!user/"+e._id,l(n.find("Header My Profile")))),s.push(l(n.find("Header Sign Out")).all([link,clickThis(function(){t.signOut().then(function(){window.location.hash="#!",window.location.reload()})})]))):(s.push(l(n.find("Header Sign In")).all([link,clickThis(function(e){i.push(!i.lastValue()),e.stopPropagation()})])),s.push(linkTo("#!register",l(n.find("Header Register"))))),s};return o.then(function(t){return e.then(function(e){var n=Stream.once(!1),o=Stream.once(!1);$("body").on("click",function(){n.push(!1),o.push(!1)});var f=c(t,e,n);return dropdownPanel(dropdownPanel(border(i.middleGray,{bottom:1},alignLRM({middle:r(stack({},[alignLRM({left:toggleComponent([linkTo("#!",image({src:"/content/man3.png",minHeight:0,chooseWidth:0})),image({src:"/content/man3.png",minHeight:0,chooseWidth:0}).all([function(e,t){e.$el.css("opacity","0"),e.$el.css("cursor","pointer"),e.$el.css("transition","opacity 0.5s"),Stream.combine([windowScroll,t.height],function(t,n){e.$el.css("opacity",t>n?1:0)})},clickThis(function(){$("body").animate({scrollTop:0},300)})])],windowHash.map(function(e){return e===""||e==="#"||e==="#!"?1:0})),right:componentStream(windowWidth.map(function(e){return e>560?(o.push(!1),sideBySide({gutterSize:u},f)):l(s.faI("bars")).all([link,clickThis(function(e){o.push(!o.lastValue()),e.stopPropagation()})])}))})]))})).all([withBackgroundColor(i.pageBackgroundColor)]),alignLRM({right:border(black,{left:1,bottom:1},stack({gutterSize:u},f).all([withBackgroundColor(i.pageBackgroundColor)]))}),o),a().all([clickThis(function(e){e.stopPropagation()})]),n)})})}))}),define("storiesP",["db"],function(e){return e.story.find()}),define("pageRoutes",["meP","storiesP"],function(e,t){var n=function(e,t){var n=Q.defer();return require([e],function(e){t?n.resolve(e.apply(null,t)):n.resolve(e)}),n.promise};return routeToFirst([matchStrings([{string:"#!admin",router:routeToComponentF(function(){return promiseComponent(n("adminView"))})},{string:"#!register",router:routeToComponentF(function(){return promiseComponent(n("registerView"))})},{string:"#!design/",router:routeMatchRest(function(e){return promiseComponent(n("gafyDesignView",[e]))})},{string:"#!gifts",router:routeToComponentF(function(){return promiseComponent(n("storeView"))})},{string:"#!cart",router:routeToComponentF(function(){return promiseComponent(n("cartView"))})},{string:"#!wishlist/",router:routeMatchRest(function(e){return promiseComponent(n("wishlistView",[e]))})},{string:"#!wishlist",router:routeToComponentF(function(){return promiseComponent(n("wishlistView",[]))})},{string:"#!checkout",router:routeToComponentF(function(){return promiseComponent(n("checkoutView"))})},{string:"#!orderSuccess/",router:routeMatchRest(function(e){return promiseComponent(n("orderSuccess",[e]))})},{string:"#!myHolibirthday",router:routeToComponentF(function(){return promiseComponent(n("myHolibirthdayView"))})},{string:"#!contacts",router:routeToComponentF(function(){return promiseComponent(n("contactsView"))})},{string:"#!leaderboards",router:routeToComponentF(function(){return promiseComponent(n("leaderboardsView"))})},{string:"#!causes",router:routeToComponentF(function(){return promiseComponent(n("causesView"))})},{string:"#!donateSuccess/",router:routeMatchRest(function(e){return promiseComponent(n("donateSuccess",[e]))})},{string:"#!donate",router:routeToComponentF(function(){return promiseComponent(n("donateView"))})},{string:"#!story/",router:routeMatchRest(function(e){return t.then(function(t){var r=t.filter(function(t){return t._id===e})[0];return promiseComponent(n("storyDetailViewP",[r,!0]))})})},{},{string:"#!user/",router:routeMatchRest(function(e){return promiseComponent(n("profileViewP",[e]))})},{string:"#!editProfile/",router:routeMatchRest(function(e){return promiseComponent(n("profileEditViewP",[e]))})},{string:"#!editStory/",router:routeMatchRest(function(e){return t.then(function(t){var r=t.filter(function(t){return t._id===e})[0];return promiseComponent(n("storyEditViewP",[r]))})})},{string:"#!editStory",router:routeToComponentF(function(){return promiseComponent(e.then(function(e){return n("storyEditViewP",[{user:e&&e._id||"",name:"",text:"",imageUrl:"./content/man.png",storyType:"",isPublic:!0}])}))})},{string:"#!holibirthday/",router:routeMatchRest(function(e){return promiseComponent(n("holibirthdayView",[e]))})},{string:"#!contactUs",router:routeToComponentF(function(){return promiseComponent(n("contactUsView"))})},{string:"#!privacyPolicy",router:routeToComponentF(function(){return promiseComponent(n("privacyPolicyView"))})}]),routeToComponentF(function(){return promiseComponent(n("homeViewP"))})])}),define("app",["bar","colors","footer","header","pageRoutes","separatorSize"],function(e,t,n,r,i,s){var o=extendToWindowBottom(alignTBM({top:fixedHeaderBody({},r,stack({},[e.horizontal(s),route(i),e.horizontal(s)])),bottom:n})).all([withBackgroundColor(t.pageBackgroundColor)]);return o}),requirejs.config({baseUrl:"js/app"}),require(["app"],function(e){rootComponent(e)}),define("main",function(){});